<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Nibbles | PwndSide</title><meta name=keywords content="web,privesc,linux"><meta name=description content="This room is a Linux environment running a website powered by the Nibbleblog engine, and the version we are using has a shell vulnerability."><meta name=author content="Ayman Boulaich"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://pwndside.github.io/posts/nibbles-htb/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://pwndside.github.io/posts/nibbles-htb/"><meta property="og:site_name" content="PwndSide"><meta property="og:title" content="Nibbles"><meta property="og:description" content="This room is a Linux environment running a website powered by the Nibbleblog engine, and the version we are using has a shell vulnerability."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-07-04T13:02:46+02:00"><meta property="article:modified_time" content="2023-07-04T13:02:46+02:00"><meta property="article:tag" content="Web"><meta property="article:tag" content="Privesc"><meta property="article:tag" content="Linux"><meta property="og:image" content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta name=twitter:title content="Nibbles"><meta name=twitter:description content="This room is a Linux environment running a website powered by the Nibbleblog engine, and the version we are using has a shell vulnerability."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://pwndside.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Nibbles","item":"https://pwndside.github.io/posts/nibbles-htb/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Nibbles","name":"Nibbles","description":"This room is a Linux environment running a website powered by the Nibbleblog engine, and the version we are using has a shell vulnerability.","keywords":["web","privesc","linux"],"articleBody":"Room Information Room name: Nibbles Difficulty level: Easy Room link: https://app.hackthebox.com/machines/Nibbles Tools Used Nmap Gobuster Port Scanning PORT STATE SERVICE REASON VERSION 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQD8ArTOHWzqhwcyAZWc2CmxfLmVVTwfLZf0zhCBREGCpS2WC3NhAKQ2zefCHCU8XTC8hY9ta5ocU+p7S52OGHlaG7HuA5Xlnihl1INNsMX7gpNcfQEYnyby+hjHWPLo4++fAyO/lB8NammyA13MzvJy8pxvB9gmCJhVPaFzG5yX6Ly8OIsvVDk+qVa5eLCIua1E7WGACUlmkEGljDvzOaBdogMQZ8TGBTqNZbShnFH1WsUxBtJNRtYfeeGjztKTQqqj4WD5atU8dqV/iwmTylpE7wdHZ+38ckuYL9dmUPLh4Li2ZgdY6XniVOBGthY5a2uJ2OFp2xe1WS9KvbYjJ/tH | 256 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPiFJd2F35NPKIQxKMHrgPzVzoNHOJtTtM+zlwVfxzvcXPFFuQrOL7X6Mi9YQF9QRVJpwtmV9KAtWltmk3qm4oc= | 256 e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC/RjKhT/2YPlCgFQLx+gOXhC6W3A3raTzjlXQMT8Msk 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu)) |_http-title: Site doesn't have a title (text/html). | http-methods: |_ Supported Methods: GET HEAD POST OPTIONS |_http-server-header: Apache/2.4.18 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel The results shows that we have two open ports one running http service at port 80 and other and other running a ssh service at port 22.\nEnumeration Let‚Äôs focus on the website.\nThe website shows a Hello World message only.\nIf we go to the source code we can see that there is a commented line that told us where is the real website running.\nWith gobuster I am going to fuzz the website.\ngobuster dir --url http://10.10.10.75/nibbleblog -w ~/Documents/wordlists/KaliLists/dirb/common.txt -x php,js,css,py,html,cgi,sh,txt =============================================================== Gobuster v3.5 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://10.10.10.75/nibbleblog [+] Method: GET [+] Threads: 10 [+] Wordlist: /Users/aymanboulaichdahhou/Documents/wordlists/KaliLists/dirb/common.txt [+] Negative Status codes: 404 [+] User Agent: gobuster/3.5 [+] Extensions: css,py,html,cgi,sh,txt,php,js [+] Timeout: 10s =============================================================== 2023/07/04 00:02:39 Starting gobuster in directory enumeration mode =============================================================== /.php (Status: 403) [Size: 301] /.html (Status: 403) [Size: 302] /.hta (Status: 403) [Size: 301] /.hta.txt (Status: 403) [Size: 305] /.hta.php (Status: 403) [Size: 305] /.hta.js (Status: 403) [Size: 304] /.hta.css (Status: 403) [Size: 305] /.hta.html (Status: 403) [Size: 306] /.hta.py (Status: 403) [Size: 304] /.hta.cgi (Status: 403) [Size: 305] /.htaccess.html (Status: 403) [Size: 311] /.htaccess.cgi (Status: 403) [Size: 310] /.hta.sh (Status: 403) [Size: 304] /.htaccess.sh (Status: 403) [Size: 309] /.htaccess (Status: 403) [Size: 306] /.htaccess.php (Status: 403) [Size: 310] /.htaccess.txt (Status: 403) [Size: 310] /.htaccess.js (Status: 403) [Size: 309] /.htaccess.css (Status: 403) [Size: 310] /.htaccess.py (Status: 403) [Size: 309] /.htpasswd (Status: 403) [Size: 306] /.htpasswd.cgi (Status: 403) [Size: 310] /.htpasswd.py (Status: 403) [Size: 309] /.htpasswd.html (Status: 403) [Size: 311] /.htpasswd.sh (Status: 403) [Size: 309] /.htpasswd.txt (Status: 403) [Size: 310] /.htpasswd.php (Status: 403) [Size: 310] /.htpasswd.js (Status: 403) [Size: 309] /.htpasswd.css (Status: 403) [Size: 310] /admin (Status: 301) [Size: 321] [--\u003e http://10.10.10.75/nibbleblog/admin/] /admin.php (Status: 200) [Size: 1401] /admin.php (Status: 200) [Size: 1401] /content (Status: 301) [Size: 323] [--\u003e http://10.10.10.75/nibbleblog/content/] /feed.php (Status: 200) [Size: 302] /index.php (Status: 200) [Size: 2987] /index.php (Status: 200) [Size: 2987] /install.php (Status: 200) [Size: 78] /languages (Status: 301) [Size: 325] [--\u003e http://10.10.10.75/nibbleblog/languages/] /LICENSE.txt (Status: 200) [Size: 35148] /plugins (Status: 301) [Size: 323] [--\u003e http://10.10.10.75/nibbleblog/plugins/] /README (Status: 200) [Size: 4628] /sitemap.php (Status: 200) [Size: 401] /themes (Status: 301) [Size: 322] [--\u003e http://10.10.10.75/nibbleblog/themes/] /update.php (Status: 200) [Size: 1622] We can find some useful information about the software of the website in the README file.\nWe can see that is performing nibbleblog which is a blogging engine powered by PHP and the version that is using is the v4.0.3.\nExploiting Let‚Äôs see if there are some vulns for that version.\nIn google I found one article that don‚Äôt mention metasploit.\nThis article explain how works a shell vuln that helps you to do RCE with a reverse shell. The article explain that if we have credentials we can take advantage of the my image plugin preinstalled in all the nibbleblogs with our version to upload a php reverse shell.\nNow our problem is the credentials if we navigate to http://10.10.10.75/nibbleblog/admin.php we need the credentials to manage the website.\nI tried the default passwords first admin/- -/admin admin/nibbles nibbles/admin nibbles/- -/nibbles.\nI hace managed to enter with admin/nibbles and without bruteforcing the website.\nWe need now to navigate to Plugins \u003e Mi image \u003e Config as says the article.\nThe vuln‚Äôs article says that we need to put the reverse shell as a image and ignore the warnings I uploaded this reverse shell.\nLet‚Äôs set up a listener in the port 4444\nnc -lv 4444 Once done we need to move to http://10.10.10.75/nibbleblog/content/private/plugins/my_image/image.php\nGaining an Initial Foothold We are in now with user privileges.\nUser‚Äôs flag\nEscalating Privilege If we use sudo -l we observe a .sh that can be ran by sudo without password this .sh is found at /home/nibbler/personal/stuff/monitor.sh\nIf we unzip the zip we can find this .sh and modifying his content to ‚Äú/bin/bash‚Äù we can run a shell with root privilege thanks to the sudo command.\nsudo /home/nibbler/personal/stuff/monitor.sh Let‚Äôs check if we are root users now.\nRoot‚Äôs flag\nLessons Learned What insights did you gain from the room?\nI learned the importance of changing the default credentials if this thing was changed maybe the exploitation of the machine gonna be more harder.\nWere there any novel tools or techniques employed?\nOther way to exploit the sudo -l by modifying the content of a .sh which let us have privesc.\nThank you for reading, and happy hacking! üòÑ\n","wordCount":"816","inLanguage":"en","image":"https://pwndside.github.io/%3Cimage%20path/url%3E","datePublished":"2023-07-04T13:02:46+02:00","dateModified":"2023-07-04T13:02:46+02:00","author":{"@type":"Person","name":"Ayman Boulaich"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://pwndside.github.io/posts/nibbles-htb/"},"publisher":{"@type":"Organization","name":"PwndSide","logo":{"@type":"ImageObject","url":"https://pwndside.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://pwndside.github.io/ accesskey=h title="PwndSide (Alt + H)"><img src=https://pwndside.github.io/apple-touch-icon.png alt aria-label=logo height=35>PwndSide</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://pwndside.github.io/categories/hackthebox title=HackTheBox><span>HackTheBox</span></a></li><li><a href=https://pwndside.github.io/categories/ctf title="CTF's"><span>CTF's</span></a></li><li><a href=https://pwndside.github.io/about/whoami/ title=whoami><span>whoami</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://pwndside.github.io/>Home</a>&nbsp;¬ª&nbsp;<a href=https://pwndside.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Nibbles</h1><div class=post-description>This room is a Linux environment running a website powered by the Nibbleblog engine, and the version we are using has a shell vulnerability.</div><div class=post-meta><span title='2023-07-04 13:02:46 +0200 CEST'>July 4, 2023</span>&nbsp;¬∑&nbsp;4 min&nbsp;¬∑&nbsp;816 words&nbsp;¬∑&nbsp;Ayman Boulaich&nbsp;|&nbsp;<a href=https://github.com/pwndside/pwndside.github.io/content/posts/nibbles-htb.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#room-information>Room Information</a></li><li><a href=#tools-used>Tools Used</a></li><li><a href=#port-scanning>Port Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#exploiting>Exploiting</a></li><li><a href=#gaining-an-initial-foothold>Gaining an Initial Foothold</a></li><li><a href=#escalating-privilege>Escalating Privilege</a></li><li><a href=#lessons-learned>Lessons Learned</a></li></ul></nav></div></details></div><div class=post-content><h2 id=room-information>Room Information<a hidden class=anchor aria-hidden=true href=#room-information>#</a></h2><ul><li>Room name: Nibbles</li><li>Difficulty level: Easy</li><li>Room link: <a href=https://app.hackthebox.com/machines/Nibbles>https://app.hackthebox.com/machines/Nibbles</a></li></ul><p><img alt=Untitled loading=lazy src=/HTB/nibbles-icon.png></p><h2 id=tools-used>Tools Used<a hidden class=anchor aria-hidden=true href=#tools-used>#</a></h2><ul><li>Nmap</li><li>Gobuster</li></ul><h2 id=port-scanning>Port Scanning<a hidden class=anchor aria-hidden=true href=#port-scanning>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PORT   STATE SERVICE REASON         VERSION
</span></span><span class=line><span class=cl>22/tcp open  ssh     syn-ack ttl <span class=m>63</span> OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-hostkey:
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>2048</span> c4:f8:ad:e8:f8:04:77:de:cf:15:0d:63:0a:18:7e:49 <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQD8ArTOHWzqhwcyAZWc2CmxfLmVVTwfLZf0zhCBREGCpS2WC3NhAKQ2zefCHCU8XTC8hY9ta5ocU+p7S52OGHlaG7HuA5Xlnihl1INNsMX7gpNcfQEYnyby+hjHWPLo4++fAyO/lB8NammyA13MzvJy8pxvB9gmCJhVPaFzG5yX6Ly8OIsvVDk+qVa5eLCIua1E7WGACUlmkEGljDvzOaBdogMQZ8TGBTqNZbShnFH1WsUxBtJNRtYfeeGjztKTQqqj4WD5atU8dqV/iwmTylpE7wdHZ+38ckuYL9dmUPLh4Li2ZgdY6XniVOBGthY5a2uJ2OFp2xe1WS9KvbYjJ/tH
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> 22:8f:b1:97:bf:0f:17:08:fc:7e:2c:8f:e9:77:3a:48 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBPiFJd2F35NPKIQxKMHrgPzVzoNHOJtTtM+zlwVfxzvcXPFFuQrOL7X6Mi9YQF9QRVJpwtmV9KAtWltmk3qm4oc<span class=o>=</span>
</span></span><span class=line><span class=cl><span class=p>|</span>   <span class=m>256</span> e6:ac:27:a3:b5:a9:f1:12:3c:34:a5:5d:5b:eb:3d:e9 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC/RjKhT/2YPlCgFQLx+gOXhC6W3A3raTzjlXQMT8Msk
</span></span><span class=line><span class=cl>80/tcp open  http    syn-ack ttl <span class=m>63</span> Apache httpd 2.4.18 <span class=o>((</span>Ubuntu<span class=o>))</span>
</span></span><span class=line><span class=cl><span class=p>|</span>_http-title: Site doesn<span class=err>&#39;</span>t have a title <span class=o>(</span>text/html<span class=o>)</span>.
</span></span><span class=line><span class=cl><span class=p>|</span> http-methods:
</span></span><span class=line><span class=cl><span class=p>|</span>_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class=line><span class=cl><span class=p>|</span>_http-server-header: Apache/2.4.18 <span class=o>(</span>Ubuntu<span class=o>)</span>
</span></span><span class=line><span class=cl>Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><p>The results shows that we have two open ports one running http service at port 80 and other and other running a ssh service at port 22.</p><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p>Let‚Äôs focus on the website.</p><p><img alt=Untitled loading=lazy src=/HTB/nibbles-1.png></p><p>The website shows a Hello World message only.</p><p><img alt=Untitled loading=lazy src=/HTB/nibbles-2.png></p><p>If we go to the source code we can see that there is a commented line that told us where is the real website running.</p><p><img alt=Untitled loading=lazy src=/HTB/nibbles-3.png></p><p>With gobuster I am going to fuzz the website.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gobuster dir --url http://10.10.10.75/nibbleblog -w ~/Documents/wordlists/KaliLists/dirb/common.txt -x php,js,css,py,html,cgi,sh,txt
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>Gobuster v3.5
</span></span><span class=line><span class=cl>by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@firefart<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Url:                     http://10.10.10.75/nibbleblog
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Method:                  GET
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Threads:                 <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Wordlist:                /Users/aymanboulaichdahhou/Documents/wordlists/KaliLists/dirb/common.txt
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Negative Status codes:   <span class=m>404</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> User Agent:              gobuster/3.5
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Extensions:              css,py,html,cgi,sh,txt,php,js
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Timeout:                 <span class=nv>10s</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>2023/07/04 00:02:39 Starting gobuster in directory enumeration <span class=nv>mode</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>/.php                 <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 301<span class=o>]</span>
</span></span><span class=line><span class=cl>/.html                <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 302<span class=o>]</span>
</span></span><span class=line><span class=cl>/.hta                 <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 301<span class=o>]</span>
</span></span><span class=line><span class=cl>/.hta.txt             <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 305<span class=o>]</span>
</span></span><span class=line><span class=cl>/.hta.php             <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 305<span class=o>]</span>
</span></span><span class=line><span class=cl>/.hta.js              <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 304<span class=o>]</span>
</span></span><span class=line><span class=cl>/.hta.css             <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 305<span class=o>]</span>
</span></span><span class=line><span class=cl>/.hta.html            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 306<span class=o>]</span>
</span></span><span class=line><span class=cl>/.hta.py              <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 304<span class=o>]</span>
</span></span><span class=line><span class=cl>/.hta.cgi             <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 305<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htaccess.html       <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 311<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htaccess.cgi        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 310<span class=o>]</span>
</span></span><span class=line><span class=cl>/.hta.sh              <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 304<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htaccess.sh         <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 309<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htaccess            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 306<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htaccess.php        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 310<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htaccess.txt        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 310<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htaccess.js         <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 309<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htaccess.css        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 310<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htaccess.py         <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 309<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htpasswd            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 306<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htpasswd.cgi        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 310<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htpasswd.py         <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 309<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htpasswd.html       <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 311<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htpasswd.sh         <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 309<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htpasswd.txt        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 310<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htpasswd.php        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 310<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htpasswd.js         <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 309<span class=o>]</span>
</span></span><span class=line><span class=cl>/.htpasswd.css        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 310<span class=o>]</span>
</span></span><span class=line><span class=cl>/admin                <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 321<span class=o>]</span> <span class=o>[</span>--&gt; http://10.10.10.75/nibbleblog/admin/<span class=o>]</span>
</span></span><span class=line><span class=cl>/admin.php            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 1401<span class=o>]</span>
</span></span><span class=line><span class=cl>/admin.php            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 1401<span class=o>]</span>
</span></span><span class=line><span class=cl>/content              <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 323<span class=o>]</span> <span class=o>[</span>--&gt; http://10.10.10.75/nibbleblog/content/<span class=o>]</span>
</span></span><span class=line><span class=cl>/feed.php             <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 302<span class=o>]</span>
</span></span><span class=line><span class=cl>/index.php            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 2987<span class=o>]</span>
</span></span><span class=line><span class=cl>/index.php            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 2987<span class=o>]</span>
</span></span><span class=line><span class=cl>/install.php          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 78<span class=o>]</span>
</span></span><span class=line><span class=cl>/languages            <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 325<span class=o>]</span> <span class=o>[</span>--&gt; http://10.10.10.75/nibbleblog/languages/<span class=o>]</span>
</span></span><span class=line><span class=cl>/LICENSE.txt          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 35148<span class=o>]</span>
</span></span><span class=line><span class=cl>/plugins              <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 323<span class=o>]</span> <span class=o>[</span>--&gt; http://10.10.10.75/nibbleblog/plugins/<span class=o>]</span>
</span></span><span class=line><span class=cl>/README               <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 4628<span class=o>]</span>
</span></span><span class=line><span class=cl>/sitemap.php          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 401<span class=o>]</span>
</span></span><span class=line><span class=cl>/themes               <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 322<span class=o>]</span> <span class=o>[</span>--&gt; http://10.10.10.75/nibbleblog/themes/<span class=o>]</span>
</span></span><span class=line><span class=cl>/update.php           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 1622<span class=o>]</span>
</span></span></code></pre></div><p>We can find some useful information about the software of the website in the README file.</p><p><img alt=Untitled loading=lazy src=/HTB/nibbles-4.png></p><p>We can see that is performing nibbleblog which is a blogging engine powered by PHP and the version that is using is the v4.0.3.</p><p><img alt=Untitled loading=lazy src=/HTB/nibbles-5.png></p><h2 id=exploiting>Exploiting<a hidden class=anchor aria-hidden=true href=#exploiting>#</a></h2><p>Let‚Äôs see if there are some vulns for that version.</p><p><img alt=Untitled loading=lazy src=/HTB/nibbles-6.png></p><p>In google I found one <a href=https://packetstormsecurity.com/files/133425/NibbleBlog-4.0.3-Shell-Upload.html>article</a> that don‚Äôt mention metasploit.</p><p>This article explain how works a shell vuln that helps you to do RCE with a reverse shell. The article explain that if we have credentials we can take advantage of the my image plugin preinstalled in all the nibbleblogs with our version to upload a php reverse shell.</p><p>Now our problem is the credentials if we navigate to http://10.10.10.75/nibbleblog/admin.php we need the credentials to manage the website.</p><p><img alt=Untitled loading=lazy src=/HTB/nibbles-7.png></p><p>I tried the default passwords first admin/- -/admin admin/nibbles nibbles/admin nibbles/- -/nibbles.</p><p>I hace managed to enter with admin/nibbles and without bruteforcing the website.</p><p>We need now to navigate to Plugins > Mi image > Config as says the article.</p><p><img alt=Untitled loading=lazy src=/HTB/nibbles-8.png></p><p>The vuln‚Äôs article says that we need to put the reverse shell as a image and ignore the warnings I uploaded this <a href=https://pentestmonkey.net/tools/web-shells/php-reverse-shell>reverse shell</a>.</p><p>Let‚Äôs set up a listener in the port 4444</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -lv <span class=m>4444</span>
</span></span></code></pre></div><p>Once done we need to move to http://10.10.10.75/nibbleblog/content/private/plugins/my_image/image.php</p><h2 id=gaining-an-initial-foothold>Gaining an Initial Foothold<a hidden class=anchor aria-hidden=true href=#gaining-an-initial-foothold>#</a></h2><p>We are in now with user privileges.</p><p><img alt=Untitled loading=lazy src=/HTB/nibbles-9.png></p><p><strong>User‚Äôs flag</strong></p><p><img alt=Untitled loading=lazy src=/HTB/nibbles-10.png></p><h2 id=escalating-privilege>Escalating Privilege<a hidden class=anchor aria-hidden=true href=#escalating-privilege>#</a></h2><p>If we use sudo -l we observe a .sh that can be ran by sudo without password this .sh is found at /home/nibbler/personal/stuff/monitor.sh</p><p><img alt=Untitled loading=lazy src=/HTB/nibbles-11.png></p><p>If we unzip the zip we can find this .sh and modifying his content to ‚Äú/bin/bash‚Äù we can run a shell with root privilege thanks to the sudo command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo /home/nibbler/personal/stuff/monitor.sh
</span></span></code></pre></div><p>Let‚Äôs check if we are root users now.</p><p><img alt=Untitled loading=lazy src=/HTB/nibbles-12.png></p><p><strong>Root‚Äôs flag</strong></p><p><img alt=Untitled loading=lazy src=/HTB/nibbles-13.png></p><h2 id=lessons-learned>Lessons Learned<a hidden class=anchor aria-hidden=true href=#lessons-learned>#</a></h2><ul><li><p>What insights did you gain from the room?</p><p>I learned the importance of changing the default credentials if this thing was changed maybe the exploitation of the machine gonna be more harder.</p></li><li><p>Were there any novel tools or techniques employed?</p><p>Other way to exploit the sudo -l by modifying the content of a .sh which let us have privesc.</p></li></ul><p><strong>Thank you for reading, and happy hacking! üòÑ</strong></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://pwndside.github.io/tags/web/>Web</a></li><li><a href=https://pwndside.github.io/tags/privesc/>Privesc</a></li><li><a href=https://pwndside.github.io/tags/linux/>Linux</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://pwndside.github.io/>PwndSide</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>