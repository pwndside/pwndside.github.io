<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Sense | PwndSide</title><meta name=keywords content="privesc,web,linux"><meta name=description content="Linux machine with a website running pfsense which has credentials leak which help us access to the software. Thanks to a command injection we can access as root."><meta name=author content="Ayman Boulaich"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/sense-htb/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/posts/sense-htb/"><meta property="og:site_name" content="PwndSide"><meta property="og:title" content="Sense"><meta property="og:description" content="Linux machine with a website running pfsense which has credentials leak which help us access to the software. Thanks to a command injection we can access as root."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-22T12:14:14+02:00"><meta property="article:modified_time" content="2023-08-22T12:14:14+02:00"><meta property="article:tag" content="Privesc"><meta property="article:tag" content="Web"><meta property="article:tag" content="Linux"><meta property="og:image" content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="Sense"><meta name=twitter:description content="Linux machine with a website running pfsense which has credentials leak which help us access to the software. Thanks to a command injection we can access as root."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Sense","item":"http://localhost:1313/posts/sense-htb/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Sense","name":"Sense","description":"Linux machine with a website running pfsense which has credentials leak which help us access to the software. Thanks to a command injection we can access as root.","keywords":["privesc","web","linux"],"articleBody":"Room Information Room name: Sense Difficulty level: Easy Room link: https://app.hackthebox.com/machines/Sense Tools Used nmap searchsploit burpsuite Port Scanning sudo nmap $IP -n -Pn -vvv --min-rate 5000 6 │ PORT STATE SERVICE REASON VERSION 7 │ 80/tcp open http syn-ack ttl 63 lighttpd 1.4.35 8 │ |_http-server-header: lighttpd/1.4.35 9 │ | http-methods: 10 │ |_ Supported Methods: GET HEAD POST OPTIONS 11 │ |_http-title: Did not follow redirect to https://10.10.10.60/ 12 │ 443/tcp open ssl/http syn-ack ttl 63 lighttpd 1.4.35 13 │ |_ssl-date: TLS randomness does not represent time 14 │ |_http-favicon: Unknown favicon MD5: 082559A7867CF27ACAB7E9867A8B320F 15 │ |_http-title: Login 16 │ | http-methods: 17 │ |_ Supported Methods: GET HEAD POST OPTIONS 18 │ |_http-server-header: lighttpd/1.4.35 19 │ | ssl-cert: Subject: commonName=Common Name (eg, YOUR name)/organizatio │ nName=CompanyName/stateOrProvinceName=Somewhere/countryName=US/organiza │ tionalUnitName=Organizational Unit Name (eg, section)/emailAddress=Emai │ l Address/localityName=Somecity 20 │ | Issuer: commonName=Common Name (eg, YOUR name)/organizationName=Compa │ nyName/stateOrProvinceName=Somewhere/countryName=US/organizationalUnitN │ ame=Organizational Unit Name (eg, section)/emailAddress=Email Address/l │ ocalityName=Somecity 21 │ | Public Key type: rsa 22 │ | Public Key bits: 1024 23 │ | Signature Algorithm: sha256WithRSAEncryption 24 │ | Not valid before: 2017-10-14T19:21:35 25 │ | Not valid after: 2023-04-06T19:21:35 26 │ | MD5: 65f8:b00f:57d2:3468:2c52:0f44:8110:c622 27 │ | SHA-1: 4f7c:9a75:cb7f:70d3:8087:08cb:8c27:20dc:05f1:bb02 28 │ | -----BEGIN CERTIFICATE----- 29 │ | MIIEKDCCA5GgAwIBAgIJALChaIpiwz41MA0GCSqGSIb3DQEBCwUAMIG/MQswCQYD 30 │ | VQQGEwJVUzESMBAGA1UECBMJU29tZXdoZXJlMREwDwYDVQQHEwhTb21lY2l0eTEU 31 │ | MBIGA1UEChMLQ29tcGFueU5hbWUxLzAtBgNVBAsTJk9yZ2FuaXphdGlvbmFsIFVu 32 │ | aXQgTmFtZSAoZWcsIHNlY3Rpb24pMSQwIgYDVQQDExtDb21tb24gTmFtZSAoZWcs 33 │ | IFlPVVIgbmFtZSkxHDAaBgkqhkiG9w0BCQEWDUVtYWlsIEFkZHJlc3MwHhcNMTcx 34 │ | MDE0MTkyMTM1WhcNMjMwNDA2MTkyMTM1WjCBvzELMAkGA1UEBhMCVVMxEjAQBgNV 35 │ | BAgTCVNvbWV3aGVyZTERMA8GA1UEBxMIU29tZWNpdHkxFDASBgNVBAoTC0NvbXBh 36 │ | bnlOYW1lMS8wLQYDVQQLEyZPcmdhbml6YXRpb25hbCBVbml0IE5hbWUgKGVnLCBz 37 │ | ZWN0aW9uKTEkMCIGA1UEAxMbQ29tbW9uIE5hbWUgKGVnLCBZT1VSIG5hbWUpMRww 38 │ | GgYJKoZIhvcNAQkBFg1FbWFpbCBBZGRyZXNzMIGfMA0GCSqGSIb3DQEBAQUAA4GN 39 │ | ADCBiQKBgQC/sWU6By08lGbvttAfx47SWksgA7FavNrEoW9IRp0W/RF9Fp5BQesL 40 │ | L3FMJ0MHyGcfRhnL5VwDCL0E+1Y05az8PY8kUmjvxSvxQCLn6Mh3nTZkiAJ8vpB0 41 │ | WAnjltrTCEsv7Dnz2OofkpqaUnoNGfO3uKWPvRXl9OlSe/BcDStffQIDAQABo4IB 42 │ | KDCCASQwHQYDVR0OBBYEFDK5DS/hTsi9SHxT749Od/p3Lq05MIH0BgNVHSMEgeww 43 │ | gemAFDK5DS/hTsi9SHxT749Od/p3Lq05oYHFpIHCMIG/MQswCQYDVQQGEwJVUzES 44 │ | MBAGA1UECBMJU29tZXdoZXJlMREwDwYDVQQHEwhTb21lY2l0eTEUMBIGA1UEChML 45 │ | Q29tcGFueU5hbWUxLzAtBgNVBAsTJk9yZ2FuaXphdGlvbmFsIFVuaXQgTmFtZSAo 46 │ | ZWcsIHNlY3Rpb24pMSQwIgYDVQQDExtDb21tb24gTmFtZSAoZWcsIFlPVVIgbmFt 47 │ | ZSkxHDAaBgkqhkiG9w0BCQEWDUVtYWlsIEFkZHJlc3OCCQCwoWiKYsM+NTAMBgNV 48 │ | HRMEBTADAQH/MA0GCSqGSIb3DQEBCwUAA4GBAHNn+1AX2qwJ9zhgN3I4ES1Vq84l 49 │ | n6p7OoBefxcf31Pn3VDnbvJJFFcZdplDxbIWh5lyjpTHRJQyHECtEMW677rFXJAl 50 │ | /cEYWHDndn9Gwaxn7JyffK5lUAPMPEDtudQb3cxrevP/iFZwefi2d5p3jFkDCcGI 51 │ | +Y0tZRIRzHWgQHa/ 52 │ |_-----END CERTIFICATE----- We have two open ports, one with http and one with https.\nEnumeration When I access to the http page seems to redirect you to the ssl one.\nThis will be our only point of entry. If we look at the page there is a pfsense login form.\nInvestigating on google I found that pfsense is a firewall/router computer software distribution based on FreeBSD.\nSearching for default credentials, I found admin/pfsense.\nI am not able to access with them so maybe they changed the passwords.\nOnly I can do now is to fuzz in order to obtain something else.\n1 │ /index.html/ (Status: 200) [Size: 329] 2 │ /index.php/ (Status: 200) [Size: 6690] 3 │ /help.php/ (Status: 200) [Size: 6689] 4 │ /stats.php/ (Status: 200) [Size: 6690] 5 │ /edit.php/ (Status: 200) [Size: 6689] 6 │ /license.php/ (Status: 200) [Size: 6692] 7 │ /system.php/ (Status: 200) [Size: 6691] 8 │ /status.php/ (Status: 200) [Size: 6691] 9 │ /changelog.txt/ (Status: 200) [Size: 271] 10 │ /system-users.txt/ (Status: 200) [Size: 100] 11 │ /exec.php/ (Status: 200) [Size: 6689] 12 │ /graph.php/ (Status: 200) [Size: 6690] 13 │ /tree/ (Status: 200) [Size: 7492] 14 │ /gui.css/ (Status: 200) [Size: 6590] 15 │ /wizard.php/ (Status: 200) [Size: 6691] 16 │ /pkg.php/ (Status: 200) [Size: 6688] 17 │ /installer/ (Status: 302) [Size: 0] [--\u003e installer.php] 18 │ /xmlrpc.php/ (Status: 200) [Size: 384] 19 │ /treeview.css/ (Status: 200) [Size: 726] The scan results gives us two interesting directories /changelog.txt and /system-users.txt\nIn /changelog.txt directory we found information about security stuff, basically told us that there is one vulnerability which it isn’t patched yet.\nThe /system-users.txt gives us a. credentials, maybe we can try to access with them in the main login page.\nExploiting We have the current software version of pfsense which we are using. Let’s search any exploit.\nWe only have one which seems a command injection vuln.\nThe exploit seems to automatize the things.\nThe script doesn’t worked for me, so I decided to see how works to gain access by myself.\nexploit_url = \"https://\" + rhost + \"/status_rrd_graph_img.php?database=queues;\"+\"printf+\" + \"'\" + payload + \"'|sh\" The script basically access to the above url and put a payload with a reverse shell, so let’s make it with burp repeater.\nThe following requests seems to work, its a basic injection to ensure that we have command injection\nOnce insured about that there is a command injection. Let’s see what user is executing the commands, I put a nc listener in order to see the output.\nGood we are root so let’s put a reverse shell to gain access to the machine.\nSomething is not working, maybe some kind of character is not covered\nWith the above injection the / character is not outputted.\nI tried the same injection with a bunch of characters and the ones are not outputted are / and -\nWe can pass this characters octal code to a variable and use the variable in order to execute the reverse shell.\nGaining an Initial Foothold We owned the system, this machine doesn’t need privesc as we can see.\nLet’s cat the user’s flag.\nLet’s cat the root’s flag.\nThank you for reading, and happy hacking! 😄\n","wordCount":"835","inLanguage":"en","image":"http://localhost:1313/%3Cimage%20path/url%3E","datePublished":"2023-08-22T12:14:14+02:00","dateModified":"2023-08-22T12:14:14+02:00","author":{"@type":"Person","name":"Ayman Boulaich"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/sense-htb/"},"publisher":{"@type":"Organization","name":"PwndSide","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="PwndSide (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>PwndSide</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/hackthebox title=HackTheBox><span>HackTheBox</span></a></li><li><a href=http://localhost:1313/categories/ctf title="CTF's"><span>CTF's</span></a></li><li><a href=http://localhost:1313/about/whoami/ title=whoami><span>whoami</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Sense</h1><div class=post-description>Linux machine with a website running pfsense which has credentials leak which help us access to the software. Thanks to a command injection we can access as root.</div><div class=post-meta><span title='2023-08-22 12:14:14 +0200 CEST'>August 22, 2023</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;835 words&nbsp;·&nbsp;Ayman Boulaich&nbsp;|&nbsp;<a href=https://github.com/pwndside/pwndside.github.io/content/posts/sense-htb.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#room-information>Room Information</a></li><li><a href=#tools-used>Tools Used</a></li><li><a href=#port-scanning>Port Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#exploiting>Exploiting</a></li><li><a href=#gaining-an-initial-foothold>Gaining an Initial Foothold</a></li></ul></nav></div></details></div><div class=post-content><h2 id=room-information>Room Information<a hidden class=anchor aria-hidden=true href=#room-information>#</a></h2><ul><li>Room name: Sense</li><li>Difficulty level: Easy</li><li>Room link: <a href=https://app.hackthebox.com/machines/Sense>https://app.hackthebox.com/machines/Sense</a></li></ul><p><img alt=Untitled loading=lazy src=/HTB/sense-icon.png></p><h2 id=tools-used>Tools Used<a hidden class=anchor aria-hidden=true href=#tools-used>#</a></h2><ul><li>nmap</li><li>searchsploit</li><li>burpsuite</li></ul><h2 id=port-scanning>Port Scanning<a hidden class=anchor aria-hidden=true href=#port-scanning>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap <span class=nv>$IP</span> -n -Pn -vvv --min-rate <span class=m>5000</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>   <span class=m>6</span>   │ PORT    STATE SERVICE  REASON         VERSION
</span></span><span class=line><span class=cl>   <span class=m>7</span>   │ 80/tcp  open  http     syn-ack ttl <span class=m>63</span> lighttpd 1.4.35
</span></span><span class=line><span class=cl>   <span class=m>8</span>   │ <span class=p>|</span>_http-server-header: lighttpd/1.4.35
</span></span><span class=line><span class=cl>   <span class=m>9</span>   │ <span class=p>|</span> http-methods:
</span></span><span class=line><span class=cl>  <span class=m>10</span>   │ <span class=p>|</span>_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class=line><span class=cl>  <span class=m>11</span>   │ <span class=p>|</span>_http-title: Did not follow redirect to https://10.10.10.60/
</span></span><span class=line><span class=cl>  <span class=m>12</span>   │ 443/tcp open  ssl/http syn-ack ttl <span class=m>63</span> lighttpd 1.4.35
</span></span><span class=line><span class=cl>  <span class=m>13</span>   │ <span class=p>|</span>_ssl-date: TLS randomness does not represent <span class=nb>time</span>
</span></span><span class=line><span class=cl>  <span class=m>14</span>   │ <span class=p>|</span>_http-favicon: Unknown favicon MD5: 082559A7867CF27ACAB7E9867A8B320F
</span></span><span class=line><span class=cl>  <span class=m>15</span>   │ <span class=p>|</span>_http-title: Login
</span></span><span class=line><span class=cl>  <span class=m>16</span>   │ <span class=p>|</span> http-methods:
</span></span><span class=line><span class=cl>  <span class=m>17</span>   │ <span class=p>|</span>_  Supported Methods: GET HEAD POST OPTIONS
</span></span><span class=line><span class=cl>  <span class=m>18</span>   │ <span class=p>|</span>_http-server-header: lighttpd/1.4.35
</span></span><span class=line><span class=cl>  <span class=m>19</span>   │ <span class=p>|</span> ssl-cert: Subject: <span class=nv>commonName</span><span class=o>=</span>Common Name <span class=o>(</span>eg, YOUR name<span class=o>)</span>/organizatio
</span></span><span class=line><span class=cl>       │ <span class=nv>nName</span><span class=o>=</span>CompanyName/stateOrProvinceName<span class=o>=</span>Somewhere/countryName<span class=o>=</span>US/organiza
</span></span><span class=line><span class=cl>       │ <span class=nv>tionalUnitName</span><span class=o>=</span>Organizational Unit Name <span class=o>(</span>eg, section<span class=o>)</span>/emailAddress<span class=o>=</span>Emai
</span></span><span class=line><span class=cl>       │ l Address/localityName<span class=o>=</span>Somecity
</span></span><span class=line><span class=cl>  <span class=m>20</span>   │ <span class=p>|</span> Issuer: <span class=nv>commonName</span><span class=o>=</span>Common Name <span class=o>(</span>eg, YOUR name<span class=o>)</span>/organizationName<span class=o>=</span>Compa
</span></span><span class=line><span class=cl>       │ nyName/stateOrProvinceName<span class=o>=</span>Somewhere/countryName<span class=o>=</span>US/organizationalUnitN
</span></span><span class=line><span class=cl>       │ <span class=nv>ame</span><span class=o>=</span>Organizational Unit Name <span class=o>(</span>eg, section<span class=o>)</span>/emailAddress<span class=o>=</span>Email Address/l
</span></span><span class=line><span class=cl>       │ <span class=nv>ocalityName</span><span class=o>=</span>Somecity
</span></span><span class=line><span class=cl>  <span class=m>21</span>   │ <span class=p>|</span> Public Key type: rsa
</span></span><span class=line><span class=cl>  <span class=m>22</span>   │ <span class=p>|</span> Public Key bits: <span class=m>1024</span>
</span></span><span class=line><span class=cl>  <span class=m>23</span>   │ <span class=p>|</span> Signature Algorithm: sha256WithRSAEncryption
</span></span><span class=line><span class=cl>  <span class=m>24</span>   │ <span class=p>|</span> Not valid before: 2017-10-14T19:21:35
</span></span><span class=line><span class=cl>  <span class=m>25</span>   │ <span class=p>|</span> Not valid after:  2023-04-06T19:21:35
</span></span><span class=line><span class=cl>  <span class=m>26</span>   │ <span class=p>|</span> MD5:   65f8:b00f:57d2:3468:2c52:0f44:8110:c622
</span></span><span class=line><span class=cl>  <span class=m>27</span>   │ <span class=p>|</span> SHA-1: 4f7c:9a75:cb7f:70d3:8087:08cb:8c27:20dc:05f1:bb02
</span></span><span class=line><span class=cl>  <span class=m>28</span>   │ <span class=p>|</span> -----BEGIN CERTIFICATE-----
</span></span><span class=line><span class=cl>  <span class=m>29</span>   │ <span class=p>|</span> MIIEKDCCA5GgAwIBAgIJALChaIpiwz41MA0GCSqGSIb3DQEBCwUAMIG/MQswCQYD
</span></span><span class=line><span class=cl>  <span class=m>30</span>   │ <span class=p>|</span> VQQGEwJVUzESMBAGA1UECBMJU29tZXdoZXJlMREwDwYDVQQHEwhTb21lY2l0eTEU
</span></span><span class=line><span class=cl>  <span class=m>31</span>   │ <span class=p>|</span> MBIGA1UEChMLQ29tcGFueU5hbWUxLzAtBgNVBAsTJk9yZ2FuaXphdGlvbmFsIFVu
</span></span><span class=line><span class=cl>  <span class=m>32</span>   │ <span class=p>|</span> aXQgTmFtZSAoZWcsIHNlY3Rpb24pMSQwIgYDVQQDExtDb21tb24gTmFtZSAoZWcs
</span></span><span class=line><span class=cl>  <span class=m>33</span>   │ <span class=p>|</span> IFlPVVIgbmFtZSkxHDAaBgkqhkiG9w0BCQEWDUVtYWlsIEFkZHJlc3MwHhcNMTcx
</span></span><span class=line><span class=cl>  <span class=m>34</span>   │ <span class=p>|</span> MDE0MTkyMTM1WhcNMjMwNDA2MTkyMTM1WjCBvzELMAkGA1UEBhMCVVMxEjAQBgNV
</span></span><span class=line><span class=cl>  <span class=m>35</span>   │ <span class=p>|</span> BAgTCVNvbWV3aGVyZTERMA8GA1UEBxMIU29tZWNpdHkxFDASBgNVBAoTC0NvbXBh
</span></span><span class=line><span class=cl>  <span class=m>36</span>   │ <span class=p>|</span> bnlOYW1lMS8wLQYDVQQLEyZPcmdhbml6YXRpb25hbCBVbml0IE5hbWUgKGVnLCBz
</span></span><span class=line><span class=cl>  <span class=m>37</span>   │ <span class=p>|</span> ZWN0aW9uKTEkMCIGA1UEAxMbQ29tbW9uIE5hbWUgKGVnLCBZT1VSIG5hbWUpMRww
</span></span><span class=line><span class=cl>  <span class=m>38</span>   │ <span class=p>|</span> GgYJKoZIhvcNAQkBFg1FbWFpbCBBZGRyZXNzMIGfMA0GCSqGSIb3DQEBAQUAA4GN
</span></span><span class=line><span class=cl>  <span class=m>39</span>   │ <span class=p>|</span> ADCBiQKBgQC/sWU6By08lGbvttAfx47SWksgA7FavNrEoW9IRp0W/RF9Fp5BQesL
</span></span><span class=line><span class=cl>  <span class=m>40</span>   │ <span class=p>|</span> L3FMJ0MHyGcfRhnL5VwDCL0E+1Y05az8PY8kUmjvxSvxQCLn6Mh3nTZkiAJ8vpB0
</span></span><span class=line><span class=cl>  <span class=m>41</span>   │ <span class=p>|</span> WAnjltrTCEsv7Dnz2OofkpqaUnoNGfO3uKWPvRXl9OlSe/BcDStffQIDAQABo4IB
</span></span><span class=line><span class=cl>  <span class=m>42</span>   │ <span class=p>|</span> KDCCASQwHQYDVR0OBBYEFDK5DS/hTsi9SHxT749Od/p3Lq05MIH0BgNVHSMEgeww
</span></span><span class=line><span class=cl>  <span class=m>43</span>   │ <span class=p>|</span> gemAFDK5DS/hTsi9SHxT749Od/p3Lq05oYHFpIHCMIG/MQswCQYDVQQGEwJVUzES
</span></span><span class=line><span class=cl>  <span class=m>44</span>   │ <span class=p>|</span> MBAGA1UECBMJU29tZXdoZXJlMREwDwYDVQQHEwhTb21lY2l0eTEUMBIGA1UEChML
</span></span><span class=line><span class=cl>  <span class=m>45</span>   │ <span class=p>|</span> Q29tcGFueU5hbWUxLzAtBgNVBAsTJk9yZ2FuaXphdGlvbmFsIFVuaXQgTmFtZSAo
</span></span><span class=line><span class=cl>  <span class=m>46</span>   │ <span class=p>|</span> ZWcsIHNlY3Rpb24pMSQwIgYDVQQDExtDb21tb24gTmFtZSAoZWcsIFlPVVIgbmFt
</span></span><span class=line><span class=cl>  <span class=m>47</span>   │ <span class=p>|</span> ZSkxHDAaBgkqhkiG9w0BCQEWDUVtYWlsIEFkZHJlc3OCCQCwoWiKYsM+NTAMBgNV
</span></span><span class=line><span class=cl>  <span class=m>48</span>   │ <span class=p>|</span> HRMEBTADAQH/MA0GCSqGSIb3DQEBCwUAA4GBAHNn+1AX2qwJ9zhgN3I4ES1Vq84l
</span></span><span class=line><span class=cl>  <span class=m>49</span>   │ <span class=p>|</span> n6p7OoBefxcf31Pn3VDnbvJJFFcZdplDxbIWh5lyjpTHRJQyHECtEMW677rFXJAl
</span></span><span class=line><span class=cl>  <span class=m>50</span>   │ <span class=p>|</span> /cEYWHDndn9Gwaxn7JyffK5lUAPMPEDtudQb3cxrevP/iFZwefi2d5p3jFkDCcGI
</span></span><span class=line><span class=cl>  <span class=m>51</span>   │ <span class=p>|</span> +Y0tZRIRzHWgQHa/
</span></span><span class=line><span class=cl>  <span class=m>52</span>   │ <span class=p>|</span>_-----END CERTIFICATE-----
</span></span></code></pre></div><p>We have two open ports, one with <strong>http</strong> and one with <strong>https</strong>.</p><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p>When I access to the http page seems to redirect you to the ssl one.</p><p><img alt=Untitled loading=lazy src=/HTB/sense-1.png></p><p>This will be our only point of entry. If we look at the page there is a pfsense login form.</p><p>Investigating on google I found that pfsense is a firewall/router computer software distribution based on FreeBSD.</p><p>Searching for default credentials, I found admin/pfsense.</p><p><img alt=Untitled loading=lazy src=/HTB/sense-2.png></p><p>I am not able to access with them so maybe they changed the passwords.</p><p>Only I can do now is to fuzz in order to obtain something else.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>   <span class=m>1</span>   │ /index.html/          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 329<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>2</span>   │ /index.php/           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6690<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>3</span>   │ /help.php/            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6689<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>4</span>   │ /stats.php/           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6690<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>5</span>   │ /edit.php/            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6689<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>6</span>   │ /license.php/         <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6692<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>7</span>   │ /system.php/          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6691<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>8</span>   │ /status.php/          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6691<span class=o>]</span>
</span></span><span class=line><span class=cl>   <span class=m>9</span>   │ /changelog.txt/       <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 271<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>10</span>   │ /system-users.txt/    <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 100<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>11</span>   │ /exec.php/            <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6689<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>12</span>   │ /graph.php/           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6690<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>13</span>   │ /tree/                <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 7492<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>14</span>   │ /gui.css/             <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6590<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>15</span>   │ /wizard.php/          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6691<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>16</span>   │ /pkg.php/             <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 6688<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>17</span>   │ /installer/           <span class=o>(</span>Status: 302<span class=o>)</span> <span class=o>[</span>Size: 0<span class=o>]</span> <span class=o>[</span>--&gt; installer.php<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>18</span>   │ /xmlrpc.php/          <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 384<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>19</span>   │ /treeview.css/        <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 726<span class=o>]</span>
</span></span></code></pre></div><p>The scan results gives us two interesting directories /changelog.txt and /system-users.txt</p><p><img alt=Untitled loading=lazy src=/HTB/sense-3.png></p><p>In /changelog.txt directory we found information about security stuff, basically told us that there is one vulnerability which it isn’t patched yet.</p><p><img alt=Untitled loading=lazy src=/HTB/sense-4.png></p><p>The /system-users.txt gives us a. credentials, maybe we can try to access with them in the main login page.</p><h2 id=exploiting>Exploiting<a hidden class=anchor aria-hidden=true href=#exploiting>#</a></h2><p><img alt=Untitled loading=lazy src=/HTB/sense-5.png></p><p>We have the current software version of pfsense which we are using. Let’s search any exploit.</p><p><img alt=Untitled loading=lazy src=/HTB/sense-6.png></p><p>We only have one which seems a command injection vuln.</p><p><img alt=Untitled loading=lazy src=/HTB/sense-8.png></p><p>The exploit seems to automatize the things.</p><p><img alt=Untitled loading=lazy src=/HTB/sense-7.png></p><p>The script doesn’t worked for me, so I decided to see how works to gain access by myself.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>exploit_url</span> <span class=o>=</span> <span class=s2>&#34;https://&#34;</span> + rhost + <span class=s2>&#34;/status_rrd_graph_img.php?database=queues;&#34;</span>+<span class=s2>&#34;printf+&#34;</span> + <span class=s2>&#34;&#39;&#34;</span> + payload + <span class=s2>&#34;&#39;|sh&#34;</span>
</span></span></code></pre></div><p>The script basically access to the above url and put a payload with a reverse shell, so let’s make it with burp repeater.</p><p>The following requests seems to work, its a basic injection to ensure that we have command injection</p><p><img alt=Untitled loading=lazy src=/HTB/sense-9.png></p><p>Once insured about that there is a command injection. Let’s see what user is executing the commands, I put a nc listener in order to see the output.</p><p><img alt=Untitled loading=lazy src=/HTB/sense-10.png></p><p><img alt=Untitled loading=lazy src=/HTB/sense-11.png></p><p>Good we are root so let’s put a reverse shell to gain access to the machine.</p><p><img alt=Untitled loading=lazy src=/HTB/sense-12.png></p><p>Something is not working, maybe some kind of character is not covered</p><p><img alt=Untitled loading=lazy src=/HTB/sense-13.png></p><p>With the above injection the <code>/</code> character is not outputted.</p><p>I tried the same injection with a bunch of characters and the ones are not outputted are <code>/</code> and <code>-</code></p><p>We can pass this characters octal code to a variable and use the variable in order to execute the reverse shell.</p><p><img alt=Untitled loading=lazy src=/HTB/sense-14.png></p><h2 id=gaining-an-initial-foothold>Gaining an Initial Foothold<a hidden class=anchor aria-hidden=true href=#gaining-an-initial-foothold>#</a></h2><p><img alt=Untitled loading=lazy src=/HTB/sense-15.png></p><p>We owned the system, this machine doesn’t need privesc as we can see.</p><p>Let’s cat the <strong>user’s flag</strong>.</p><p><img alt=Untitled loading=lazy src=/HTB/sense-16.png></p><p>Let’s cat the <strong>root’s flag</strong>.</p><p><img alt=Untitled loading=lazy src=/HTB/sense-17.png></p><p><strong>Thank you for reading, and happy hacking! 😄</strong></p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/privesc/>Privesc</a></li><li><a href=http://localhost:1313/tags/web/>Web</a></li><li><a href=http://localhost:1313/tags/linux/>Linux</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>PwndSide</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>